webpackJsonp([25],{2754:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2755)},2755:function(e,t,i){"use strict";var a=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}();Object.defineProperty(t,"__esModule",{value:!0});var n=i(2756),r=function(e){function t(t,i,a,r,s,c,l,o,h,d,u){var g=e.call(this)||this;return g.callingService=t,g.constants=i,g.$interval=a,g.CALL_EVENTS=[],g.callHealthDataMap=new Map,g.callStateChangedSubscriptions=new Map,g.activeTimers=new Map,g.activeCallData=new Map,g.activeTimersSubscriptionsCnt=new Map,g.logger=o.newLogger("CallHealthLazyLoadService"),g.initializeCallEvents(),s.registerForMtma(g),g.callHealthMetricDefinitionFactory=new n.CallHealthMetricDefinitionFactory(c,l,t,r,o,h,i,d),g.initializeOnAppLaunchAndReinit(),g}return a(t,e),t.$inject=["callingService","constants","$interval","$q","orchestrationService","$translate","resources","loggingService","settingsService","meetingPolicySettingsStore","aggregatedSettingsStore"],t.prototype.initializeCallEvents=function(){this.CALL_EVENTS.push("VideoTurnedOff_Disable"),this.CALL_EVENTS.push("VideoTurnedOn_Enable"),this.CALL_EVENTS.push("ScreenSharingTurnedOff_Disable"),this.CALL_EVENTS.push("ScreenSharingTurnedOn_Enable"),this.CALL_EVENTS.push("AudioTurnedOff_Disable"),this.CALL_EVENTS.push("AudioTurnedOn_Enable"),this.CALL_EVENTS.push("PariticipantScreenSharingOn_Enable"),this.CALL_EVENTS.push("PariticipantScreenSharingOff_Disable")},t.prototype.initializeOnAppLaunchAndReinit=function(){},t.prototype.getCallHealthDataId=function(e,t,i){return e+"_"+t+(i?"_"+i:"")},t.prototype.getCallHealthData=function(e,t,i){var a=this,n=this.getCallHealthDataId(e,t,i);return new Promise(function(r,s){if(!a.callHealthDataMap.has(n)){var c=a.initializeCallHealthData(e,t,i);if(c)return void s(c)}a.getDataFromDataAdapters(e,t,i).then(function(){var e=a.callHealthDataMap.get(n);r(e.categories)}).catch(function(e){s(e)})})},t.prototype.activateCallHealthDataChanges=function(e,t,i){var a=this.getCallHealthDataId(e,t,i);this.activeTimersSubscriptionsCnt.has(a)?this.activeTimersSubscriptionsCnt.set(a,this.activeTimersSubscriptionsCnt.get(a)+1):(this.activateTimersForGetData(e,t,i),this.subscribeToEvents(e,t,i),this.activeTimersSubscriptionsCnt.set(a,1))},t.prototype.deactivateCallHealthDataChanges=function(e,t,i){var a=this.getCallHealthDataId(e,t,i);if(this.activeTimersSubscriptionsCnt.has(a)){var n=this.activeTimersSubscriptionsCnt.get(a);n>1?this.activeTimersSubscriptionsCnt.set(a,n-1):(this.cleanupCallHealthDataChanges(a),this.activeTimersSubscriptionsCnt.delete(a))}},t.prototype.getCallHealthDataFromAdapter=function(e,t,i,a,n){var r=this;e.getData(t).then(function(s){var c=r.updateCategories(i.categories,e.adapterType,s);c.length>0&&r.trigger(r.constants.events.calling.callHealthValuesUpdated,teamspace.services.TeamsCallService.getTeamsCallIdAsString(t),{teamsCallId:t,meetingPanelLocation:a,meetingPanelSubSection:n,categoryDiffs:c})})},t.prototype.activateTimersForGetData=function(e,t,i){var a=this,n=this.getCallHealthDataId(e,t,i);if(!this.activeTimers.has(n)){var r=this.callHealthDataMap.get(n);r.dataAdapters.forEach(function(s){if(s.refreshInterval>0){var c=a.$interval(function(){return a.getCallHealthDataFromAdapter(s,e,r,t,i)},s.refreshInterval,0,!0);a.addToActiveTimers(n,c)}})}},t.prototype.subscribeToEvents=function(e,t,i){var a=this,n=this.getCallHealthDataId(e,t,i);if(!this.activeCallData.has(n)){var r=null,s=this.callHealthDataMap.get(n);if(this.CALL_EVENTS.find(function(e){return s.events.has(e)})){r=this.initCallData(e);var c=this.callingService.getCallByTeamsCallId(e).changed(function(){a.callChanged(r,e,t,i)});r.subscription=c}this.activeCallData.set(n,r)}},t.prototype.initCallData=function(e){var t=this.callingService.getCallByTeamsCallId(e);return{isVideoOn:t.isVideoOn,isScreenSharingOn:t.isScreenSharingOn,isMuted:t.isMuted,isParticipantScreenSharing:!!t.participants.find(function(e){return e.streams[1][0]&&e.streams[1][0].isStreaming}),subscription:null}},t.prototype.callChanged=function(e,t,i,a){var n=this,r=this.updateCallDataAndGetEvents(e,t);if(["VideoTurnedOn_Enable","ScreenSharingTurnedOn_Enable","AudioTurnedOn_Enable","PariticipantScreenSharingOn_Enable"].some(function(e){return r.includes(e)})){var s=this.getCallHealthDataId(t,i,a),c=this.callHealthDataMap.get(s);c.dataAdapters.forEach(function(e){e.refreshInterval>0&&n.getCallHealthDataFromAdapter(e,t,c,i,a)})}var l=this.handleEvents(r,t,i,a);l.length>0&&this.trigger(this.constants.events.calling.callHealthValuesUpdated,teamspace.services.TeamsCallService.getTeamsCallIdAsString(t),{teamsCallId:t,meetingPanelLocation:i,meetingPanelSubSection:a,categoryDiffs:l})},t.prototype.isParticipantScreenSharing=function(e){return!!e.find(function(e){return e.streams[1][0]&&e.streams[1][0].isStreaming})},t.prototype.updateCallDataAndGetEvents=function(e,t,i){void 0===i&&(i=!1);var a=[],n=this.callingService.getCallByTeamsCallId(t),r=this.isParticipantScreenSharing(n.participants);return(i||n.isVideoOn!==e.isVideoOn)&&(e.isVideoOn=n.isVideoOn,a.push(e.isVideoOn?"VideoTurnedOn_Enable":"VideoTurnedOff_Disable")),(i||n.isScreenSharingOn!==e.isScreenSharingOn)&&(e.isScreenSharingOn=n.isScreenSharingOn,a.push(e.isScreenSharingOn?"ScreenSharingTurnedOn_Enable":"ScreenSharingTurnedOff_Disable")),(i||n.isMuted!==e.isMuted)&&(e.isMuted=n.isMuted,a.push(e.isMuted?"AudioTurnedOff_Disable":"AudioTurnedOn_Enable")),(i||r!==e.isParticipantScreenSharing)&&(e.isParticipantScreenSharing=r,a.push(e.isParticipantScreenSharing?"PariticipantScreenSharingOn_Enable":"PariticipantScreenSharingOff_Disable")),a},t.prototype.cleanupCallHealthDataChanges=function(e){var t=this;this.activeTimers.get(e).forEach(function(e){t.$interval.cancel(e)}),this.activeTimers.delete(e);var i=this.activeCallData.get(e);i&&i.subscription.dispose(),this.activeCallData.delete(e)},t.prototype.addToActiveTimers=function(e,t){this.activeTimers.has(e)||this.activeTimers.set(e,[]),this.activeTimers.get(e).push(t)},t.prototype.handleEvents=function(e,t,i,a){var n=this.getCallHealthDataId(t,i,a),r=[];return this.callHealthDataMap.get(n).categories.forEach(function(t){var i=t.handleEvents(e);i&&r.push(i)}),r},t.prototype.initializeCallHealthData=function(e,t,i){var a=this,n=this.getCallHealthDataId(e,t,i),r=this.callingService.getCallByTeamsCallId(e),s=this.callHealthMetricDefinitionFactory.getCallHealthData(t,i);if(!s){var c="No callHealthData found for "+t+" "+i;return this.logger.error(c),c}this.callHealthDataMap.set(n,s),this.callStateChangedSubscriptions.has(e)||this.callStateChangedSubscriptions.set(e,r.on("callStateChanged",function(){return a.callStateChanged(r)}))},t.prototype.callStateChanged=function(e){var t=this;if(7===e.state){var i=e.teamsCallId+"_",a=[];this.callHealthDataMap.forEach(function(e,t){t.startsWith(i)&&a.push(t)}),a.forEach(function(e){t.activeTimersSubscriptionsCnt.has(e)&&(t.cleanupCallHealthDataChanges(e),t.activeTimersSubscriptionsCnt.delete(e)),t.callHealthDataMap.delete(e)}),this.callStateChangedSubscriptions.get(e.teamsCallId).dispose(),this.callStateChangedSubscriptions.delete(e.teamsCallId)}},t.prototype.getDataFromDataAdapters=function(e,t,i){var a=this,n=this.getCallHealthDataId(e,t,i);return new Promise(function(r,s){var c=[],l=[],o=a.callHealthDataMap.get(n);o.dataAdapters.forEach(function(t){c.push(t.getData(e)),l.push(t.adapterType)}),Promise.all(c).then(function(n){n.forEach(function(e,t){a.updateCategories(o.categories,l[t],e)});var s=a.initCallData(e),c=a.updateCallDataAndGetEvents(s,e,!0);a.handleEvents(c,e,t,i),r()}).catch(function(e){s(e)})})},t.prototype.updateCategories=function(e,t,i){var a=[];return e.forEach(function(e){var n=e.updateMetrics(t,i);n&&a.push(n)}),a},t.prototype.cleanupOnAppTeardown=function(e){var t=this;this.activeTimersSubscriptionsCnt.forEach(function(e,i){return t.cleanupCallHealthDataChanges(i)}),this.callHealthDataMap=new Map,this.callStateChangedSubscriptions=new Map,this.activeTimers=new Map,this.activeCallData=new Map,this.activeTimersSubscriptionsCnt=new Map},t.prototype.mtmaTelemetryIdentifier=function(){return"CallHealthLazyLoadService"},Object.defineProperty(t.prototype,"navCtx",{get:function(){return"call-health-lazyload-service"},enumerable:!0,configurable:!0}),t}(SkypeX.Services.ObservableBase);t.CallHealthLazyLoadService=r,angular.module("teamspace.callHealthService",["teamspace.orchestrationService","teamspace.loggingService","teamspace.callingService","teamspace.constants","teamspace.settingsService","skypeX.meetingPolicySettingsStore"]).service("callHealthService",r)},2756:function(e,t,i){"use strict";var a=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}();Object.defineProperty(t,"__esModule",{value:!0});var n,r=i(2757),s=i(2758),c=i(2760);!function(e){e.NETWORK="Network",e.DEVICES="Devices",e.POLICY="Policy"}(n||(n={}));var l;!function(e){e.NETWORK="Network",e.AUDIO="Audio",e.VIDEO="Video",e.SCREENSHARING="ScreenSharing",e.POLICY="Policy",e.NETWORK_DETAILS="NetworkDetails",e.AUDIO_DETAILS="AudioDetails",e.VIDEO_DETAILS="VideoDetails",e.SCREENSHARING_DETAILS="ScreenSharingDetails",e.POLICY_DETAILS="PolicyDetails"}(l||(l={}));var o=function(e){function t(t,i,a,n,r,l,o,h){var d=e.call(this)||this;return d.$translate=t,d.resources=i,d.settingsService=l,d.constants=o,d.dataAdapters=new Map,d.logger=r.newLogger("CallHealthMetricDefinitionFactory"),d.callTechnicalInfoStatsMetrics=new s.CallTechnicalInfoStatsMetrics(t,i,a,n,r,l,o),d.meetingPolicySettingsMetrics=new c.MeetingPolicySettingsMetrics(t,i,h),d.initializeOnAppLaunchAndReinit(),d}return a(t,e),t.prototype.initializeOnAppLaunchAndReinit=function(){this.createDataAdapterMap()},Object.defineProperty(t.prototype,"navCtx",{get:function(){return"call-health-metric-definition-factory"},enumerable:!0,configurable:!0}),t.prototype.createDataAdapterMap=function(){this.dataAdapters.set("CallTechnicalInfo",this.callTechnicalInfoStatsMetrics.getDataAdapterCallTechnicalInfoStats()),this.dataAdapters.set("MeetingSettingsStore",this.meetingPolicySettingsMetrics.getDataAdapterMeetingSettingsStore())},t.prototype.getCallHealthData=function(e,t){var i;switch(e){case"ProducerScreen":case"ContributorScreen":i=this.getLiveEventsCategories(t);break;case"CallHealthScreen":i=this.getCallHealthScreenSubSections(t);break;default:this.logger.error("getCallHealthData(), unknown meetingPanelLocation '"+e+"'")}if(i){var a={categories:i,dataAdapters:new Map,events:new Set};return this.addDataAdapterAndEvents(a),a}},t.prototype.getCallHealthScreenSubSections=function(e){if(!e)return this.getCallHealthRootScreenCategories();switch(e){case l.NETWORK:return this.getCallHealthNetworkScreenCategories();case l.AUDIO:return this.getCallHealthAudioScreenCategories();case l.VIDEO:return this.getCallHealthVideoScreenCategories();case l.SCREENSHARING:return this.getCallHealthScreenSharingScreenCategories();case l.POLICY:return this.getCallHealthPolicyCategories();default:return void this.logger.error("getCallHealthScreenSubSections(), unknown meetingPanelSubSection '"+e+"'")}},t.prototype.addDataAdapterAndEvents=function(e){var t=this;e.categories.forEach(function(i){i.metrics.forEach(function(i){e.dataAdapters.has(i.dataAdapterType)||e.dataAdapters.set(i.dataAdapterType,t.dataAdapters.get(i.dataAdapterType)),i.events&&i.events.forEach(function(t){return e.events.add(t)})})})},t.prototype.getLiveEventsCategories=function(e){var t;if(t=this.getCallHealthScreenSubSections(e),!e){var i=[];i.push(this.meetingPolicySettingsMetrics.getMediaSharingPolicyMetric()),i.push(this.meetingPolicySettingsMetrics.getMediaBitRateLimitPolicyMetric()),t.push(new r.CallHealthCategory(n.POLICY,this.$translate.instant(this.resources.strings.call_health_tab_category_title_policy),i))}return t},t.prototype.getCallHealthRootScreenCategories=function(){var e=[];if(this.settingsService.valueAsBoolean(this.constants.settings.names.enableNetworkCategoryInCallHealth)){var t=[];t.push(this.callTechnicalInfoStatsMetrics.getNetworkSendRoundTripTimeMetric()),t.push(this.callTechnicalInfoStatsMetrics.getNetworkLossRateMetric()),e.push(new r.CallHealthCategory(l.NETWORK,this.$translate.instant(this.resources.strings.call_health_tab_category_title_network),t))}var i=[],a={helpText:this.$translate.instant(this.resources.strings.call_health_tab_microphone_disabled_text),disabledText:this.$translate.instant(this.resources.strings.call_health_tab_microphone_disabled_text)};i.push(this.callTechnicalInfoStatsMetrics.getAudioSendBpsMetric()),i.push(this.callTechnicalInfoStatsMetrics.getAudioJitterMetric()),e.push(new r.CallHealthCategory(l.AUDIO,this.$translate.instant(this.resources.strings.call_health_tab_category_title_audio),i,["AudioTurnedOn_Enable","AudioTurnedOff_Disable"],a));var n=[],s={helpText:this.$translate.instant(this.resources.strings.call_health_tab_video_disabled_text),disabledText:this.$translate.instant(this.resources.strings.call_health_tab_video_disabled_text)};n.push(this.callTechnicalInfoStatsMetrics.getVideoSendFrameRateMetric()),n.push(this.callTechnicalInfoStatsMetrics.getVideoSendWidthMetric()),n.push(this.callTechnicalInfoStatsMetrics.getVideoSendHeightMetric()),n.push(this.callTechnicalInfoStatsMetrics.getVideoSendCodecMetric()),n.push(this.callTechnicalInfoStatsMetrics.getVideoProcessingTypeMetric()),e.push(new r.CallHealthCategory(l.VIDEO,this.$translate.instant(this.resources.strings.call_health_tab_category_title_video),n,["VideoTurnedOn_Enable","VideoTurnedOff_Disable"],s));var c=[],o={helpText:this.$translate.instant(this.resources.strings.call_health_tab_screensharing_disabled_text),disabledText:this.$translate.instant(this.resources.strings.call_health_tab_screensharing_disabled_text)};return c.push(this.callTechnicalInfoStatsMetrics.getScreenSharingSendFrameRateMetric()),c.push(this.callTechnicalInfoStatsMetrics.getScreenSharingSendWidthMetric()),c.push(this.callTechnicalInfoStatsMetrics.getScreenSharingSendHeightMetric()),c.push(this.callTechnicalInfoStatsMetrics.getScreenSharingSendCodecMetric()),c.push(this.callTechnicalInfoStatsMetrics.getScreenSharingProcessingTypeMetric()),c.push(this.callTechnicalInfoStatsMetrics.getScreenSharingReceivedFrameRateMetric()),c.push(this.callTechnicalInfoStatsMetrics.getScreenSharingReceivedWidthMetric()),c.push(this.callTechnicalInfoStatsMetrics.getScreenSharingReceivedHeightMetric()),c.push(this.callTechnicalInfoStatsMetrics.getScreenSharingReceivedCodecMetric()),c.push(this.callTechnicalInfoStatsMetrics.getScreenSharingReceivedProcessingTypeMetric()),e.push(new r.CallHealthCategory(l.SCREENSHARING,this.$translate.instant(this.resources.strings.call_health_tab_category_title_screensharing),c,["ScreenSharingTurnedOn_Enable","ScreenSharingTurnedOff_Disable"],o)),e},t.prototype.getCallHealthNetworkScreenCategories=function(){var e=[],t=[];return t.push(this.callTechnicalInfoStatsMetrics.getNetworkSendBandwidthEstimateMetric()),t.push(this.callTechnicalInfoStatsMetrics.getNetworkReceivedBandwidthEstimateMetric()),t.push(this.callTechnicalInfoStatsMetrics.getNetworkSendRoundTripTimeMetric()),t.push(this.callTechnicalInfoStatsMetrics.getNetworkLossRateMetric()),e.push(new r.CallHealthCategory(l.NETWORK_DETAILS,this.$translate.instant(this.resources.strings.call_health_tab_category_title_network),t)),e},t.prototype.getCallHealthAudioScreenCategories=function(){var e=[],t=[];return t.push(this.callTechnicalInfoStatsMetrics.getAudioSendBpsMetric()),t.push(this.callTechnicalInfoStatsMetrics.getAudioSendRtpPacketsMetric()),t.push(this.callTechnicalInfoStatsMetrics.getAudioSendRoundTripTimeMetric()),t.push(this.callTechnicalInfoStatsMetrics.getAudioSendCodecMetric()),t.push(this.callTechnicalInfoStatsMetrics.getAudioJitterMetric()),t.push(this.callTechnicalInfoStatsMetrics.getAudioLossRateMetric()),t.push(this.callTechnicalInfoStatsMetrics.getAudioReceivedRtpPacketsMetric()),t.push(this.callTechnicalInfoStatsMetrics.getAudioReceivedCodecMetric()),e.push(new r.CallHealthCategory(l.AUDIO_DETAILS,this.$translate.instant(this.resources.strings.call_health_tab_category_title_audio),t)),e},t.prototype.getCallHealthVideoScreenCategories=function(){var e=[],t=[];return t.push(this.callTechnicalInfoStatsMetrics.getVideoSendFrameRateMetric()),t.push(this.callTechnicalInfoStatsMetrics.getVideoSendWidthMetric()),t.push(this.callTechnicalInfoStatsMetrics.getVideoSendHeightMetric()),t.push(this.callTechnicalInfoStatsMetrics.getVideoSendBitrateMetric()),t.push(this.callTechnicalInfoStatsMetrics.getVideoSendRoundTripTimeMetric()),t.push(this.callTechnicalInfoStatsMetrics.getVideoSendRtpPacketsMetric()),t.push(this.callTechnicalInfoStatsMetrics.getVideoSendCodecMetric()),t.push(this.callTechnicalInfoStatsMetrics.getVideoProcessingTypeMetric()),e.push(new r.CallHealthCategory(l.VIDEO_DETAILS,this.$translate.instant(this.resources.strings.call_health_tab_category_title_video),t)),e},t.prototype.getCallHealthScreenSharingScreenCategories=function(){var e=[],t=[];return t.push(this.callTechnicalInfoStatsMetrics.getScreenSharingSendFrameRateMetric()),t.push(this.callTechnicalInfoStatsMetrics.getScreenSharingSendWidthMetric()),t.push(this.callTechnicalInfoStatsMetrics.getScreenSharingSendHeightMetric()),t.push(this.callTechnicalInfoStatsMetrics.getScreenSharingSendBitrateMetric()),t.push(this.callTechnicalInfoStatsMetrics.getScreenSharingSendRoundTripTimeMetric()),t.push(this.callTechnicalInfoStatsMetrics.getScreenSharingSendRtpPacketsMetric()),t.push(this.callTechnicalInfoStatsMetrics.getScreenSharingSendCodecMetric()),t.push(this.callTechnicalInfoStatsMetrics.getScreenSharingProcessingTypeMetric()),t.push(this.callTechnicalInfoStatsMetrics.getScreenSharingReceivedFrameRateMetric()),t.push(this.callTechnicalInfoStatsMetrics.getScreenSharingReceivedWidthMetric()),t.push(this.callTechnicalInfoStatsMetrics.getScreenSharingReceivedHeightMetric()),t.push(this.callTechnicalInfoStatsMetrics.getScreenSharingReceivedBitrateMetric()),t.push(this.callTechnicalInfoStatsMetrics.getScreenSharingLossRateMetric()),t.push(this.callTechnicalInfoStatsMetrics.getScreenSharingReceivedRtpPacketsMetric()),t.push(this.callTechnicalInfoStatsMetrics.getScreenSharingReceivedCodecMetric()),t.push(this.callTechnicalInfoStatsMetrics.getScreenSharingReceivedProcessingTypeMetric()),e.push(new r.CallHealthCategory(l.SCREENSHARING_DETAILS,this.$translate.instant(this.resources.strings.call_health_tab_category_title_screensharing),t)),e},t.prototype.getCallHealthPolicyCategories=function(){var e=[],t=[];return t.push(this.meetingPolicySettingsMetrics.getMediaSharingPolicyMetric()),t.push(this.meetingPolicySettingsMetrics.getMediaBitRateLimitPolicyMetric()),e.push(new r.CallHealthCategory(l.POLICY_DETAILS,this.$translate.instant(this.resources.strings.call_health_tab_category_title_policy),t)),e},t.prototype.cleanupOnAppTeardown=function(e){this.dataAdapters.clear()},t}(SkypeX.Services.ObservableBase);t.CallHealthMetricDefinitionFactory=o},2757:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=teamspace.services.CallHealthState,n=teamspace.services.CallHealthStateNumber,r=function(){function e(e,t,i,a,n){void 0===a&&(a=null),void 0===n&&(n=null),this.name=e,this.title=t,this.metrics=i,this.events=a,this.messages=n,this.state=teamspace.services.CallHealthState.NotAvailable,this.enabled=!0,this.name=this.name.replace(/[^a-zA-Z0-9]+/g,"_")}return e.prototype.updateMetrics=function(e,t){var i={name:this.name,enabled:this.enabled,metricDiffs:[]};if(this.metrics.forEach(function(a){if(a.dataAdapterType===e){var n=a.updateMetric(t);n&&i.metricDiffs.push(n)}}),i.metricDiffs.length>0){var r=Math.max.apply(Math,this.metrics.map(function(e){return n[e.state]})),s=n[r],c=a[s];return this.state!==c&&(this.state=i.state=c),i}},e.prototype.handleEvents=function(e){var t=this,i={name:this.name,metricDiffs:[]};if(this.events&&this.events.forEach(function(a){if(e.find(function(e){return e===a}))switch(a){case"VideoTurnedOn_Enable":case"ScreenSharingTurnedOn_Enable":case"AudioTurnedOn_Enable":t.enabled||(t.enabled=i.enabled=!0);break;case"VideoTurnedOff_Disable":case"ScreenSharingTurnedOff_Disable":case"AudioTurnedOff_Disable":t.enabled&&(t.enabled=i.enabled=!1)}}),this.metrics.forEach(function(t){var a=t.handleEvents(e);a&&i.metricDiffs.push(a)}),i.metricDiffs.length>0)return i},e}();t.CallHealthCategory=r},2758:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,n=i(97),r=i(2759),s=i(353);!function(e){e.SendAudioJitter="Audio NW jitter avg",e.SendAudioBps="Audio send bps",e.SendAudioCodec="Send Audio Codec",e.RecvAudioCodec="Recv Audio Codec",e.SendBWEstimate="Sent BW estimate",e.ReceivedBWEstimate="Received BW estimate",e.SendRTTAvg="Send RTT (Avg)",e.SendCodecName="Sent Codec Name",e.ReceivedCodecName="Received Codec Name",e.SendActualHeight="Send Actual Height",e.SendActualWidth="Send Actual Width",e.ReceiveActualHeight="Receive Actual Height",e.ReceiveActualWidth="Receive Actual Width",e.ReceivedLossRate="Recv Loss Rate (Avg)",e.SendFrameRate="Send Current Frame Rate",e.ReceiveFrameRate="Receive Current Frame Rate",e.SendBitrate="Send Current Bitrate",e.ReceiveBitrate="Receive Current Bitrate",e.RtpPacketsSent="Rtp Packet Sent",e.RtpPacketsReceived="Rtp Packets Received"}(a||(a={}));var c;!function(e){e.AudioSendBWEstimate="Audio Sent BW estimate",e.AudioReceivedBWEstimate="Audio Received BW estimate",e.AudioSendBps="Audio send bps",e.AudioSendRTTAvg="Audio Send RTT (Avg)",e.AudioSendCodec="Audio Send Codec",e.AudioReceivedCodec="Audio Received Codec",e.AudioSendJitter="Audio NW jitter avg",e.AudioReceivedLossRate="Audio Recv Loss Rate (Avg)",e.AudioSendRtpPackets="Audio Rtp Packets Sent",e.AudioReceivedRtpPackets="Audio Rtp Packets Received",e.VideoSendBWEstimate="Video Sent BW estimate",e.VideoReceivedBWEstimate="Video Received BW estimate",e.VideoSendRTTAvg="Video Send RTT (Avg)",e.VideoSendCodec="Video Sent Codec Name",e.VideoProcessingType="Video Processing Type",e.VideoSendActualHeight="Video Send Actual Height",e.VideoSendActualWidth="Video Send Actual Width",e.VideoReceivedActualHeight="Video Received Actual Height",e.VideoReceivedActualWidth="Video Received Actual Width",e.VideoSendFrameRate="Video Send Current Frame Rate",e.VideoReceivedFrameRate="Video Receive Current Frame Rate",e.VideoSendBitrate="Video Send Current Bitrate",e.VideoReceivedBitrate="Video Receive Current Bitrate",e.VideoReceivedLossRate="Video Recv Loss Rate (Avg)",e.VideoSendRtpPackets="Video Rtp Packets Sent",e.VideoReceivedRtpPackets="Video Rtp Packets Received",e.ScreenSharingSendBWEstimate="ScreenSharing Sent BW estimate",e.ScreenSharingReceivedBWEstimate="ScreenSharing Received BW estimate",e.ScreenSharingSendRTTAvg="ScreenSharing Send RTT (Avg)",e.ScreenSharingSendCodec="ScreenSharing Sent Codec Name",e.ScreenSharingSendProcessingType="ScreenSharing Send Processing Type",e.ScreenSharingSendActualHeight="ScreenSharing Send Actual Height",e.ScreenSharingSendActualWidth="ScreenSharing Send Actual Width",e.ScreenSharingReceivedActualHeight="ScreenSharing Received Actual Height",e.ScreenSharingReceivedActualWidth="ScreenSharing Received Actual Width",e.ScreenSharingSendFrameRate="ScreenSharing Send Current Frame Rate",e.ScreenSharingReceivedFrameRate="ScreenSharing Receive Current Frame Rate",e.ScreenSharingSendBitrate="ScreenSharing Send Current Bitrate",e.ScreenSharingReceivedBitrate="ScreenSharing Receive Current Bitrate",e.ScreenSharingReceivedLossRate="ScreenSharing Recv Loss Rate (Avg)",e.ScreenSharingSendRtpPackets="ScreenSharing Rtp Packets Sent",e.ScreenSharingReceivedRtpPackets="ScreenSharing Rtp Packets Received",e.ScreenSharingReceivedCodec="ScreenSharingReceivedCodec",e.ScreenSharingReceivedProcessingType="ScreenSharingReceivedProcessingType",e.NetworkSendBWEstimate="Network Sent BW estimate",e.NetworkReceivedBWEstimate="Network Received BW estimate",e.NetworkSendBitrate="Network Send Current Bitrate",e.NetworkReceivedBitrate="Network Receive Current Bitrate",e.NetworkSendRTTAvg="Network Send RTT (Avg)",e.NetworkReceivedLossRate="Network Recv Loss Rate (Avg)"}(c||(c={}));var l=function(){function e(e,t,i,a,n,r,c){this.$translate=e,this.resources=t,this.callingService=i,this.$q=a,this.loggingService=n,this.settingsService=r,this.constants=c,this.technicalInfoApiCount=0,this.cancelablePromiseLastId=0,this.cancelablePromises=new Map,this.utils=new s.Utils(e,t),this.logger=n.newLogger("CallTechnicalInfoStatsMetrics"),this.callHealthTabSettings=r.valueFor(c.callHealthTab.settings)}return e.prototype.getDataAdapterCallTechnicalInfoStats=function(){var e=this,t=this.settingsService.valueFor(this.constants.callHealthTab.settings).technicalInfoRefreshRate;return{adapterType:"CallTechnicalInfo",getData:function(t){return new Promise(function(i,a){var n=e.callingService.getCallByTeamsCallId(t),r=e.cancelablePromiseLastId++,s=teamspace.services.QCancelable.toCancelablePromise(e.$q,e.getCallTechnicalInfoStats(r,n));e.cancelablePromises.set(r,s),s.then(function(t){var a=new Map,n=JSON.parse(t),r=n&&n.channels;if(!r)throw new Error("No channels available in call.getTechnicalInformationJson()");e.getAudioData(r,a),e.getVideoData(r,a),e.getScreenSharingData(r,a),e.setNetworkData(a),i(a)}).catch(function(t){e.logger.error("Error while fetching technical information from call. error = "+t.message),a(t)})})}.bind(this),refreshInterval:t}},e.prototype.getCallTechnicalInfoStats=function(e,t){var i=this;return this.technicalInfoApiCount%this.callHealthTabSettings.technicalInfoScenarioSampleNumber==0&&(this.getTechnicalInfoScenario=this.loggingService.newScenario(this.constants.callHealthTab.getTechnicalInfoScenario)),this.technicalInfoApiCount++,new Promise(function(a,n){t.getTechnicalInformationJson().then(function(t){i.technicalInfoApiLastCallSuccess=!0,i.technicalInfoApiLastCallError=null,i.getTechnicalInfoScenario&&(i.getTechnicalInfoScenario.stop(),i.getTechnicalInfoScenario=null),i.cancelablePromises.delete(e),a(t)}).catch(function(t){var a;i.logger.error("Error while fetching technical information from call. error = "+t.message),i.technicalInfoApiLastCallSuccess=!1,i.technicalInfoApiLastCallError=JSON.stringify(t),i.getTechnicalInfoScenario&&(i.getTechnicalInfoScenario.fail((a={},a[i.constants.scenarioDataPropNames.broadcastError]=JSON.stringify(t),a)),i.getTechnicalInfoScenario=null),i.loggingService.event(i.constants.callHealthTab.getTechnicalInfoFailure,{error:JSON.stringify(t)}),i.cancelablePromises.delete(e),n(t)})})},e.prototype.getAudioData=function(e,t){var i=e.find(function(e){return"Audio"===e.mediaType});i?(i.hasOwnProperty("Sent BW estimate")&&t.set("Audio Sent BW estimate",i["Sent BW estimate"]),i.hasOwnProperty("Received BW estimate")&&t.set("Audio Received BW estimate",i["Received BW estimate"]),i.hasOwnProperty("Audio send bps")&&t.set("Audio send bps",i["Audio send bps"]),i.hasOwnProperty("Rtp Packet Sent")&&t.set("Audio Rtp Packets Sent",i["Rtp Packet Sent"]),i.hasOwnProperty("Rtp Packets Received")&&t.set("Audio Rtp Packets Received",i["Rtp Packets Received"]),i.hasOwnProperty("Send RTT (Avg)")&&t.set("Audio Send RTT (Avg)",i["Send RTT (Avg)"]),i.hasOwnProperty("Audio NW jitter avg")&&t.set("Audio NW jitter avg",i["Audio NW jitter avg"]),i.hasOwnProperty("Recv Loss Rate (Avg)")&&t.set("Audio Recv Loss Rate (Avg)",i["Recv Loss Rate (Avg)"]),i.hasOwnProperty("Send Audio Codec")&&t.set("Audio Send Codec",i["Send Audio Codec"]),i.hasOwnProperty("Recv Audio Codec")&&t.set("Audio Received Codec",i["Recv Audio Codec"])):this.logger.error("No Audio channel found in callTechnicalInfoStats")},e.prototype.getVideoData=function(e,t){var i=e.find(function(e){return"Camera"===e.mediaType});if(i){if(i.hasOwnProperty("Sent BW estimate")&&t.set("Video Sent BW estimate",i["Sent BW estimate"]),i.hasOwnProperty("Received BW estimate")&&t.set("Video Received BW estimate",i["Received BW estimate"]),i.hasOwnProperty("Rtp Packet Sent")&&t.set("Video Rtp Packets Sent",i["Rtp Packet Sent"]),i.hasOwnProperty("Rtp Packets Received")&&t.set("Video Rtp Packets Received",i["Rtp Packets Received"]),i.hasOwnProperty("Send RTT (Avg)")&&t.set("Video Send RTT (Avg)",i["Send RTT (Avg)"]),i.hasOwnProperty("Send Actual Width")&&t.set("Video Send Actual Width",i["Send Actual Width"]),i.hasOwnProperty("Send Actual Height")&&t.set("Video Send Actual Height",i["Send Actual Height"]),i.hasOwnProperty("Receive Actual Width")&&t.set("Video Received Actual Width",i["Receive Actual Width"]),i.hasOwnProperty("Receive Actual Height")&&t.set("Video Received Actual Height",i["Receive Actual Height"]),i.hasOwnProperty("Send Current Frame Rate")&&t.set("Video Send Current Frame Rate",i["Send Current Frame Rate"]),i.hasOwnProperty("Receive Current Frame Rate")&&t.set("Video Receive Current Frame Rate",i["Receive Current Frame Rate"]),i.hasOwnProperty("Send Current Bitrate")&&t.set("Video Send Current Bitrate",i["Send Current Bitrate"]),i.hasOwnProperty("Receive Current Bitrate")&&t.set("Video Receive Current Bitrate",i["Receive Current Bitrate"]),i.hasOwnProperty("Recv Loss Rate (Avg)")&&t.set("Video Recv Loss Rate (Avg)",i["Recv Loss Rate (Avg)"]),i.hasOwnProperty("Sent Codec Name")){t.set("Video Sent Codec Name",i["Sent Codec Name"]);var a=void 0,n=i["Sent Codec Name"].toString().trim().split(" ");2===n.length?a="hw"==n[1]?"Hardware":"Software":n.length>2&&(a="HardwareSoftwareFluctuation"),t.set("Video Processing Type",a)}}else this.logger.error("No Camera channel found in callTechnicalInfoStats")},e.prototype.getScreenSharingData=function(e,t){var i=e.find(function(e){return"AppSharing"===e.mediaType});if(i){if(i.hasOwnProperty("Sent BW estimate")&&t.set("ScreenSharing Sent BW estimate",i["Sent BW estimate"]),i.hasOwnProperty("Received BW estimate")&&t.set("ScreenSharing Received BW estimate",i["Received BW estimate"]),i.hasOwnProperty("Rtp Packet Sent")&&t.set("ScreenSharing Rtp Packets Sent",i["Rtp Packet Sent"]),i.hasOwnProperty("Rtp Packets Received")&&t.set("ScreenSharing Rtp Packets Received",i["Rtp Packets Received"]),i.hasOwnProperty("Send RTT (Avg)")&&t.set("ScreenSharing Send RTT (Avg)",i["Send RTT (Avg)"]),i.hasOwnProperty("Send Actual Width")&&t.set("ScreenSharing Send Actual Width",i["Send Actual Width"]),i.hasOwnProperty("Send Actual Height")&&t.set("ScreenSharing Send Actual Height",i["Send Actual Height"]),i.hasOwnProperty("Receive Actual Width")&&t.set("ScreenSharing Received Actual Width",i["Receive Actual Width"]),i.hasOwnProperty("Receive Actual Height")&&t.set("ScreenSharing Received Actual Height",i["Receive Actual Height"]),i.hasOwnProperty("Send Current Frame Rate")&&t.set("ScreenSharing Send Current Frame Rate",i["Send Current Frame Rate"]),i.hasOwnProperty("Receive Current Frame Rate")&&t.set("ScreenSharing Receive Current Frame Rate",i["Receive Current Frame Rate"]),i.hasOwnProperty("Send Current Bitrate")&&t.set("ScreenSharing Send Current Bitrate",i["Send Current Bitrate"]),i.hasOwnProperty("Receive Current Bitrate")&&t.set("ScreenSharing Receive Current Bitrate",i["Receive Current Bitrate"]),i.hasOwnProperty("Recv Loss Rate (Avg)")&&t.set("ScreenSharing Recv Loss Rate (Avg)",i["Recv Loss Rate (Avg)"]),i.hasOwnProperty("Sent Codec Name")){t.set("ScreenSharing Sent Codec Name",i["Sent Codec Name"]);a=void 0;2===(n=i["Sent Codec Name"].toString().trim().split(" ")).length?a="hw"==n[1]?"Hardware":"Software":n.length>2&&(a="HardwareSoftwareFluctuation"),t.set("ScreenSharing Send Processing Type",a)}if(i.hasOwnProperty("Received Codec Name")){t.set("ScreenSharingReceivedCodec",i["Received Codec Name"]);var a=void 0,n=i["Received Codec Name"].toString().trim().split(" ");2===n.length?a="hw"==n[1]?"Hardware":"Software":n.length>2&&(a="HardwareSoftwareFluctuation"),t.set("ScreenSharingReceivedProcessingType",a)}}else this.logger.error("No AppSharing channel found in callTechnicalInfoStats")},e.prototype.setNetworkData=function(e){e.set("Network Sent BW estimate",this.getMaxValue(e,"Video Sent BW estimate","ScreenSharing Sent BW estimate","Audio Sent BW estimate")),e.set("Network Received BW estimate",this.getMaxValue(e,"Video Received BW estimate","ScreenSharing Received BW estimate","Audio Received BW estimate")),e.set("Network Send Current Bitrate",this.getMaxValue(e,"Video Send Current Bitrate","ScreenSharing Send Current Bitrate","Audio send bps")),e.set("Network Receive Current Bitrate",this.getMaxValue(e,"Video Receive Current Bitrate","ScreenSharing Received BW estimate")),e.set("Network Send RTT (Avg)",this.getMaxValue(e,"Video Send RTT (Avg)","ScreenSharing Send RTT (Avg)","Audio Send RTT (Avg)")),e.set("Network Recv Loss Rate (Avg)",this.getMaxValue(e,"Video Recv Loss Rate (Avg)","ScreenSharing Recv Loss Rate (Avg)","Audio Recv Loss Rate (Avg)"))},e.prototype.getMaxValue=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];var a=0;return t.forEach(function(t){var i=e.get(t),n="string"==typeof i?parseFloat(i):Number.NaN;!isNaN(n)&&n>a&&(a=n)}),a},e.prototype.getAudioSendBandwidthEstimateMetric=function(){return this.getSendBandwidthEstimateMetric("Audio Sent BW estimate")},e.prototype.getVideoSendBandwidthEstimateMetric=function(){return this.getSendBandwidthEstimateMetric("Video Sent BW estimate",["VideoTurnedOn_Enable","VideoTurnedOff_Disable"],this.resources.strings.call_health_tab_video_disabled_text)},e.prototype.getScreenSharingSendBandwidthEstimateMetric=function(){return this.getSendBandwidthEstimateMetric("ScreenSharing Sent BW estimate")},e.prototype.getNetworkSendBandwidthEstimateMetric=function(){return this.getSendBandwidthEstimateMetric("Network Sent BW estimate")},e.prototype.getSendBandwidthEstimateMetric=function(e,t,i){void 0===t&&(t=null),void 0===i&&(i=null);var a=this.$translate.instant(this.resources.strings.call_health_tab_metric_title_send_bandwidth),r={helpText:this.$translate.instant(this.resources.strings.call_health_tab_metric_tooltip_send_bandwidth)};return i&&(r.disabledText=this.$translate.instant(i)),new n.CallHealthMetric(a,r,"CallTechnicalInfo",e,this.utils.convertToMBps,t,"HigherIsBetter",{Amber:2e6,Red:1e6})},e.prototype.getAudioReceivedBandwidthEstimateMetric=function(){return this.getReceivedBandwidthEstimateMetric("Audio Received BW estimate")},e.prototype.getVideoReceivedBandwidthEstimateMetric=function(){return this.getReceivedBandwidthEstimateMetric("Video Received BW estimate")},e.prototype.getScreenSharingReceivedBandwidthEstimateMetric=function(){return this.getReceivedBandwidthEstimateMetric("ScreenSharing Received BW estimate")},e.prototype.getNetworkReceivedBandwidthEstimateMetric=function(){return this.getReceivedBandwidthEstimateMetric("Network Received BW estimate")},e.prototype.getReceivedBandwidthEstimateMetric=function(e,t,i){void 0===t&&(t=null),void 0===i&&(i=null);var a=this.$translate.instant(this.resources.strings.call_health_tab_metric_title_received_bandwidth),r={helpText:this.$translate.instant(this.resources.strings.call_health_tab_metric_tooltip_received_bandwidth)};return i&&(r.disabledText=this.$translate.instant(i)),new n.CallHealthMetric(a,r,"CallTechnicalInfo",e,this.utils.convertToMBps,t,"HigherIsBetter",{Amber:2e6,Red:1e6})},e.prototype.getAudioSendBpsMetric=function(){var e=this.$translate.instant(this.resources.strings.call_health_tab_metric_title_send_audio_bps),t={helpText:this.$translate.instant(this.resources.strings.call_health_tab_metric_tooltip_send_audio_bps),disabledText:this.$translate.instant(this.resources.strings.call_health_tab_microphone_disabled_text)};return new n.CallHealthMetric(e,t,"CallTechnicalInfo","Audio send bps",this.utils.convertToKBps,["AudioTurnedOn_Enable","AudioTurnedOff_Disable"])},e.prototype.getAudioSendRtpPacketsMetric=function(){return this.getSendRtpPacketsMetric("Audio Rtp Packets Sent",["AudioTurnedOn_Enable","AudioTurnedOff_Disable"],this.resources.strings.call_health_tab_microphone_disabled_text)},e.prototype.getVideoSendRtpPacketsMetric=function(){return this.getSendRtpPacketsMetric("Video Rtp Packets Sent",["VideoTurnedOn_Enable","VideoTurnedOff_Disable"],this.resources.strings.call_health_tab_video_disabled_text)},e.prototype.getScreenSharingSendRtpPacketsMetric=function(){return this.getSendRtpPacketsMetric("ScreenSharing Rtp Packets Sent",["ScreenSharingTurnedOn_Enable","ScreenSharingTurnedOff_Disable"],this.resources.strings.call_health_tab_screensharing_disabled_text)},e.prototype.getSendRtpPacketsMetric=function(e,t,i){void 0===t&&(t=null),void 0===i&&(i=null);var a=this.$translate.instant(this.resources.strings.call_health_tab_metric_title_send_rtp_packets),r={helpText:this.$translate.instant(this.resources.strings.call_health_tab_metric_tooltip_send_rtp_packets)};return i&&(r.disabledText=this.$translate.instant(i)),new n.CallHealthMetric(a,r,"CallTechnicalInfo",e,this.utils.convertToPackets,t)},e.prototype.getAudioReceivedRtpPacketsMetric=function(){return this.getReceivedRtpPacketsMetric("Audio Rtp Packets Received")},e.prototype.getVideoReceivedRtpPacketsMetric=function(){return this.getReceivedRtpPacketsMetric("Video Rtp Packets Received")},e.prototype.getScreenSharingReceivedRtpPacketsMetric=function(){return this.getReceivedRtpPacketsMetric("ScreenSharing Rtp Packets Received",["PariticipantScreenSharingOn_Enable","PariticipantScreenSharingOff_Disable"],this.resources.strings.call_health_tab_participant_screensharing_disabled_text)},e.prototype.getReceivedRtpPacketsMetric=function(e,t,i){void 0===t&&(t=null),void 0===i&&(i=null);var a=this.$translate.instant(this.resources.strings.call_health_tab_metric_title_received_rtp_packets),r={helpText:this.$translate.instant(this.resources.strings.call_health_tab_metric_tooltip_received_rtp_packets)};return i&&(r.disabledText=this.$translate.instant(i)),new n.CallHealthMetric(a,r,"CallTechnicalInfo",e,this.utils.convertToPackets,t)},e.prototype.getAudioSendRoundTripTimeMetric=function(){return this.getRoundTripTimeMetric("Audio Send RTT (Avg)",["AudioTurnedOn_Enable","AudioTurnedOff_Disable"],this.resources.strings.call_health_tab_microphone_disabled_text)},e.prototype.getVideoSendRoundTripTimeMetric=function(){return this.getRoundTripTimeMetric("Video Send RTT (Avg)",["VideoTurnedOn_Enable","VideoTurnedOff_Disable"],this.resources.strings.call_health_tab_video_disabled_text)},e.prototype.getScreenSharingSendRoundTripTimeMetric=function(){return this.getRoundTripTimeMetric("ScreenSharing Send RTT (Avg)",["ScreenSharingTurnedOn_Enable","ScreenSharingTurnedOff_Disable"],this.resources.strings.call_health_tab_screensharing_disabled_text)},e.prototype.getNetworkSendRoundTripTimeMetric=function(){return this.getRoundTripTimeMetric("Network Send RTT (Avg)")},e.prototype.getRoundTripTimeMetric=function(e,t,i){void 0===t&&(t=null),void 0===i&&(i=null);var a=this.$translate.instant(this.resources.strings.call_health_tab_metric_title_round_trip_time),r={helpText:this.$translate.instant(this.resources.strings.call_health_tab_metric_tooltip_round_trip_time)};return i&&(r.disabledText=this.$translate.instant(i)),new n.CallHealthMetric(a,r,"CallTechnicalInfo",e,this.utils.convertToMs,t,"LowerIsBetter",{Amber:50,Red:75})},e.prototype.getAudioJitterMetric=function(){var e=this.$translate.instant(this.resources.strings.call_health_tab_metric_title_audio_jitter),t={helpText:this.$translate.instant(this.resources.strings.call_health_tab_metric_tooltip_audio_jitter),disabledText:this.$translate.instant(this.resources.strings.call_health_tab_microphone_disabled_text)};return new n.CallHealthMetric(e,t,"CallTechnicalInfo","Audio NW jitter avg",this.utils.convertToMs)},e.prototype.getAudioLossRateMetric=function(){return this.getLossRateMetric("Audio Recv Loss Rate (Avg)")},e.prototype.getVideoLossRateMetric=function(){return this.getLossRateMetric("Video Recv Loss Rate (Avg)")},e.prototype.getScreenSharingLossRateMetric=function(){return this.getLossRateMetric("ScreenSharing Recv Loss Rate (Avg)",["PariticipantScreenSharingOn_Enable","PariticipantScreenSharingOff_Disable"],this.resources.strings.call_health_tab_participant_screensharing_disabled_text)},e.prototype.getNetworkLossRateMetric=function(){return this.getLossRateMetric("Network Recv Loss Rate (Avg)")},e.prototype.getLossRateMetric=function(e,t,i){void 0===t&&(t=null),void 0===i&&(i=null);var a=this.$translate.instant(this.resources.strings.call_health_tab_metric_title_recv_loss_rate),r={helpText:this.$translate.instant(this.resources.strings.call_health_tab_metric_tooltip_loss_rate)};return i&&(r.disabledText=this.$translate.instant(i)),new n.CallHealthMetric(a,r,"CallTechnicalInfo",e,this.utils.convertToPercentage,t)},e.prototype.getVideoSendFrameRateMetric=function(){return this.getSendFrameRateMetric("Video Send Current Frame Rate",["VideoTurnedOn_Enable","VideoTurnedOff_Disable"],this.resources.strings.call_health_tab_video_disabled_text)},e.prototype.getScreenSharingSendFrameRateMetric=function(){return this.getSendFrameRateMetric("ScreenSharing Send Current Frame Rate",["ScreenSharingTurnedOn_Enable","ScreenSharingTurnedOff_Disable"],this.resources.strings.call_health_tab_screensharing_disabled_text)},e.prototype.getSendFrameRateMetric=function(e,t,i){void 0===t&&(t=null),void 0===i&&(i=null);var a=this.$translate.instant(this.resources.strings.call_health_tab_metric_title_send_frame_rate),r={helpText:this.$translate.instant(this.resources.strings.call_health_tab_metric_tooltip_send_frame_rate)};return i&&(r.disabledText=this.$translate.instant(i)),new n.CallHealthMetric(a,r,"CallTechnicalInfo",e,this.utils.convertToFps,t)},e.prototype.getVideoReceivedFrameRateMetric=function(){return this.getReceivedFrameRateMetric("Video Receive Current Frame Rate")},e.prototype.getScreenSharingReceivedFrameRateMetric=function(){return this.getReceivedFrameRateMetric("ScreenSharing Receive Current Frame Rate",["PariticipantScreenSharingOn_Enable","PariticipantScreenSharingOff_Disable"],this.resources.strings.call_health_tab_participant_screensharing_disabled_text)},e.prototype.getReceivedFrameRateMetric=function(e,t,i){void 0===t&&(t=null),void 0===i&&(i=null);var a=this.$translate.instant(this.resources.strings.call_health_tab_metric_title_received_frame_rate),r={helpText:this.$translate.instant(this.resources.strings.call_health_tab_metric_tooltip_received_frame_rate)};return i&&(r.disabledText=this.$translate.instant(i)),new n.CallHealthMetric(a,r,"CallTechnicalInfo",e,this.utils.convertToFps,t)},e.prototype.getVideoSendBitrateMetric=function(){return this.getSendBitrateMetric("Video Send Current Bitrate",["VideoTurnedOn_Enable","VideoTurnedOff_Disable"],this.resources.strings.call_health_tab_video_disabled_text)},e.prototype.getScreenSharingSendBitrateMetric=function(){return this.getSendBitrateMetric("ScreenSharing Send Current Bitrate",["ScreenSharingTurnedOn_Enable","ScreenSharingTurnedOff_Disable"],this.resources.strings.call_health_tab_screensharing_disabled_text)},e.prototype.getNetworkSendBitrateMetric=function(){return this.getSendBitrateMetric("Network Send Current Bitrate")},e.prototype.getSendBitrateMetric=function(e,t,i){void 0===t&&(t=null),void 0===i&&(i=null);var a=this.$translate.instant(this.resources.strings.call_health_tab_metric_title_send_bitrate),r={helpText:this.$translate.instant(this.resources.strings.call_health_tab_metric_tooltip_send_bitrate)};return i&&(r.disabledText=this.$translate.instant(i)),new n.CallHealthMetric(a,r,"CallTechnicalInfo",e,this.utils.convertToKBps,t)},e.prototype.getVideoReceivedBitrateMetric=function(){return this.getReceivedBitrateMetric("Video Receive Current Bitrate")},e.prototype.getScreenSharingReceivedBitrateMetric=function(){return this.getReceivedBitrateMetric("ScreenSharing Receive Current Bitrate",["PariticipantScreenSharingOn_Enable","PariticipantScreenSharingOff_Disable"],this.resources.strings.call_health_tab_participant_screensharing_disabled_text)},e.prototype.getNetworkReceivedBitrateMetric=function(){return this.getReceivedBitrateMetric("Network Receive Current Bitrate")},e.prototype.getReceivedBitrateMetric=function(e,t,i){void 0===t&&(t=null),void 0===i&&(i=null);var a=this.$translate.instant(this.resources.strings.call_health_tab_metric_title_received_bitrate),r={helpText:this.$translate.instant(this.resources.strings.call_health_tab_metric_tooltip_received_bitrate)};return i&&(r.disabledText=this.$translate.instant(i)),new n.CallHealthMetric(a,r,"CallTechnicalInfo",e,this.utils.convertToKBps,t)},e.prototype.getAudioSendCodecMetric=function(){var e=this,t=this.$translate.instant(this.resources.strings.call_health_tab_metric_title_send_audio_codec),i={helpText:this.$translate.instant(this.resources.strings.call_health_tab_metric_tooltip_send_audio_codec),disabledText:this.$translate.instant(this.resources.strings.call_health_tab_microphone_disabled_text)};return new n.CallHealthMetric(t,i,"CallTechnicalInfo","Audio Send Codec",function(t){return t||e.$translate.instant(e.resources.strings.call_health_no_data)},["AudioTurnedOn_Enable","AudioTurnedOff_Disable"])},e.prototype.getAudioReceivedCodecMetric=function(){var e=this,t=this.$translate.instant(this.resources.strings.call_health_tab_metric_title_received_audio_codec),i={helpText:this.$translate.instant(this.resources.strings.call_health_tab_metric_tooltip_received_audio_codec)};return new n.CallHealthMetric(t,i,"CallTechnicalInfo","Audio Received Codec",function(t){return t||e.$translate.instant(e.resources.strings.call_health_no_data)})},e.prototype.getVideoProcessingTypeMetric=function(){var e=this.$translate.instant(this.resources.strings.call_health_tab_metric_title_camera_codec),t={disabledText:this.$translate.instant(this.resources.strings.call_health_tab_video_disabled_text),helpText:this.$translate.instant(this.resources.strings.call_health_tab_metric_tooltip_camera_codec),stateAmberText:this.$translate.instant(this.resources.strings.call_health_tab_metric_amber_state_text_camera_codec),stateRedText:this.$translate.instant(this.resources.strings.call_health_tab_metric_red_state_text_camera_codec)};return new r.CallHealthMetricCodec(e,t,"CallTechnicalInfo","Video Processing Type",this.utils.convertToProcessingType,["VideoTurnedOn_Enable","VideoTurnedOff_Disable"],"None",null,teamspace.services.CallHealthState.NotAvailable,"metric-value-small-text")},e.prototype.getVideoSendCodecMetric=function(){var e=this,t=this.$translate.instant(this.resources.strings.call_health_tab_metric_title_video_send_codec),i={helpText:this.$translate.instant(this.resources.strings.call_health_tab_metric_tooltip_video_send_codec),disabledText:this.$translate.instant(this.resources.strings.call_health_tab_video_disabled_text)};return new n.CallHealthMetric(t,i,"CallTechnicalInfo","Video Sent Codec Name",function(t){return t||e.$translate.instant(e.resources.strings.call_health_no_data)},["VideoTurnedOn_Enable","VideoTurnedOff_Disable"])},e.prototype.getVideoSendWidthMetric=function(){return this.getSendWidthMetric("Video Send Actual Width",["VideoTurnedOn_Enable","VideoTurnedOff_Disable"],this.resources.strings.call_health_tab_video_disabled_text)},e.prototype.getScreenSharingSendWidthMetric=function(){return this.getSendWidthMetric("ScreenSharing Send Actual Width",["ScreenSharingTurnedOn_Enable","ScreenSharingTurnedOff_Disable"],this.resources.strings.call_health_tab_screensharing_disabled_text)},e.prototype.getSendWidthMetric=function(e,t,i){void 0===t&&(t=null),void 0===i&&(i=null);var a=this.$translate.instant(this.resources.strings.call_health_tab_metric_title_camera_send_width),r={helpText:this.$translate.instant(this.resources.strings.call_health_tab_metric_tooltip_camera_send_width)};return i&&(r.disabledText=this.$translate.instant(i)),new n.CallHealthMetric(a,r,"CallTechnicalInfo",e,this.utils.convertToPixels,t)},e.prototype.getVideoSendHeightMetric=function(){return this.getSendHeightMetric("Video Send Actual Height",["VideoTurnedOn_Enable","VideoTurnedOff_Disable"],this.resources.strings.call_health_tab_video_disabled_text)},e.prototype.getScreenSharingSendHeightMetric=function(){return this.getSendHeightMetric("ScreenSharing Send Actual Height",["ScreenSharingTurnedOn_Enable","ScreenSharingTurnedOff_Disable"],this.resources.strings.call_health_tab_screensharing_disabled_text)},e.prototype.getSendHeightMetric=function(e,t,i){void 0===t&&(t=null),void 0===i&&(i=null);var a=this.$translate.instant(this.resources.strings.call_health_tab_metric_title_camera_send_height),r={helpText:this.$translate.instant(this.resources.strings.call_health_tab_metric_tooltip_camera_send_height)};return i&&(r.disabledText=this.$translate.instant(i)),new n.CallHealthMetric(a,r,"CallTechnicalInfo",e,this.utils.convertToPixels,t)},e.prototype.getVideoReceivedWidthMetric=function(){return this.getReceivedWidthMetric("Video Received Actual Width")},e.prototype.getScreenSharingReceivedWidthMetric=function(){return this.getReceivedWidthMetric("ScreenSharing Received Actual Width",["PariticipantScreenSharingOn_Enable","PariticipantScreenSharingOff_Disable"],this.resources.strings.call_health_tab_participant_screensharing_disabled_text)},e.prototype.getReceivedWidthMetric=function(e,t,i){void 0===t&&(t=null),void 0===i&&(i=null);var a=this.$translate.instant(this.resources.strings.call_health_tab_metric_title_camera_received_width),r={helpText:this.$translate.instant(this.resources.strings.call_health_tab_metric_tooltip_camera_received_width)};return i&&(r.disabledText=this.$translate.instant(i)),new n.CallHealthMetric(a,r,"CallTechnicalInfo",e,this.utils.convertToPixels,t)},e.prototype.getVideoReceivedHeightMetric=function(){return this.getReceivedHeightMetric("Video Received Actual Height")},e.prototype.getScreenSharingReceivedHeightMetric=function(){return this.getReceivedHeightMetric("ScreenSharing Received Actual Height",["PariticipantScreenSharingOn_Enable","PariticipantScreenSharingOff_Disable"],this.resources.strings.call_health_tab_participant_screensharing_disabled_text)},e.prototype.getReceivedHeightMetric=function(e,t,i){void 0===t&&(t=null),void 0===i&&(i=null);var a=this.$translate.instant(this.resources.strings.call_health_tab_metric_title_camera_received_height),r={helpText:this.$translate.instant(this.resources.strings.call_health_tab_metric_tooltip_camera_received_height)};return i&&(r.disabledText=this.$translate.instant(i)),new n.CallHealthMetric(a,r,"CallTechnicalInfo",e,this.utils.convertToPixels,t)},e.prototype.getScreenSharingProcessingTypeMetric=function(){var e=this.$translate.instant(this.resources.strings.call_health_tab_metric_title_screensharing_processing_type),t={helpText:this.$translate.instant(this.resources.strings.call_health_tab_metric_tooltip_screensharing_processing_type),disabledText:this.$translate.instant(this.resources.strings.call_health_tab_screensharing_disabled_text)};return new r.CallHealthMetricCodec(e,t,"CallTechnicalInfo","ScreenSharing Send Processing Type",this.utils.convertToProcessingType,["ScreenSharingTurnedOn_Enable","ScreenSharingTurnedOff_Disable"],"None",null,teamspace.services.CallHealthState.NotAvailable,"metric-value-small-text")},e.prototype.getScreenSharingSendCodecMetric=function(){var e=this,t=this.$translate.instant(this.resources.strings.call_health_tab_metric_title_screensharing_send_codec),i={helpText:this.$translate.instant(this.resources.strings.call_health_tab_metric_tooltip_screensharing_send_codec),disabledText:this.$translate.instant(this.resources.strings.call_health_tab_screensharing_disabled_text)};return new n.CallHealthMetric(t,i,"CallTechnicalInfo","ScreenSharing Sent Codec Name",function(t){return t||e.$translate.instant(e.resources.strings.call_health_no_data)},["ScreenSharingTurnedOn_Enable","ScreenSharingTurnedOff_Disable"])},e.prototype.getScreenSharingReceivedCodecMetric=function(){var e=this,t=this.$translate.instant(this.resources.strings.call_health_tab_metric_title_screensharing_received_codec),i={helpText:this.$translate.instant(this.resources.strings.call_health_tab_metric_tooltip_screensharing_received_codec),disabledText:this.$translate.instant(this.resources.strings.call_health_tab_participant_screensharing_disabled_text)};return new n.CallHealthMetric(t,i,"CallTechnicalInfo","ScreenSharingReceivedCodec",function(t){return t||e.$translate.instant(e.resources.strings.call_health_no_data)},["PariticipantScreenSharingOn_Enable","PariticipantScreenSharingOff_Disable"])},e.prototype.getScreenSharingReceivedProcessingTypeMetric=function(){var e=this.$translate.instant(this.resources.strings.call_health_tab_metric_title_screensharing_received_processing_type),t={helpText:this.$translate.instant(this.resources.strings.call_health_tab_metric_tooltip_screensharing_processing_type),disabledText:this.$translate.instant(this.resources.strings.call_health_tab_participant_screensharing_disabled_text)};return new r.CallHealthMetricCodec(e,t,"CallTechnicalInfo","ScreenSharingReceivedProcessingType",this.utils.convertToProcessingType,["PariticipantScreenSharingOn_Enable","PariticipantScreenSharingOff_Disable"],"None",null,teamspace.services.CallHealthState.NotAvailable,"metric-value-small-text")},e.prototype.cleanupOnAppTeardown=function(e){this.technicalInfoApiCount=0,this.getTechnicalInfoScenario=void 0,this.callHealthTabSettings={technicalInfoRefreshRate:void 0,technicalInfoScenarioSampleNumber:void 0},this.technicalInfoApiLastCallSuccess=void 0,this.technicalInfoApiLastCallError=void 0,this.cancelablePromises.forEach(function(e){return teamspace.services.QCancelable.cancel(e)}),this.cancelablePromises.clear()},e.prototype.destroy=function(){var e;if(this.getTechnicalInfoScenario&&(this.getTechnicalInfoScenario.cancel(),this.getTechnicalInfoScenario=null),this.technicalInfoApiCount%this.callHealthTabSettings.technicalInfoScenarioSampleNumber!=1){var t=this.loggingService.newScenario(this.constants.callHealthTab.getTechnicalInfoScenario);this.technicalInfoApiLastCallSuccess?t.stop():t.fail((e={},e[this.constants.scenarioDataPropNames.broadcastError]=this.technicalInfoApiLastCallError,e))}this.cancelablePromises.forEach(function(e){return teamspace.services.QCancelable.cancel(e)}),this.cancelablePromises.clear()},e}();t.CallTechnicalInfoStatsMetrics=l},2759:function(e,t,i){"use strict";var a=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}();Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.getState=function(e){if("Custom"!==this.compareType)return teamspace.services.CallHealthState.NotAvailable;switch(e){case"Hardware":return teamspace.services.CallHealthState.Green;case"Software":return teamspace.services.CallHealthState.Amber;case"HardwareSoftwareFluctuation":return teamspace.services.CallHealthState.Red;default:return teamspace.services.CallHealthState.NotAvailable}},t}(i(97).CallHealthMetric);t.CallHealthMetricCodec=n},2760:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,n=i(97),r=i(2761),s=i(353);!function(e){e.MediaSharingPolicyState="IPVideoVBSSPolicyState",e.MediaBitRateKb="MediaBitRateKb"}(a||(a={}));var c=function(){function e(e,t,i){this.$translate=e,this.resources=t,this.meetingPolicySettingsStore=i,this.utils=new s.Utils(e,t)}return e.prototype.getDataAdapterMeetingSettingsStore=function(){var e=this;return{adapterType:"MeetingSettingsStore",getData:function(t){return new Promise(function(t){var i=new Map;i.set("MediaBitRateKb",e.meetingPolicySettingsStore.getSettingValue(SkypeX.Services.MeetingPolicySettingsStorageKey.mediaBitRateKb));var a,n=e.meetingPolicySettingsStore.getSettingValue(SkypeX.Services.MeetingPolicySettingsStorageKey.allowIPVideo),r=e.meetingPolicySettingsStore.getSettingValue(SkypeX.Services.MeetingPolicySettingsStorageKey.screenSharingMode)===SkypeX.Services.ScreenSharingMode.entireScreen;a=n&&r?"BothEnabled":n||r?n?"OnlyIPVideoEnabled":"OnlyScreenSharingEnabled":"BothDisabled",i.set("IPVideoVBSSPolicyState",a),t(i)})}.bind(this),refreshInterval:0}},e.prototype.getMediaSharingPolicyMetric=function(){var e=this,t=this.$translate.instant(this.resources.strings.call_health_tab_metric_title_media_sharing_policy),i={helpText:this.$translate.instant(this.resources.strings.call_health_tab_metric_tooltip_media_sharing_policy)};return new r.CallHealthMetricMediaSharingPolicy(t,i,"MeetingSettingsStore","IPVideoVBSSPolicyState",function(t){switch(t){case"OnlyIPVideoEnabled":return e.$translate.instant(e.resources.strings.call_health_tab_media_sharing_ip_video_only);case"OnlyScreenSharingEnabled":return e.$translate.instant(e.resources.strings.call_health_tab_media_sharing_screen_sharing_only);case"BothEnabled":return e.$translate.instant(e.resources.strings.call_health_tab_media_sharing_both_enabled);case"BothDisabled":return e.$translate.instant(e.resources.strings.call_health_tab_media_sharing_both_disabled);default:return e.$translate.instant(e.resources.strings.call_health_no_data)}},null,"None",null,teamspace.services.CallHealthState.NotAvailable,"metric-value-small-text")},e.prototype.getMediaBitRateLimitPolicyMetric=function(){var e=this.$translate.instant(this.resources.strings.call_health_tab_metric_title_media_bitrate_limit_policy),t={helpText:this.$translate.instant(this.resources.strings.call_health_tab_metric_tooltip_media_bitrate_limit_policy)};return new n.CallHealthMetric(e,t,"MeetingSettingsStore","MediaBitRateKb",this.utils.convertToMBps)},e}();t.MeetingPolicySettingsMetrics=c},2761:function(e,t,i){"use strict";var a=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}();Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.getState=function(e){if("Custom"!==this.compareType)return teamspace.services.CallHealthState.NotAvailable;switch(e){case"BothDisabled":return teamspace.services.CallHealthState.Red;case"OnlyIPVideoEnabled":case"OnlyScreenSharingEnabled":return teamspace.services.CallHealthState.Amber;case"BothEnabled":return teamspace.services.CallHealthState.Green;default:return teamspace.services.CallHealthState.NotAvailable}},t}(i(97).CallHealthMetric);t.CallHealthMetricMediaSharingPolicy=n},353:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){var i=this;this.$translate=e,this.resources=t,this.convertToProcessingType=function(e){switch(e){case"Hardware":return i.$translate.instant(i.resources.strings.call_health_tab_screensharing_codec_hardware);case"Software":return i.$translate.instant(i.resources.strings.call_health_tab_screensharing_codec_software);case"HardwareSoftwareFluctuation":return i.$translate.instant(i.resources.strings.call_health_tab_screensharing_codec_hardware_software_fluctuation);case"NotAvailable":default:return i.$translate.instant(i.resources.strings.call_health_no_data)}},this.convertToFps=this.convertToFps.bind(this),this.convertToKBps=this.convertToKBps.bind(this),this.convertToMBps=this.convertToMBps.bind(this),this.convertToPackets=this.convertToPackets.bind(this),this.convertToPixels=this.convertToPixels.bind(this),this.convertToMs=this.convertToMs.bind(this),this.convertToPs=this.convertToPs.bind(this),this.convertToPercentage=this.convertToPercentage.bind(this),this.convertToProcessingType=this.convertToProcessingType.bind(this)}return e.prototype.convertToFps=function(e){var t="number"==typeof e?e:"string"==typeof e?parseFloat(e):Number.NaN;return isNaN(t)||0===t?this.$translate.instant(this.resources.strings.call_health_no_data):this.$translate.instant(this.resources.strings.call_health_tab_value_suffix_fps,{value:t.toFixed(2)})},e.prototype.convertToKBps=function(e){var t="number"==typeof e?e:"string"==typeof e?parseInt(e):Number.NaN;if(isNaN(t)||0===t)return this.$translate.instant(this.resources.strings.call_health_no_data);var i=parseFloat((t/1e3).toFixed(2));return this.$translate.instant(this.resources.strings.call_health_tab_value_suffix_kbps,{value:i})},e.prototype.convertToMBps=function(e){var t="number"==typeof e?e:"string"==typeof e?parseInt(e):Number.NaN;if(isNaN(t)||0===t)return this.$translate.instant(this.resources.strings.call_health_no_data);var i=parseFloat((t/1e6).toFixed(2));return this.$translate.instant(this.resources.strings.call_health_tab_value_suffix_mbps,{value:i})},e.prototype.convertToPackets=function(e){var t="number"==typeof e?e:"string"==typeof e?parseInt(e):Number.NaN;return isNaN(t)||void 0===e||null===e||0===t?this.$translate.instant(this.resources.strings.call_health_no_data):this.$translate.instant(this.resources.strings.call_health_tab_value_suffix_packets,{value:e})},e.prototype.convertToPixels=function(t){return t&&t!==e.INVALID_NUMBER?this.$translate.instant(this.resources.strings.call_health_tab_value_suffix_pixels,{value:t}):this.$translate.instant(this.resources.strings.call_health_no_data)},e.prototype.convertToMs=function(e){var t="number"==typeof e?e:"string"==typeof e?parseFloat(e):Number.NaN;return isNaN(t)||0===t?this.$translate.instant(this.resources.strings.call_health_no_data):this.$translate.instant(this.resources.strings.call_health_tab_value_suffix_ms,{value:t.toFixed(2)})},e.prototype.convertToPs=function(e){var t="number"==typeof e?e:"string"==typeof e?parseFloat(e):Number.NaN;return isNaN(t)||0===t?this.$translate.instant(this.resources.strings.call_health_no_data):this.$translate.instant(this.resources.strings.call_health_tab_value_suffix_ps,{value:t.toFixed(0)})},e.prototype.convertToPercentage=function(e){var t="number"==typeof e?e:"string"==typeof e?parseFloat(e):Number.NaN;return isNaN(t)?this.$translate.instant(this.resources.strings.call_health_no_data):this.$translate.instant(this.resources.strings.call_health_tab_value_suffix_percentage,{value:(100*t).toFixed(2)})},e.INVALID_NUMBER="-2147483648",e}();t.Utils=a},97:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t,i,a,n,r,s,c,l,o){void 0===r&&(r=null),void 0===s&&(s="None"),void 0===c&&(c=null),void 0===l&&(l=teamspace.services.CallHealthState.NotAvailable),void 0===o&&(o=null),this.title=e,this.messages=t,this.dataAdapterType=i,this.sourceStatKey=a,this.valueConversion=n,this.events=r,this.compareType=s,this.thresholds=c,this.state=l,this.valueCSSClass=o,this.value="",this.enabled=!0,this.name=a.replace(/[^a-zA-Z0-9]+/g,"_")}return e.prototype.updateMetric=function(e){var t={name:this.name},i=e.get(this.sourceStatKey),a=this.valueConversion(i);if((a=a||"")!==this.value&&(this.value=t.value=a),"None"!==this.compareType){var n=this.getState(i);n!==this.state&&(this.state=t.state=n)}for(var r in t)if("name"!==r)return t},e.prototype.getState=function(e){var t="number"==typeof e?e:"string"==typeof e?parseFloat(e):Number.NaN;if(isNaN(t)||"Custom"===this.compareType)return teamspace.services.CallHealthState.NotAvailable;switch(this.compareType){case"LowerIsBetter":return t<this.thresholds.Amber?teamspace.services.CallHealthState.Green:t<this.thresholds.Red?teamspace.services.CallHealthState.Amber:teamspace.services.CallHealthState.Red;case"HigherIsBetter":return t>this.thresholds.Amber?teamspace.services.CallHealthState.Green:t>this.thresholds.Red?teamspace.services.CallHealthState.Amber:teamspace.services.CallHealthState.Red;default:return teamspace.services.CallHealthState.NotAvailable}},e.prototype.handleEvents=function(e){var t=this;if(this.events){var i={name:this.name};this.events.forEach(function(a){if(e.find(function(e){return e===a}))switch(a){case"VideoTurnedOn_Enable":case"ScreenSharingTurnedOn_Enable":case"AudioTurnedOn_Enable":case"PariticipantScreenSharingOn_Enable":t.enabled||(t.enabled=i.enabled=!0);break;case"VideoTurnedOff_Disable":case"ScreenSharingTurnedOff_Disable":case"AudioTurnedOff_Disable":case"PariticipantScreenSharingOff_Disable":t.enabled&&(t.enabled=i.enabled=!1)}});for(var a in i)if("name"!==a)return i}},e}();t.CallHealthMetric=a}},[2754]);