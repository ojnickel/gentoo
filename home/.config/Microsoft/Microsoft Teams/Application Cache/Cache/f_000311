webpackJsonp([32],{2751:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2752)},2752:function(e,t,i){"use strict";var o=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});var n=i(2753),r=function(e){function t(t){var i=e.call(this,t)||this;return i.orchestrationService=t,i.initializeOnAppLaunchAndReinit(),i}return o(t,e),t.$inject=["orchestrationService"],t.prototype.initializeOnAppLaunchAndReinit=function(e){},t.prototype.cleanupOnAppTeardown=function(e){},t.prototype.mtmaTelemetryIdentifier=function(){return"FocusManagementService"},t.prototype.createAbilityHelpers=function(e){return n.createAbilityHelpers(e)},t.prototype.getObservedElement=function(e){return n.getObservedElement(e)},t.prototype.getCrossOrigin=function(e){return n.getCrossOrigin(e)},t.prototype.disposeAbilityHelpers=function(e){n.disposeAbilityHelpers(e)},t}(teamspace.services.MTMABase);t.FocusManagementService=r,angular.module("teamspace.focusManagementService",["teamspace.orchestrationService"]).service("focusManagementService",r)},2753:function(e,t,i){"use strict";function o(e){if(e)ae={};else for(var t=0,i=Object.keys(ae);t<i.length;t++){var o=i[t],n=ae[o];Q?n.deref()||delete ae[o]:be.cleanup(n)&&delete ae[o]}}function n(e){de||(de=!0,Q=E()),ee||(ee=e().setTimeout(function(){ee=void 0,o(),n(e)},12e4))}function r(e){de=!1,ee&&(e().clearTimeout(ee),ee=void 0,ae={})}function s(e,t,i){if(t.nodeType===Node.ELEMENT_NODE){var o=$?i:{acceptNode:i};return e.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,o,!1)}}function u(e){var t=e.__ahCacheId,i=t?se[t]:void 0;if(i)return i.rect;var o=e.ownerDocument&&e.ownerDocument.documentElement;if(!o)return new ce;var n=0,r=0,s=o.clientWidth,u=o.clientHeight;if(e!==o){var a=e.getBoundingClientRect();n=Math.max(n,a.left),r=Math.max(r,a.top),s=Math.min(s,a.right),u=Math.min(u,a.bottom)}var l=new ce(n<s?n:-1,r<u?r:-1,n<s?s-n:0,r<u?u-r:0);return t||(t="r-"+ ++ue,e.__ahCacheId=t),se[t]={rect:l,element:e},Z||(Z=window.setTimeout(function(){Z=void 0;for(var e=0,t=Object.keys(se);e<t.length;e++){var i=t[e];delete se[i].element.__ahCacheId}se={}},50)),l}function a(e){var t=c(e);if(t){var i=u(t),o=e.getBoundingClientRect();return o.top>=i.top&&o.bottom<=i.bottom}return!1}function l(e,t){void 0===t&&(t=0);var i=c(e);if(i){var o=u(i),n=e.getBoundingClientRect();return n.left>o.right||n.top>o.bottom||n.bottom<o.top||n.right<o.left?te.Invisible:n.top+t>=o.top&&n.top<=o.bottom&&n.bottom>=o.top&&n.bottom-t<=o.bottom&&n.left+t>=o.left&&n.left<=o.right&&n.right>=o.left&&n.right-t<=o.right?te.Visible:te.PartiallyVisible}return te.Invisible}function d(e,t){var i=c(e);if(i){var o=u(i),n=e.getBoundingClientRect();i.scrollTop+=t?n.top-o.top:n.bottom-o.bottom}}function c(e){var t=e.ownerDocument;if(t){for(var i=e.parentElement;i;i=i.parentElement)if(i.scrollWidth>i.clientWidth||i.scrollHeight>i.clientHeight)return i;return t.documentElement}return null}function h(e){e.__shouldIgnoreFocus=!0}function p(e){return!!e.__shouldIgnoreFocus}function _(e){var t=e.focus;t.__ahFocus?t.__ahFocus.call(e):e.focus()}function f(e){var t=new Uint32Array(4);if(e.crypto&&e.crypto.getRandomValues)e.crypto.getRandomValues(t);else if(e.msCrypto&&e.msCrypto.getRandomValues)e.msCrypto.getRandomValues(t);else for(o=0;o<t.length;o++)t[o]=4294967295*Math.random();for(var i=[],o=0;o<t.length;o++)i.push(t[o].toString(36));return i.push("|"),i.push((++he).toString(36)),i.push("|"),i.push(Date.now().toString(36)),i.join("")}function v(e,t){var i=e.__ahElementUID;return i||(i=e.__ahElementUID=f(t)),!pe[i]&&b(e.ownerDocument,e)&&(pe[i]=new ye(e)),i}function m(e){var t=e.__ahCrossOriginWindowUID;return t||(t=e.__ahCrossOriginWindowUID=f(e)),t}function g(e){for(var t=0,i=Object.keys(pe);t<i.length;t++){var o=i[t],n=pe[o],r=n&&n.get();r&&e&&!e.contains(r)||delete pe[o]}}function b(e,t){var i;return!!(null===(i=null===e||void 0===e?void 0:e.body)||void 0===i?void 0:i.contains(t))}function y(e,t){var i=e.matches||e.matchesSelector||e.msMatchesSelector||e.webkitMatchesSelector;return i&&i.call(e,t)}function w(){if(re.Promise)return re.Promise;throw new Error("No Promise defined.")}function E(){return re.WeakRef}function T(e){var t;(t="Promise")in e&&(re[t]=e[t]),(t="WeakRef")in e&&(re[t]=e[t])}function F(e,t,i){var o,n=t.__ahElementUID,r=n?e.storageEntry(n):void 0,s=(null===r||void 0===r?void 0:r.ah)||{},u=null===r||void 0===r?void 0:r.attr;if(o=u?u.object:{},Object.keys(i).forEach(function(e){var t=i[e];if(void 0===t)s&&(delete s[e],delete o[e]);else switch(e){case"deloser":s[e]=i.deloser,o[e]=t.getBasicProps();break;case"root":s[e]=i.root,o[e]=t.getBasicProps();break;case"modalizer":s[e]=i.modalizer,o[e]=t.getBasicProps();break;case"focusable":s[e]=o[e]=i.focusable;break;case"groupper":s[e]=i.groupper,o[e]=t.getBasicProps();break;case"uberGroupper":s[e]=i.uberGroupper,o[e]=!0;break;case"observed":s[e]=o[e]=i.observed;break;case"outline":s[e]=o[e]=i.outline;break;default:throw new Error("Unknown helper.")}}),0===Object.keys(s).length)n&&r&&(delete r.ah,delete r.attr,e.storageEntry(n,!1)),t.removeAttribute(Y);else{var a=JSON.stringify(o);r||(n||(n=v(t,e.getWindow())),r=e.storageEntry(n,!0)),r.ah=s,r.attr={string:a,object:o,changing:!0},u&&u.string===a||t.setAttribute(Y,r.attr.string),r.attr.changing=!1}}function I(e,t){var i,o=t.__ahElementUID;return o?null===(i=e.storageEntry(o))||void 0===i?void 0:i.ah:void 0}function D(e,t){var i,o=t.getAttribute(Y),n=e,r=t.__ahElementUID,s=r?n.storageEntry(r):void 0,u=null===s||void 0===s?void 0:s.attr,a=null===s||void 0===s?void 0:s.ah;if(o){if(o!==(u&&u.string))try{var l=JSON.parse(o);if("object"!=typeof l)throw new Error("Value is not a JSON object, got '"+o+"'.");u={string:o,object:l,changing:!1}}catch(e){}}else a&&(u=void 0);for(var d=(null===(i=null===s||void 0===s?void 0:s.attr)||void 0===i?void 0:i.object)||{},c=u&&u.object||{},h=0,p=Object.keys(d);h<p.length;h++)if(!c[m=p[h]])switch(m){case"deloser":n.deloser&&n.deloser.remove(t);break;case"root":e.root.remove(t);break;case"modalizer":n.modalizer&&n.modalizer.remove(t);break;case"focusable":e.focusable.setProps(t,null);break;case"groupper":e.focusable.removeGroupper(t);break;case"uberGroupper":break;case"observed":n.observedElement&&n.observedElement.remove(t);break;case"outline":n.outline&&n.outline.setProps(t,null)}for(var _=0,f=Object.keys(c);_<f.length;_++){var m=f[_];switch(m){case"deloser":a&&a.deloser?a.deloser.setProps(c.deloser):(n.deloser&&n.deloser.add(t,c.deloser),n.deloser);break;case"root":a&&a.root?a.root.setProps(c.root):e.root.add(t);break;case"modalizer":a&&a.modalizer?a.modalizer.setProps(c.modalizer):(n.modalizer&&n.modalizer.add(t,c.modalizer),n.modalizer);break;case"focusable":e.focusable.setProps(t,c.focusable||null);break;case"groupper":a&&a.groupper?a.groupper.setProps(c.groupper):e.focusable.addGroupper(t,c.groupper);break;case"uberGroupper":break;case"observed":n.observedElement&&(a&&a.observed?n.observedElement.setProps(t,c.observed):n.observedElement.add(t,c.observed));break;case"outline":n.outline&&n.outline.setProps(t,c.outline||null);break;default:delete c[m],console.error("Unknown key '"+m+"' in data-ah attribute value.")}}u&&(u.object=c,u.string=JSON.stringify(c),u.changing=!0,s||(r||(r=v(t,e.getWindow())),s=e.storageEntry(r,!0)),s.attr=u,u.string!==o&&t.setAttribute(Y,u.string),u.changing=!1)}function O(e,t,i,o){var n=v(t,e.getWindow()),r=e.storageEntry(n,!0);if(!r.aug){if(void 0===o)return;r.aug={}}if(void 0===o){if(i in r.aug){var s=r.aug[i];delete r.aug[i],null===s?t.removeAttribute(i):t.setAttribute(i,s)}}else i in r.aug||(r.aug[i]=t.getAttribute(i)),null===o?t.removeAttribute(i):t.setAttribute(i,o);void 0===o&&0===Object.keys(r.aug).length&&(delete r.aug,e.storageEntry(n,!1))}function C(e,t,i){if("undefined"==typeof MutationObserver)return function(){};var o=new MutationObserver(function(o){function n(t,i,o){r(t,i,o);var n=s(e,t,function(e){return r(e,i,o)});if(n)for(;n.nextNode(););}function r(e,o,n){if(!e.getAttribute)return NodeFilter.FILTER_SKIP;var r=e.__ahElementUID;r&&(o?delete pe[r]:n&&(pe[r]=new ye(e)));var s=I(t,e);return s?(s.root&&u(s.root,o,n),s.modalizer&&a(s.modalizer,o,n),s.groupper&&l(e,s.groupper,o,n),s.observed&&d(e,o,n)):e.getAttribute(Y)&&i(t,e),NodeFilter.FILTER_SKIP}function u(e,t,i){var o=h[e.uid];o||(o=h[e.uid]={root:e}),t&&(o.removedFrom=t),i&&(o.addedTo=i)}function a(e,t,i){var o=p[e.internalId];o||(o=p[e.internalId]={modalizer:e}),t&&(o.removedFrom=t),i&&(o.addedTo=i)}function l(e,t,i,o){var n=_[t.id];n||(n=_[t.id]={groupper:t}),i&&(n.removedFrom=i),o&&(n.addedTo=o)}function d(t,i,o){if(e.defaultView){var n=v(t,e.defaultView),r=f[n];r||(r=f[n]={element:t}),i&&(r.removedFrom=i),o&&(r.addedTo=o)}}for(var c,h={},p={},_={},f={},m=0,g=o;m<g.length;m++){var b=g[m],y=b.target,w=b.removedNodes,E=b.addedNodes;if("attributes"===b.type){if(b.attributeName===Y){var T=y.__ahElementUID,F=T?null===(c=t.storageEntry(T))||void 0===c?void 0:c.attr:void 0;F&&F.changing||i(t,y)}}else{var D=I(t,y),O=D&&D.root;O&&(h[O.uid]={root:O,addedTo:y});for(C=0;C<w.length;C++)n(w[C],y.ownerDocument||e);for(var C=0;C<E.length;C++)n(E[C],void 0,y)}}for(var N=0,P=Object.keys(h);N<P.length;N++){var z=P[N],A=h[z];A.removedFrom&&k(A.removedFrom,{root:A.root,removed:!0,isMutation:!0}),A.addedTo&&k(A.addedTo,{root:A.root,removed:!1,isMutation:!0})}for(var M=0,U=Object.keys(p);M<U.length;M++){var z=U[M],L=p[z];L.removedFrom&&k(L.removedFrom,{modalizer:L.modalizer,removed:!0,isMutation:!0}),L.addedTo&&k(L.addedTo,{modalizer:L.modalizer,removed:!1,isMutation:!0})}for(var R=0,x=Object.keys(_);R<x.length;R++){var z=x[R],G=_[z];G.removedFrom&&!G.addedTo&&k(G.removedFrom,{groupper:G.groupper,removed:!0,isMutation:!0}),G.addedTo&&k(G.addedTo,{groupper:G.groupper,removed:!1,isMutation:!0})}for(var S=0,V=Object.keys(f);S<V.length;S++){var z=V[S],B=f[z];B.removedFrom&&!B.addedTo&&k(B.removedFrom,{observed:B.element,removed:!0,isMutation:!0}),B.addedTo&&k(B.addedTo,{observed:B.element,removed:!1,isMutation:!0})}});return o.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:[Y]}),function(){o.disconnect()}}function k(e,t){var i=document.createEvent("HTMLEvents");i.initEvent(Fe,!0,!0),i.details=t,e.dispatchEvent(i)}function N(e){var t=function(e){var t=e.details.root;t&&(e.details.removed?delete Ie[t.uid]:Ie[t.uid]=t)};return e.addEventListener(Fe,t),function(){e.removeEventListener(Fe,t)}}function P(e,t,i){var o=[],n=/(:|\.|\[|\]|,|=|@)/g;e.id&&o.push("#"+e.id.replace(n,"\\$1")),!1!==t&&e.className&&e.className.split(" ").forEach(function(e){(e=e.trim())&&o.push("."+e.replace(n,"\\$1"))});var r,s=0;if(!1!==i&&0===o.length){for(r=e;r;)s++,r=r.previousElementSibling;o.unshift(":nth-child("+s+")")}return o.unshift(e.tagName.toLowerCase()),o.join("")}function z(e){if(b(e.ownerDocument,e)){for(var t=[P(e)],i=e.parentElement;i;){var o="BODY"===i.tagName;if(t.unshift(P(i,!1,!o)),o)break;i=i.parentElement}return t.join(" ")}}function A(e,t){var i=e.getElement();if(i){var o=v(i,t);return xe[o]||(xe[o]=e),o}}function M(e){var t=e.HTMLElement,i=t.prototype.focus,o=!1;return t.prototype.focus=function(){o=!0},e.document.createElement("button").focus(),t.prototype.focus=i,o}function U(e,t){var i=e.createElement("style");return i.type="text/css",i.appendChild(e.createTextNode(L(t))),e.head.appendChild(i),i}function L(e){return"\n."+e.areaClass+" *, ."+e.areaClass+" *:focus {\noutline: none !important;\n}\n\n."+e.outlineClass+" {\ndisplay: none;\nposition: absolute;\nwidth: 0;\nheight: 0;\nleft: 0;\ntop: 0;\nz-index: "+e.zIndex+";\n}\n\n."+e.outlineClass+"."+e.outlineClass+"_visible {\ndisplay: block;\n}\n\n."+e.outlineClass+"__left,\n."+e.outlineClass+"__top,\n."+e.outlineClass+"__right,\n."+e.outlineClass+"__bottom {\nposition: absolute;\nbackground: inherit;\n}"}function R(e){yt.forceCleanup(e)}function x(e,t){var i=K(e);if(i)return i;var o=new yt(e,t);return e.__ahInstance=o,o}function G(e){var t=e;if(!t.outline){var i=new bt(e);t.outline=i,t.outlineDispose=function(){bt.dispose(i)}}return t.outline}function S(e,t){var i=e;if(!i.deloser){var o=new Me(e,t);i.deloser=o,i.deloserDispose=function(){Me.dispose(o)}}return i.deloser}function V(e){var t=e;if(!t.modalizer){var i=new ht(e);t.modalizer=i,t.modalizerDispose=function(){ht.dispose(i)}}return t.modalizer}function B(e){var t=e;if(!t.observedElement){var i=new ft(e);t.observedElement=i,t.observedElementDispose=function(){ft.dispose(i)}}return t.observedElement}function j(e){var t=e;if(!t.crossOrigin){S(e),G(e),B(e);var i=new Ze(e);t.crossOrigin=i,t.crossOriginDispose=function(){Ze.dispose(i)}}return t.crossOrigin}function H(e){yt.dispose(e)}function W(e,t){var i,o=null===e?void 0:JSON.stringify(e);return!0===t?o:(i={},i[Y]=o,i)}function K(e){return e.__ahInstance}Object.defineProperty(t,"__esModule",{value:!0}),i.d(t,"Types",function(){return ne}),i.d(t,"createAbilityHelpers",function(){return x}),i.d(t,"disposeAbilityHelpers",function(){return H}),i.d(t,"forceCleanup",function(){return R}),i.d(t,"getAbilityHelpersAttribute",function(){return W}),i.d(t,"getCrossOrigin",function(){return j}),i.d(t,"getCurrentAbilityHelpers",function(){return K}),i.d(t,"getDeloser",function(){return S}),i.d(t,"getModalizer",function(){return V}),i.d(t,"getObservedElement",function(){return B}),i.d(t,"getOutline",function(){return G}),i.d(t,"overrideBasics",function(){return T});var q,J=i(0),Y="data-ah",X={History:0,DeloserDefault:1,RootDefault:2,DeloserFirst:3,RootFirst:4};!function(e){e[e.Tab=0]="Tab",e[e.Arrows=1]="Arrows",e[e.Both=2]="Both"}(q||(q={}));var $,Q,Z,ee,te={Invisible:0,PartiallyVisible:1,Visible:2},ie={Unlimited:0,Limited:1,LimitedTrapFocus:2},oe={Both:0,Vertical:1,Horizontal:2,Grid:3},ne={__proto__:null,AbilityHelpersAttributeName:Y,RestoreFocusOrders:X,get MoverKeys(){return q},ElementVisibilities:te,GroupperFocusLimits:ie,GroupperNextDirections:oe},re={Promise:"undefined"!=typeof Promise?Promise:void 0,WeakRef:"undefined"!=typeof WeakRef?WeakRef:void 0},se={},ue=0,ae={},le=0,de=!1,ce="undefined"!=typeof DOMRect?DOMRect:function(){return function(e,t,i,o){this.left=e||0,this.top=t||0,this.right=(e||0)+(i||0),this.bottom=(t||0)+(o||0)}}(),he=0,pe={};try{document.createTreeWalker(document,NodeFilter.SHOW_ELEMENT),$=!1}catch(e){$=!0}var _e,fe,ve,me,ge,be=function(){function e(e){this._target=e}return e.prototype.deref=function(){return this._target},e.cleanup=function(e){return!e._target||!b(e._target.ownerDocument,e._target)&&(delete e._target,!0)},e}(),ye=function(){function e(e,t){this._id="we"+ ++le,ae[this._id]=Q?new Q(e):new be(e),void 0!==t&&(this._data=t)}return e.prototype.get=function(){var e=ae[this._id],t=e&&e.deref();return e&&!t&&delete ae[this._id],t},e.prototype.getData=function(){return this._data},e}(),we={Tab:9,Enter:13,Esc:27,Space:32,PageUp:33,PageDown:34,End:35,Home:36,Left:37,Up:38,Right:39,Down:40},Ee=function(){function e(){this._callbacks=[]}return e.prototype.dispose=function(){this._callbacks=[],delete this._val},e.prototype.subscribe=function(e){this._callbacks.indexOf(e)<0&&this._callbacks.push(e)},e.prototype.unsubscribe=function(e){var t=this._callbacks.indexOf(e);t>=0&&this._callbacks.splice(t,1)},e.prototype.setVal=function(e,t){this._val!==e&&(this._val=e,this._callCallbacks(e,t))},e.prototype.getVal=function(){return this._val},e.prototype.trigger=function(e,t){this._callCallbacks(e,t)},e.prototype._callCallbacks=function(e,t){this._callbacks.forEach(function(i){return i(e,t)})},e}(),Te=function(e){function t(t,i){var o=e.call(this)||this;return o._isMouseUsed=!1,o._init=function(){o._initTimer=void 0;var e=o._win();e.document.body.addEventListener("mousedown",o._onMouseDown,!0),e.addEventListener("keydown",o._onKeyDown,!0),o._ah.focusedElement.subscribe(o._onFocus)},o._onMouseDown=function(e){0===e.buttons||0===e.clientX&&0===e.clientY&&0===e.screenX&&0===e.screenY||(o._isMouseUsed=!0,o.setVal(!1,void 0))},o._onKeyDown=function(e){var t=o.isNavigatingWithKeyboard();t||e.keyCode!==we.Tab?t&&e.keyCode===we.Esc&&o._scheduleDismiss():o.setVal(!0,void 0)},o._onFocus=function(e,t){e&&(o._isMouseUsed?o._isMouseUsed=!1:o.isNavigatingWithKeyboard()||t.relatedTarget&&(t.isFocusedProgrammatically||void 0===t.isFocusedProgrammatically||o.setVal(!0,void 0)))},o._ah=t,o._win=i,o._initTimer=i().setTimeout(o._init,0),o}return J.c(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this);var t=this._win();this._initTimer&&(t.clearTimeout(this._initTimer),this._initTimer=void 0),this._dismissTimer&&(t.clearTimeout(this._dismissTimer),this._dismissTimer=void 0),t.document.body.removeEventListener("mousedown",this._onMouseDown,!0),t.removeEventListener("keydown",this._onKeyDown,!0),this._ah.focusedElement.unsubscribe(this._onFocus)},t.dispose=function(e){e.dispose()},t.prototype.isNavigatingWithKeyboard=function(){return this.getVal()||!1},t.prototype._scheduleDismiss=function(){var e=this,t=this._win();this._dismissTimer&&(t.clearTimeout(this._dismissTimer),this._dismissTimer=void 0);var i=this._ah.focusedElement.getFocusedElement();this._dismissTimer=t.setTimeout(function(){e._dismissTimer=void 0;var t=e._ah.focusedElement.getFocusedElement();i&&t&&i===t&&e.setVal(!1,void 0)},500)},t.setVal=function(e,t){e.setVal(t,void 0)},t}(Ee),Fe="ability-helpers:mutation-event",Ie={},De=function(){function e(e,t,i,o,n){this._knownModalizers={},this.uid=v(e,i()),this._element=new ye(e),this._ah=t,this._win=i,this._basic=n||{},this._forgetFocusedGrouppers=o,this._dummyInputFirst={isFirst:!0},this._dummyInputLast={isFirst:!1},this._createDummyInput(this._dummyInputFirst),this._createDummyInput(this._dummyInputLast),this._add(),this._addDummyInputs()}return e.prototype.dispose=function(){this._updateModalizersTimer&&(this._win().clearTimeout(this._updateModalizersTimer),this._updateModalizersTimer=void 0),this._remove();var e=this._dummyInputFirst;e&&(this._disposeDummyInput(e),delete this._dummyInputFirst);var t=this._dummyInputLast;t&&(this._disposeDummyInput(t),delete this._dummyInputLast),this._knownModalizers={},this._forgetFocusedGrouppers=function(){}},e.prototype.setProps=function(e){e?this._basic=J.a(J.a({},this._basic),e):null===e&&(this._basic={})},e.prototype.getBasicProps=function(){return this._basic},e.prototype.move=function(e){this._remove(),this._element=new ye(e),this._add(),this.updateModalizers()},e.prototype.getElement=function(){return this._element.get()},e.prototype.getCurrentModalizerId=function(){return this._curModalizerId},e.prototype.setCurrentModalizerId=function(e,t){this._curModalizerId=e,t||this.updateModalizers()},e.prototype.getModalizers=function(){for(var e=[],t=0,i=Object.keys(this._knownModalizers);t<i.length;t++){var o=i[t];e.push(this._knownModalizers[o])}return e},e.prototype.getModalizerById=function(e){return this._knownModalizers[e]},e.prototype.updateModalizers=function(){var e=this;this._updateModalizersTimer||(this.updateDummyInputs(),this._updateModalizersTimer=this._win().setTimeout(function(){e._updateModalizersTimer=void 0,e._reallyUpdateModalizers()},0))},e.prototype.updateDummyInputs=function(){this._addDummyInputs()},e.prototype.moveOutWithDefaultAction=function(e){var t,i;(null===(t=this._dummyInputFirst)||void 0===t?void 0:t.input)&&(null===(i=this._dummyInputLast)||void 0===i?void 0:i.input)&&(e?(this._dummyInputFirst.shouldMoveOut=!0,_(this._dummyInputFirst.input)):(this._dummyInputLast.shouldMoveOut=!0,_(this._dummyInputLast.input)))},e.prototype._add=function(){},e.prototype._remove=function(){this._removeDummyInputs()},e.prototype._reallyUpdateModalizers=function(){var e=this,t=this._element.get(),i=null===t||void 0===t?void 0:t.ownerDocument;if(t&&i){var o=[],n=s(i,t,function(t){var i=I(e._ah,t);return i&&i.modalizer?(o.push(i.modalizer),NodeFilter.FILTER_ACCEPT):NodeFilter.FILTER_SKIP});if(n)for(;n.nextNode(););for(var r=void 0===this._curModalizerId,u=!1,a={},l=0;l<o.length;l++){var d=(h=(c=o[l]).userId)===this._curModalizerId;!r&&d&&(r=!!c.getBasicProps().isOthersAccessible),d&&(u=!0),a[h]=c}u||this.setCurrentModalizerId(void 0,!0),this._knownModalizers=a;for(l=0;l<o.length;l++){var c=o[l],h=c.userId,p=void 0===this._curModalizerId||h===this._curModalizerId;c.setActive(p),c.setAccessible(c.getBasicProps().isAlwaysAccessible||r||p)}}},e.prototype._createDummyInput=function(e){var t=this;if(!e.input){var i=this._win().document.createElement("div");i.tabIndex=0,i.setAttribute("role","none"),i.setAttribute("aria-hidden","true");var o=i.style;o.position="fixed",o.width=o.height="1px",o.left=o.top="-100500px",o.opacity="0",o.zIndex="-1",h(i),e.input=i,e.focusin=function(i){var o;if(e.shouldMoveOut);else{Te.setVal(t._ah.keyboardNavigation,!0),t._forgetFocusedGrouppers();var n=t._element.get(),r=void 0;(r=n?e.isFirst?t._ah.focusable.findFirst(n):t._ah.focusable.findLast(n):null)?t._ah.focusedElement.focus(r):null===(o=e.input)||void 0===o||o.blur()}},e.focusout=function(t){e.shouldMoveOut=!1},i.addEventListener("focusin",e.focusin),i.addEventListener("focusout",e.focusout)}},e.prototype._disposeDummyInput=function(e){var t=e.input;if(t){delete e.input;var i=e.focusin;i&&(t.removeEventListener("focusin",i),delete e.focusin);var o=e.focusout;o&&(t.removeEventListener("focusout",o),delete e.focusout)}},e.prototype._addDummyInputs=function(){var e,t,i=this._element.get(),o=null===(e=this._dummyInputFirst)||void 0===e?void 0:e.input,n=null===(t=this._dummyInputLast)||void 0===t?void 0:t.input;if(i&&o&&n){i.lastElementChild!==n&&i.appendChild(n);var r=i.firstElementChild;r&&r!==o&&i.insertBefore(o,r)}},e.prototype._removeDummyInputs=function(){var e,t,i=null===(e=this._dummyInputFirst)||void 0===e?void 0:e.input,o=null===(t=this._dummyInputLast)||void 0===t?void 0:t.input;(null===i||void 0===i?void 0:i.parentElement)&&i.parentElement.removeChild(i),(null===o||void 0===o?void 0:o.parentElement)&&o.parentElement.removeChild(o)},e}(),Oe=function(){function e(t,i,o){var n=this;this._init=function(){n._initTimer=void 0;var e=n._win();e.document.addEventListener(Fe,n._onMutation),n._unobserve=N(e.document)},this._onMutation=function(t){var i=t.details,o=i.root;if(o&&(i.removed?i.isMutation&&o.dispose():o.getElement()===t.target&&o.updateDummyInputs()),t.target&&i.modalizer){var r=e._getRootOnly(n._ah,t.target);r&&r.updateModalizers()}},this._ah=t,this._win=t.getWindow,this._forgetFocusedGrouppers=i,this._initTimer=this._win().setTimeout(this._init,0),this._autoRoot=o}return e.prototype.dispose=function(){var e=this._win();this._autoRootInstance&&(this._autoRootInstance.dispose(),delete this._autoRootInstance,delete this._autoRoot),this._initTimer&&(e.clearTimeout(this._initTimer),this._initTimer=void 0),e.document.removeEventListener(Fe,this._onMutation),this._unobserve&&(this._unobserve(),delete this._unobserve),this._forgetFocusedGrouppers=function(){}},e.dispose=function(e){e.dispose()},e.prototype.add=function(e,t){var i=I(this._ah,e);if(!i||!i.root){var o=new De(e,this._ah,this._win,this._forgetFocusedGrouppers,t);F(this._ah,e,{root:o}),k(e,{root:o})}},e.prototype.remove=function(e){var t=I(this._ah,e),i=t&&t.root;i&&(k(e,{root:i,removed:!0}),F(this._ah,e,{root:void 0}),i.dispose())},e.prototype.move=function(e,t){var i=I(this._ah,e),o=i&&i.root;o&&(o.move(t),F(this._ah,t,{root:o}),F(this._ah,e,{root:void 0}),k(e,{root:o,removed:!0}),k(t,{root:o}))},e.prototype.setProps=function(e,t){var i=I(this._ah,e);i&&i.root&&i.root.setProps(t)},e._getRootOnly=function(e,t){for(var i=t;i;i=i.parentElement){var o=I(e,i);if(o&&o.root)return o.root}},e.getRootByUId=function(e){return Ie[e]},e.getAbilityHelpersContext=function(e,t){var i,o;if(t.ownerDocument){for(var n,r,s,u,a,l,d=t;d;d=d.parentElement){var c=I(e,d);if(c){!s&&c.groupper&&(s=c.groupper);var h=null===(i=c.focusable)||void 0===i?void 0:i.mover;if(void 0!==h&&void 0===a&&((a=h).navigationType!==q.Arrows&&a.navigationType!==q.Both||(u=d,l=!!s)),!r&&c.modalizer&&(r=c.modalizer),c.root){n=c.root;break}}}if(!n&&e.root._autoRoot){var p=e.root;if(!p._autoRootInstance){var _=null===(o=t.ownerDocument)||void 0===o?void 0:o.body;_&&(p._autoRootInstance=new De(_,p._ah,p._win,p._forgetFocusedGrouppers,p._autoRoot))}n=p._autoRootInstance}return n?{root:n,modalizer:r,groupper:s,mover:u,moverOptions:a,isGroupperFirst:l}:void 0}},e}(),Ce=function(){return function(){}}(),ke=function(e){function t(t,i){var o=e.call(this)||this;return o.uid=i.uid,o._ah=t,o._deloser=i,o}return J.c(t,e),t.prototype.belongsTo=function(e){return e===this._deloser},t.prototype.unshift=function(e){this._deloser.unshift(e)},t.prototype.focusAvailable=function(){return J.b(this,void 0,void 0,function(){var e;return J.d(this,function(t){return e=this._deloser.findAvailable(),[2,!!e&&this._ah.focusedElement.focus(e)]})})},t.prototype.resetFocus=function(){return J.b(this,void 0,void 0,function(){return J.d(this,function(e){return[2,w().resolve(this._deloser.resetFocus())]})})},t}(Ce),Ne=function(){function e(e,t){this._history=[],this._ah=e,this.rootUId=t}return e.prototype.getLength=function(){return this._history.length},e.prototype.removeDeloser=function(e){this._history=this._history.filter(function(t){return!t.belongsTo(e)})},e.prototype.hasDeloser=function(e){return this._history.some(function(t){return t.belongsTo(e)})},e}(),Pe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return J.c(t,e),t.prototype.unshiftToDeloser=function(e,t){for(var i,o=0;o<this._history.length;o++)if(this._history[o].belongsTo(e)){i=this._history[o],this._history.splice(o,1);break}i||(i=new ke(this._ah,e)),i.unshift(t),this._history.unshift(i),this._history.splice(10,this._history.length-10)},t.prototype.focusAvailable=function(e){return J.b(this,void 0,void 0,function(){var t,i,o,n,r,s,u,a,l,d,c,h,p,_,f;return J.d(this,function(v){switch(v.label){case 0:t=!!e,i=0,o=this._history,v.label=1;case 1:return i<o.length?(n=o[i],e&&n.belongsTo(e)&&(t=!1),(r=!t)?[4,n.focusAvailable()]:[3,3]):[3,5];case 2:r=v.sent(),v.label=3;case 3:if(r)return[2,!0];v.label=4;case 4:return i++,[3,1];case 5:if(s=Oe.getRootByUId(this.rootUId),!(u=s&&s.getModalizers()))return[3,10];a=0,l=u,v.label=6;case 6:return a<l.length?(d=l[a],c=d.getElement(),h=c&&I(this._ah,c),p=h&&h.deloser,_=p&&new ke(this._ah,p),(f=_)?[4,_.focusAvailable()]:[3,8]):[3,10];case 7:f=v.sent(),v.label=8;case 8:if(f)return[2,!0];v.label=9;case 9:return a++,[3,6];case 10:return[2,!1]}})})},t.prototype.resetFocus=function(e){return J.b(this,void 0,void 0,function(){var t,i,o,n,r,s,u,a,l,d,c,h,p,_,f,v;return J.d(this,function(m){switch(m.label){case 0:for(t=!!e,i={},o=0,n=this._history;o<n.length;o++)r=n[o],e&&r.belongsTo(e)&&(t=!1),t||i[r.uid]||(i[r.uid]=r);if(s=Oe.getRootByUId(this.rootUId),u=s&&s.getModalizers())for(a=0,l=u;a<l.length;a++)d=l[a],c=d.getElement(),h=c&&I(this._ah,c),!(p=h&&h.deloser)||p.uid in i||(i[p.uid]=new ke(this._ah,p));_=0,f=Object.keys(i),m.label=1;case 1:return _<f.length?(v=f[_],[4,i[v].resetFocus()]):[3,4];case 2:if(m.sent())return[2,!0];m.label=3;case 3:return _++,[3,1];case 4:return[2,!1]}})})},t}(Ne),ze=function(){function e(e){this._history=[],this._ah=e}return e.prototype.dispose=function(){this._history=[]},e.prototype.process=function(e){var t=this,i=Oe.getAbilityHelpersContext(this._ah,e),o=i&&i.root.uid,n=Me.getDeloser(this._ah,e);if(o&&n){var r=this.make(o,function(){return new Pe(t._ah,o)});return i&&i.modalizer&&i.root.getCurrentModalizerId()!==i.modalizer.userId||r.unshiftToDeloser(n,e),n}},e.prototype.make=function(e,t){for(var i,o=0;o<this._history.length;o++){var n=this._history[o];if(n.rootUId===e){i=n,this._history.splice(o,1);break}}return i||(i=t()),this._history.unshift(i),this._history.splice(10,this._history.length-10),i},e.prototype.removeDeloser=function(e){this._history.forEach(function(t){t.removeDeloser(e)}),this._history=this._history.filter(function(e){return e.getLength()>0})},e.prototype.focusAvailable=function(e){return J.b(this,void 0,void 0,function(){var t,i,o,n,r;return J.d(this,function(s){switch(s.label){case 0:t=!!e,i=0,o=this._history,s.label=1;case 1:return i<o.length?(n=o[i],e&&n.hasDeloser(e)&&(t=!1),(r=!t)?[4,n.focusAvailable(e)]:[3,3]):[3,5];case 2:r=s.sent(),s.label=3;case 3:if(r)return[2,!0];s.label=4;case 4:return i++,[3,1];case 5:return[2,!1]}})})},e.prototype.resetFocus=function(e){return J.b(this,void 0,void 0,function(){var t,i,o,n,r;return J.d(this,function(s){switch(s.label){case 0:t=!!e,i=0,o=this._history,s.label=1;case 1:return i<o.length?(n=o[i],e&&n.hasDeloser(e)&&(t=!1),(r=!t)?[4,n.resetFocus(e)]:[3,3]):[3,5];case 2:r=s.sent(),s.label=3;case 3:if(r)return[2,!0];s.label=4;case 4:return i++,[3,1];case 5:return[2,!1]}})})},e}(),Ae=function(){function e(e,t,i,o,n){var r=this;this._isActive=!1,this._history=[[]],this._snapshotIndex=0,this.isActive=function(){return r._isActive},this.setSnapshot=function(e){r._snapshotIndex=e,r._history.length>e+1&&r._history.splice(e+1,r._history.length-e-1),r._history[e]||(r._history[e]=[])},this.focusFirst=function(){var e=r._element.get();return!!e&&r._ah.focusedElement.focusFirst(e)},this.focusDefault=function(){var e=r._element.get();return!!e&&r._ah.focusedElement.focusDefault(e)},this.resetFocus=function(){var e=r._element.get();return!!e&&r._ah.focusedElement.resetFocus(e)},this.clearHistory=function(e){var t=r._element.get();r._history[r._snapshotIndex]=t?r._history[r._snapshotIndex].filter(function(i){var o=i.get();return!(!o||!e)&&t.contains(o)}):[]},this.uid=v(e,i()),this._ah=t,this._element=new ye(e),this._basic=o||{},this._extended=n||{}}return e.prototype.setProps=function(e,t){e?this._basic=J.a(J.a({},this._basic),e):null===e&&(this._basic={}),t?this._extended=J.a(J.a({},this._extended),t):null===t&&(this._extended={})},e.prototype.getBasicProps=function(){return this._basic},e.prototype.move=function(e){this._remove(),this._element=new ye(e)},e.prototype.dispose=function(){this._remove(),this._isActive=!1,this._snapshotIndex=0,this._basic={},this._extended={},this._history=[]},e.prototype.setActive=function(e){this._isActive=e},e.prototype.getActions=function(){return{focusDefault:this.focusDefault,focusFirst:this.focusFirst,resetFocus:this.resetFocus,clearHistory:this.clearHistory,setSnapshot:this.setSnapshot,isActive:this.isActive}},e.prototype.unshift=function(e){var t=this._history[this._snapshotIndex];for((t=this._history[this._snapshotIndex]=t.filter(function(t){var i=t.get();return i&&i!==e})).unshift(new ye(e,z(e)));t.length>10;)t.pop()},e.prototype.findAvailable=function(){var e=this._element.get();if(!e||!this._ah.focusable.isVisible(e))return null;var t=this._basic.restoreFocusOrder,i=null,o=Oe.getAbilityHelpersContext(this._ah,e);if(!o)return null;var n=o.root,r=n.getElement();if(!r)return null;if(void 0===t&&(t=n.getBasicProps().restoreFocusOrder),t===X.RootDefault&&(i=this._ah.focusable.findDefault(r)),i||t!==X.RootFirst||(i=this._findFirst(r)),i)return i;var s=this._findInHistory(),u=this._ah.focusable.findDefault(e),a=this._findFirst(e);return s&&t===X.History?s:u&&t===X.DeloserDefault?u:a&&t===X.DeloserFirst?a:u||s||a||null},e.prototype.customFocusLostHandler=function(e){return!!this._extended.onFocusLost&&this._extended.onFocusLost(e,this.getActions())},e.prototype.getElement=function(){return this._element.get()},e.prototype._findInHistory=function(){var e=this._history[this._snapshotIndex].slice(0);this.clearHistory(!0);for(var t=0;t<e.length;t++){var i=e[t],o=i.get(),n=this._element.get();if(o&&n&&n.contains(o)){if(this._ah.focusable.isFocusable(o))return o}else if(!this._basic.noSelectorCheck){var r=i.getData();if(r&&n){var s=void 0;try{s=n.ownerDocument.querySelectorAll(r)}catch(o){continue}for(var u=0;u<s.length;u++){var a=s[u];if(a&&this._ah.focusable.isFocusable(a))return a}}}}return null},e.prototype._findFirst=function(e){if(this._ah.keyboardNavigation.isNavigatingWithKeyboard()){var t=this._ah.focusable.findFirst(e);if(t)return t}return null},e.prototype._remove=function(){},e}(),Me=function(){function e(e,t){var i=this;this._isInSomeDeloser=!1,this._isRestoringFocus=!1,this._isPaused=!1,this._init=function(){i._initTimer=void 0,i._ah.focusedElement.subscribe(i._onFocus)},this._onFocus=function(e){if(i._restoreFocusTimer&&(i._win().clearTimeout(i._restoreFocusTimer),i._restoreFocusTimer=void 0),e){var t=i._history.process(e);t?(i._isInSomeDeloser=!0,t!==i._curDeloser&&(i._curDeloser&&i._curDeloser.setActive(!1),i._curDeloser=t),t.setActive(!0)):(i._isInSomeDeloser=!1,i._curDeloser=void 0)}else i._scheduleRestoreFocus()},this._ah=e,this._win=e.getWindow,this._history=new ze(e),this._initTimer=this._win().setTimeout(this._init,0);var o=null===t||void 0===t?void 0:t.autoDeloser;o&&(this._autoDeloser=o)}return e.prototype.dispose=function(){var e=this._win();this._initTimer&&(e.clearTimeout(this._initTimer),this._initTimer=void 0),this._restoreFocusTimer&&(e.clearTimeout(this._restoreFocusTimer),this._restoreFocusTimer=void 0),this._autoDeloserInstance&&(this._autoDeloserInstance.dispose(),delete this._autoDeloserInstance,delete this._autoDeloser),this._ah.focusedElement.unsubscribe(this._onFocus),this._history.dispose(),delete this._curDeloser},e.dispose=function(e){e.dispose()},e.prototype.getActions=function(e){for(var t=e;t;t=t.parentElement){var i=I(this._ah,t);if(i&&i.deloser)return i.deloser.getActions()}},e.prototype.add=function(e,t,i){var o=I(this._ah,e);o&&o.deloser||F(this._ah,e,{deloser:new Ae(e,this._ah,this._win,t,i)})},e.prototype.remove=function(e){var t=I(this._ah,e);if(t){var i=t.deloser;i&&(this._history.removeDeloser(i),i.isActive()&&this._scheduleRestoreFocus(),i.dispose(),F(this._ah,e,{deloser:void 0}))}},e.prototype.move=function(e,t){var i=I(this._ah,e);i&&i.deloser&&(i.deloser.move(t),F(this._ah,t,{deloser:i.deloser}),F(this._ah,e,{deloser:void 0}))},e.prototype.pause=function(){this._isPaused=!0,this._restoreFocusTimer&&(this._win().clearTimeout(this._restoreFocusTimer),this._restoreFocusTimer=void 0)},e.prototype.resume=function(e){this._isPaused=!1,e&&this._scheduleRestoreFocus()},e.prototype.setProps=function(e,t,i){var o=I(this._ah,e);o&&o.deloser&&o.deloser.setProps(t,i)},e.prototype._isLastFocusedAvailable=function(){var e=this._ah.focusedElement.getLastFocusedElement();return!(!e||!e.offsetParent)},e.prototype._scheduleRestoreFocus=function(e){var t=this;if(!this._isPaused&&!this._isRestoringFocus){var i=function(){return J.b(t,void 0,void 0,function(){var t,i;return J.d(this,function(o){switch(o.label){case 0:if(this._restoreFocusTimer=void 0,!e&&(this._isRestoringFocus||!this._isInSomeDeloser||this._isLastFocusedAvailable()))return[2];if(this._curDeloser){if((t=this._ah.focusedElement.getLastFocusedElement())&&this._curDeloser.customFocusLostHandler(t))return[2];if((i=this._curDeloser.findAvailable())&&this._ah.focusedElement.focus(i))return[2]}return this._isInSomeDeloser=!1,this._curDeloser&&(this._curDeloser.setActive(!1),this._curDeloser=void 0),this._isRestoringFocus=!0,[4,this._history.focusAvailable(null)];case 1:return o.sent()?[3,3]:[4,this._history.resetFocus(null)];case 2:o.sent(),o.label=3;case 3:return this._isRestoringFocus=!1,[2]}})})};e?i():this._restoreFocusTimer=this._win().setTimeout(i,100)}},e.getDeloser=function(e,t){for(var i,o=t;o;o=o.parentElement){var n=I(e,o);if(n&&n.deloser)return n.deloser}var r=e,s=r.deloser&&r.deloser;if(s){if(s._autoDeloserInstance)return s._autoDeloserInstance;var u=s._autoDeloser;if(!s._autoDeloserInstance&&u){var a=null===(i=t.ownerDocument)||void 0===i?void 0:i.body;a&&(s._autoDeloserInstance=new Ae(a,e,s._win,u,u))}return s._autoDeloserInstance}},e.getHistory=function(e){return e._history},e.forceRestoreFocus=function(e){e._scheduleRestoreFocus(!0)},e}(),Ue="up",Le={Bootstrap:1,FocusElement:2,State:3,GetElement:4,RestoreFocusInDeloser:5,Ping:6},Re=!1,xe={},Ge=function(e){function t(t,i,o){var n=e.call(this)||this;return n._deloser=i,n._transactions=o,n}return J.c(t,e),t.prototype.belongsTo=function(e){return e.deloserUId===this._deloser.deloserUId},t.prototype.focusAvailable=function(){return J.b(this,void 0,void 0,function(){var e;return J.d(this,function(t){return e=J.a(J.a({},this._deloser),{reset:!1}),[2,this._transactions.beginTransaction(qe,e).then(function(e){return!!e})]})})},t.prototype.resetFocus=function(){return J.b(this,void 0,void 0,function(){var e;return J.d(this,function(t){return e=J.a(J.a({},this._deloser),{reset:!0}),[2,this._transactions.beginTransaction(qe,e).then(function(e){return!!e})]})})},t}(Ce),Se=function(e){function t(t,i,o){var n=e.call(this,t,i)||this;return n._transactions=o,n}return J.c(t,e),t.prototype.unshift=function(e){for(var t,i=0;i<this._history.length;i++)if(this._history[i].belongsTo(e)){t=this._history[i],this._history.splice(i,1);break}t||(t=new Ge(this._ah,e,this._transactions)),this._history.unshift(t),this._history.splice(10,this._history.length-10)},t.prototype.focusAvailable=function(){return J.b(this,void 0,void 0,function(){var e,t,i;return J.d(this,function(o){switch(o.label){case 0:e=0,t=this._history,o.label=1;case 1:return e<t.length?(i=t[e],[4,i.focusAvailable()]):[3,4];case 2:if(o.sent())return[2,!0];o.label=3;case 3:return e++,[3,1];case 4:return[2,!1]}})})},t.prototype.resetFocus=function(){return J.b(this,void 0,void 0,function(){var e,t,i;return J.d(this,function(o){switch(o.label){case 0:e=0,t=this._history,o.label=1;case 1:return e<t.length?(i=t[e],[4,i.resetFocus()]):[3,4];case 2:if(o.sent())return[2,!0];o.label=3;case 3:return e++,[3,1];case 4:return[2,!1]}})})},t}(Ne),Ve=function(){function e(e,t,i,o,n,r,s,u){var a,l=this;this._inProgress={},this._isDone=!1,this._isSelfResponding=!1,this._sentCount=0,this.ah=e,this.owner=t,this.ownerId=m(t()),this.id=f(t()),this.beginData=o,this._knownTargets=i,this._sentTo=r||(a={},a[this.ownerId]=!0,a),this.targetId=s,this.sendUp=u,this.timeout=n,this._promise=new(w())(function(e,t){l._resolve=e,l._reject=t})}return e.prototype.getTargets=function(e){var t,i,o;return this.targetId===Ue?this.sendUp?(t={},t[Ue]={send:this.sendUp},t):null:this.targetId?e[this.targetId]?(i={},i[this.targetId]={send:e[this.targetId].send},i):null:0===Object.keys(e).length&&this.sendUp?(o={},o[Ue]={send:this.sendUp},o):Object.keys(e).length>0?e:null},e.prototype.begin=function(e){var t=this,i=this.getTargets(this._knownTargets),o=J.a({},this._sentTo);if(i)for(var n=0,r=Object.keys(i);n<r.length;n++)o[l=r[n]]=!0;var s={transaction:this.id,type:this.type,isResponse:!1,timestamp:Date.now(),owner:this.ownerId,sentto:o,timeout:this.timeout,beginData:this.beginData};if(this.targetId&&(s.target=this.targetId),e&&(this._isSelfResponding=!0,e(s).then(function(e){t._isSelfResponding=!1,void 0!==e&&(t.endData||(t.endData=e)),(t.endData||0===t._sentCount)&&t.end()})),i)for(var u=0,a=Object.keys(i);u<a.length;u++){var l=a[u];l in this._sentTo||this._send(i[l].send,l,s)}return 0!==this._sentCount||this._isSelfResponding||this.end(),this._promise},e.prototype._send=function(e,t,i){void 0===this._inProgress[t]&&(this._inProgress[t]=!0,this._sentCount++,e(i))},e.prototype.end=function(e){this._isDone||(this._isDone=!0,void 0===this.endData&&e?this._reject&&this._reject(e):this._resolve&&this._resolve(this.endData))},e.prototype.onResponse=function(e){var t=e.endData;void 0===t||this.endData||(this.endData=t);var i=e.target===Ue?Ue:e.owner;this._inProgress[i]&&(this._inProgress[i]=!1,this._sentCount--,(this.endData||0===this._sentCount&&!this._isSelfResponding)&&this.end())},e}(),Be=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=Le.Bootstrap,t}return J.c(t,e),t.shouldForward=function(){return!1},t.makeResponse=function(e){return J.b(this,void 0,void 0,function(){return J.d(this,function(t){return[2,{isNavigatingWithKeyboard:e.keyboardNavigation.isNavigatingWithKeyboard()}]})})},t}(Ve),je=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=Le.FocusElement,t}return J.c(t,e),t.shouldForward=function(e,t,i){var o=Ke.findElement(e,i,t.beginData);return!o||!e.focusable.isFocusable(o)},t.makeResponse=function(e,t,i,o,n,r){return J.b(this,void 0,void 0,function(){var o,n;return J.d(this,function(s){switch(s.label){case 0:return o=Ke.findElement(e,i,t.beginData),(n=!!o&&e.focusedElement.focus(o))?[3,2]:[4,r];case 1:n=!!s.sent(),s.label=2;case 2:return[2,n]}})})},t.shouldSelfRespond=function(){return!0},t}(Ve),He={Focused:1,Blurred:2,Observed:3,DeadWindow:4,KeyboardNavigation:5,Outline:6},We=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=Le.State,t}return J.c(t,e),t.shouldSelfRespond=function(e,t){return t.state!==He.DeadWindow&&t.state!==He.KeyboardNavigation},t.makeResponse=function(e,i,o,n,r,s,u){return J.b(this,void 0,void 0,function(){var o,n;return J.d(this,function(a){if(o=i.timestamp,n=i.beginData,o&&n)switch(n.state){case He.Focused:return[2,t._makeFocusedResponse(e,o,n,r,u)];case He.Blurred:return[2,t._makeBlurredResponse(e,o,n)];case He.Observed:return[2,t._makeObservedResponse(e,n)];case He.DeadWindow:return[2,t._makeDeadWindowResponse(e,n,r,s)];case He.KeyboardNavigation:return[2,t._makeKeyboardNavigationResponse(e,n.isNavigatingWithKeyboard)];case He.Outline:return[2,t._makeOutlineResponse(e,n.outline)]}return[2,!0]})})},t.createElement=function(e,t){return t.uid?new Xe(e,t.uid,t.ownerUId,t.id,t.rootUId,t.observedName,t.observedDetails):null},t._makeFocusedResponse=function(e,i,o,n,r){return J.b(this,void 0,void 0,function(){var s,u,a,l;return J.d(this,function(d){return s=t.createElement(e,o),o&&o.ownerUId&&s&&(_e=o.ownerUId,fe=i,!r&&o.rootUId&&o.deloserUId&&(u=Me.getHistory(e.deloser),a={ownerUId:o.ownerUId,deloserUId:o.deloserUId,rootUId:o.rootUId},(l=u.make(o.rootUId,function(){return new Se(e,a.rootUId,n)})).unshift(a)),$e.setVal(e.crossOrigin.focusedElement,s,{isFocusedProgrammatically:o.isFocusedProgrammatically})),[2,!0]})})},t._makeBlurredResponse=function(e,t,i){return J.b(this,void 0,void 0,function(){return J.d(this,function(o){return i&&(i.ownerUId===_e||i.force)&&(!fe||fe<t)&&$e.setVal(e.crossOrigin.focusedElement,void 0,{}),[2,!0]})})},t._makeObservedResponse=function(e,i){return J.b(this,void 0,void 0,function(){var o,n;return J.d(this,function(r){return o=i.observedName,n=t.createElement(e,i),o&&n&&Qe.trigger(e.crossOrigin.observedElement,n,{name:o,details:i.observedDetails}),[2,!0]})})},t._makeDeadWindowResponse=function(e,t,i,o){return J.b(this,void 0,void 0,function(){var n;return J.d(this,function(r){return(n=t&&t.ownerUId)&&i.removeTarget(n),[2,o.then(function(){return n===_e&&Me.forceRestoreFocus(e.deloser),!0})]})})},t._makeKeyboardNavigationResponse=function(e,t){return J.b(this,void 0,void 0,function(){return J.d(this,function(i){return void 0!==t&&e.keyboardNavigation.isNavigatingWithKeyboard()!==t&&(Re=!0,Te.setVal(e.keyboardNavigation,t),Re=!1),[2,!0]})})},t._makeOutlineResponse=function(e,t){return J.b(this,void 0,void 0,function(){return J.d(this,function(i){return ve&&ve.call(e.outline,t),[2,!0]})})},t}(Ve),Ke=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=Le.GetElement,t}return J.c(t,e),t.findElement=function(e,t,i){var o;if(i&&(!i.ownerId||i.ownerId===m(t())))if(i.id){if((o=t().document.getElementById(i.id))&&i.rootId){var n=Oe.getAbilityHelpersContext(e,o);if(!n||n.root.uid!==i.rootId)return null}}else if(i.uid){var r=pe[i.uid];o=r&&r.get()}else i.observedName&&(o=e.observedElement.getElement(i.observedName));return o||null},t.getElementData=function(e,t,i,o){var n=Me.getDeloser(e,t),r=Oe.getAbilityHelpersContext(e,t),s=I(e,t),u=s&&s.observed;return{uid:v(t,i()),ownerUId:o,id:t.id||void 0,rootUId:r?r.root.uid:void 0,deloserUId:n?A(n,i()):void 0,observedName:u&&u.name,observedDetails:u&&u.details}},t.makeResponse=function(e,i,o,n,r,s){return J.b(this,void 0,void 0,function(){var r,u,a,l,d,c;return J.d(this,function(h){switch(h.label){case 0:return void 0===(r=i.beginData)?u=e.focusedElement.getFocusedElement():r&&(u=t.findElement(e,o,r)||void 0),u||!r?[3,2]:(l=r.observedName,d=i.timeout,l&&d?[4,new(w())(function(t,i){var o=!1,n=!1,r=!1;e.observedElement.waitElement(l,d).then(function(e){o=!0,r||!e&&!n||(r=!0,t({element:e}))}),s.then(function(e){n=!0,r||!e&&!o||(r=!0,t({crossOrigin:e}))})})]:[3,2]);case 1:(c=h.sent()).element?u=c.element:c.crossOrigin&&(a=c.crossOrigin),h.label=2;case 2:return[2,u?t.getElementData(e,u,o,n):a]}})})},t.shouldSelfRespond=function(){return!0},t}(Ve),qe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=Le.RestoreFocusInDeloser,t}return J.c(t,e),t.makeResponse=function(e,t,i,o,n,r){return J.b(this,void 0,void 0,function(){var i,o,n,s,u;return J.d(this,function(a){switch(a.label){case 0:return[4,r];case 1:return i=a.sent(),o=!i&&t.beginData,n=o&&o.deloserUId,s=n&&xe[n],o&&s?(u=Me.getHistory(e.deloser),[2,o.reset?u.resetFocus(s):u.focusAvailable(s)]):[2,!!i]}})})},t}(Ve),Je=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=Le.Ping,t}return J.c(t,e),t.shouldForward=function(){return!1},t.makeResponse=function(){return J.b(this,void 0,void 0,function(){return J.d(this,function(e){return[2,!0]})})},t}(Ve),Ye=function(){function e(e,t){var i=this;this._knownTargets={},this._transactions={},this._isDefaultSendUp=!1,this.isSetUp=!1,this._onMessage=function(e){if(e.data.owner!==i._ownerUId&&i._ah){var t,o=e.data;if(o&&(t=o.transaction)&&o.type&&o.timestamp&&o.owner&&o.sentto){var n=i._knownTargets[o.owner];if(!n&&e.send&&o.owner!==i._ownerUId&&(n=i._knownTargets[o.owner]={send:e.send}),n&&(n.last=Date.now()),o.isResponse){var r=i._transactions[t];r&&r.transaction&&r.transaction.type===o.type&&r.transaction.onResponse(o)}else{var s=i._getTransactionClass(o.type),u=i.forwardTransaction(o);s&&e.send&&s.makeResponse(i._ah,o,i._owner,i._ownerUId,i,u,!1).then(function(t){var n={transaction:o.transaction,type:o.type,isResponse:!0,timestamp:Date.now(),owner:i._ownerUId,timeout:o.timeout,sentto:{},target:o.target===Ue?Ue:o.owner,endData:t};e.send(n)})}}}},this._onPageHide=function(){i._dead()},this._onBrowserMessage=function(e){if(e.source!==i._owner()){try{i._onMessage({data:JSON.parse(e.data),send:function(t){e.source&&e.source.postMessage&&e.source.postMessage(JSON.stringify(t),"*")}})}catch(e){}}},this._ah=e,this._owner=t,this._ownerUId=m(t())}return e.prototype.setup=function(e){return this.isSetUp||(this.isSetUp=!0,this.setSendUp(e),this._owner().addEventListener("pagehide",this._onPageHide),this._ping()),this._onMessage},e.prototype.setSendUp=function(e){if(!this.isSetUp)throw new Error("CrossOrigin is not set up.");this.sendUp=e||void 0;var t=this._owner();return void 0===e?this._isDefaultSendUp||t.document&&(this._isDefaultSendUp=!0,t.parent&&t.parent!==t&&t.parent.postMessage&&(this.sendUp=function(e){t.parent.postMessage(JSON.stringify(e),"*")}),t.addEventListener("message",this._onBrowserMessage)):this._isDefaultSendUp&&(t.removeEventListener("message",this._onBrowserMessage),this._isDefaultSendUp=!1),this._onMessage},e.prototype.dispose=function(){return J.b(this,void 0,void 0,function(){var e,t,i,o,n;return J.d(this,function(r){switch(r.label){case 0:return e=this._owner(),this._pingTimer&&(e.clearTimeout(this._pingTimer),this._pingTimer=void 0),e.removeEventListener("message",this._onBrowserMessage),e.removeEventListener("pagehide",this._onPageHide),[4,this._dead()];case 1:for(r.sent(),delete this._deadPromise,t=0,i=Object.keys(this._transactions);t<i.length;t++)o=i[t],(n=this._transactions[o]).timer&&(e.clearTimeout(n.timer),delete n.timer),n.transaction.end();return this._knownTargets={},delete this.sendUp,[2]}})})},e.prototype.beginTransaction=function(e,t,i,o,n,r){var s=this;if(!this._owner)return w().reject();var u,a=new e(this._ah,this._owner,this._knownTargets,t,i,o,n,this.sendUp);return e.shouldSelfRespond&&e.shouldSelfRespond(this._ah,t,this._owner,this._ownerUId)&&(u=function(t){return e.makeResponse(s._ah,t,s._owner,s._ownerUId,s,w().resolve(void 0),!0)}),this._beginTransaction(a,i,u,r)},e.prototype.removeTarget=function(e){delete this._knownTargets[e]},e.prototype._beginTransaction=function(e,t,i,o){var n=this,r=this._owner(),s={transaction:e,timer:r.setTimeout(function(){delete s.timer,e.end("Cross origin transaction timed out.")},1500+(t||0))};this._transactions[e.id]=s;var u=e.begin(i);return u.catch(function(){}).finally(function(){s.timer&&r.clearTimeout(s.timer),delete n._transactions[e.id]}),u.then(function(e){return e},o?void 0:function(){})},e.prototype.forwardTransaction=function(e){var t=e.target;if(t===this._ownerUId)return w().resolve();var i=this._getTransactionClass(e.type);if(i){if(void 0===i.shouldForward||i.shouldForward(this._ah,e,this._owner,this._ownerUId)){var o=e.sentto;return t===Ue&&(t=void 0,o[this._ownerUId]=!0),delete o[Ue],this._beginTransaction(new i(this._ah,this._owner,this._knownTargets,e.beginData,e.timeout,o,t,this.sendUp),e.timeout)}return w().resolve()}return w().reject("Unknown transaction type "+e.type)},e.prototype._getTransactionClass=function(e){switch(e){case Le.Bootstrap:return Be;case Le.FocusElement:return je;case Le.State:return We;case Le.GetElement:return Ke;case Le.RestoreFocusInDeloser:return qe;case Le.Ping:return Je;default:return null}},e.prototype._dead=function(){return J.b(this,void 0,void 0,function(){return J.d(this,function(e){switch(e.label){case 0:return this._deadPromise||_e!==this._ownerUId||(this._deadPromise=this.beginTransaction(We,{ownerUId:this._ownerUId,state:He.DeadWindow})),this._deadPromise?[4,this._deadPromise]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},e.prototype._ping=function(){return J.b(this,void 0,void 0,function(){var e,t,i,o,n=this;return J.d(this,function(r){switch(r.label){case 0:return this._pingTimer?[2]:(t=Date.now(),i=Object.keys(this._knownTargets).filter(function(e){return t-(n._knownTargets[e].last||0)>3e3}),this.sendUp&&i.push(Ue),i.length?[4,w().all(i.map(function(t){return n.beginTransaction(Je,void 0,void 0,void 0,t,!0).then(function(){return!0},function(){return t!==Ue&&(e||(e={}),e[t]=!0,delete n._knownTargets[t]),!1})}))]:[3,2]);case 1:r.sent(),r.label=2;case 2:return e?[4,this.beginTransaction(Ke,void 0)]:[3,5];case 3:return!(o=r.sent())&&_e&&_e in e?[4,this.beginTransaction(We,{ownerUId:this._ownerUId,state:He.Blurred,force:!0})]:[3,5];case 4:r.sent(),Me.forceRestoreFocus(this._ah.deloser),r.label=5;case 5:return this._pingTimer=this._owner().setTimeout(function(){n._pingTimer=void 0,n._ping()},3e3),[2]}})})},e}(),Xe=function(){function e(e,t,i,o,n,r,s){this._ah=e,this.uid=t,this.ownerId=i,this.id=o,this.rootId=n,this.observedName=r,this.observedDetails=s}return e.prototype.focus=function(e,t){return this._ah.crossOrigin.focusedElement.focus(this,e,t)},e}(),$e=function(e){function t(t){var i=e.call(this)||this;return i._transactions=t,i}return J.c(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this)},t.dispose=function(e){e.dispose()},t.prototype.focus=function(e,t,i){return J.b(this,void 0,void 0,function(){return J.d(this,function(o){return[2,this._focus({uid:e.uid,id:e.id,rootId:e.rootId,ownerId:e.ownerId,observedName:e.observedName},t,i)]})})},t.prototype.focusById=function(e,t,i,o){return J.b(this,void 0,void 0,function(){return J.d(this,function(n){return[2,this._focus({id:e,rootId:t},i,o)]})})},t.prototype.focusByObservedName=function(e,t,i,o,n){return J.b(this,void 0,void 0,function(){return J.d(this,function(r){return[2,this._focus({observedName:e,rootId:i},o,n,t)]})})},t.prototype._focus=function(e,t,i,o){return J.b(this,void 0,void 0,function(){return J.d(this,function(n){return[2,this._transactions.beginTransaction(je,J.a(J.a({},e),{noFocusedProgrammaticallyFlag:t,noAccessibleCheck:i}),o).then(function(e){return!!e})]})})},t.setVal=function(e,t,i){e.setVal(t,i)},t}(Ee),Qe=function(e){function t(t,i){var o=e.call(this)||this;return o._lastRequestFocusId=0,o._ah=t,o._transactions=i,o}return J.c(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this)},t.dispose=function(e){e.dispose()},t.prototype.getElement=function(e){return J.b(this,void 0,void 0,function(){return J.d(this,function(t){return[2,this.waitElement(e,0)]})})},t.prototype.waitElement=function(e,t){return J.b(this,void 0,void 0,function(){var i=this;return J.d(this,function(o){return[2,this._transactions.beginTransaction(Ke,{observedName:e},t).then(function(e){return e?We.createElement(i._ah,e):null})]})})},t.prototype.requestFocus=function(e,t){return J.b(this,void 0,void 0,function(){var i,o=this;return J.d(this,function(n){return i=++this._lastRequestFocusId,[2,this.waitElement(e,t).then(function(e){return!(o._lastRequestFocusId!==i||!e)&&o._ah.crossOrigin.focusedElement.focus(e)})]})})},t.trigger=function(e,t,i){e.trigger(t,i)},t}(Ee),Ze=function(){function e(e){var t=this;this._init=function(){t._initTimer=void 0;var e=t._ah;e.keyboardNavigation.subscribe(t._onKeyboardNavigationStateChanged),e.focusedElement.subscribe(t._onFocus),e.observedElement.subscribe(t._onObserved),ve||(ve=e.outline.setup,e.outline.setup=t._outlineSetup),t._transactions.beginTransaction(Be,void 0,void 0,void 0,Ue).then(function(e){e&&t._ah.keyboardNavigation.isNavigatingWithKeyboard()!==e.isNavigatingWithKeyboard&&(Re=!0,Te.setVal(t._ah.keyboardNavigation,e.isNavigatingWithKeyboard),Re=!1)})},this._onKeyboardNavigationStateChanged=function(e){Re||t._transactions.beginTransaction(We,{state:He.KeyboardNavigation,ownerUId:m(t._win()),isNavigatingWithKeyboard:e})},this._onFocus=function(e,i){var o=t._win(),n=m(o);t._blurTimer&&(o.clearTimeout(t._blurTimer),t._blurTimer=void 0),e?t._transactions.beginTransaction(We,J.a(J.a({},Ke.getElementData(t._ah,e,t._win,n)),{state:He.Focused})):t._blurTimer=o.setTimeout(function(){t._blurTimer=void 0,_e&&_e===n&&t._transactions.beginTransaction(Ke,void 0).then(function(e){e||_e!==n||t._transactions.beginTransaction(We,{ownerUId:n,state:He.Blurred,force:!1})})},0)},this._onObserved=function(e,i){var o=Ke.getElementData(t._ah,e,t._win,m(t._win()));o.state=He.Observed,o.observedName=i.name,o.observedDetails=i.details,t._transactions.beginTransaction(We,o)},this._outlineSetup=function(e){t._transactions.beginTransaction(We,{state:He.Outline,ownerUId:m(t._win()),outline:e})},this._ah=e,this._win=e.getWindow,this._transactions=new Ye(e,this._win),this.focusedElement=new $e(this._transactions),this.observedElement=new Qe(e,this._transactions)}return e.prototype.setup=function(e){return this.isSetUp()?this._transactions.setSendUp(e):(this._initTimer=this._win().setTimeout(this._init,0),this._transactions.setup(e))},e.prototype.isSetUp=function(){return this._transactions.isSetUp},e.prototype.dispose=function(){var e;this._initTimer&&(this._win().clearTimeout(this._initTimer),this._initTimer=void 0);var t=this._ah;t.keyboardNavigation.unsubscribe(this._onKeyboardNavigationStateChanged),t.focusedElement.unsubscribe(this._onFocus),null===(e=t.observedElement)||void 0===e||e.unsubscribe(this._onObserved),this._transactions.dispose(),$e.dispose(this.focusedElement),Qe.dispose(this.observedElement)},e.dispose=function(e){e.dispose()},e}(),et=["a[href]","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])","*[tabindex]","*[contenteditable]"].join(", "),tt=200,it=0,ot={},nt={},rt=function(){function e(t,i,o){this._visibleGrouppers={},this._hasFullyVisibleGroupper=!1,this._prevVisibleGrouppers={},this._grouppers={},this._ah=t,this._win=o,this._element=new ye(i),this.id="fgc"+ ++it,F(t,i,{uberGroupper:this}),e._containers[this.id]=this}return e.prototype.dispose=function(){this._grouppers={};var t=this._win();this._updateVisibleTimer&&(t.clearTimeout(this._updateVisibleTimer),this._updateVisibleTimer=void 0),this._onChangeTimer&&(t.clearTimeout(this._onChangeTimer),this._onChangeTimer=void 0);var i=this._element.get();i&&F(this._ah,i,{uberGroupper:void 0}),delete e._containers[this.id]},e.prototype.getElement=function(){return this._element.get()},e.prototype.addGroupper=function(e){this._grouppers[e.id]=e,this._setFirstLast(),this._updateVisible(!0)},e.prototype.removeGroupper=function(e){var t=e.id;delete this._grouppers[t],delete this._visibleGrouppers[t],delete this._prevVisibleGrouppers[t],delete ot[t],this._current===e&&this._setCurrent(void 0),this._setFirstLast(),this._updateVisible(!0)},e.prototype.setFocusedGroupper=function(e){e!==this._focused&&(this._focused=e,this._processOnChange())},e.prototype.setUnlimitedGroupper=function(e){e!==this._unlimited&&(this._unlimited=e,this._processOnChange())},e.prototype.forceUpdate=function(){this._processOnChange(!0)},e.prototype._processOnChange=function(e){var t=this;if(!this._onChangeTimer||e){var i=function(){t._onChangeTimer=void 0;var e=[];if(t._prevFocused!==t._focused){for(var i=0,o=Object.keys(t._grouppers);i<o.length;i++){s=o[i];e.push(t._grouppers[s])}t._focused||t._prevFocused&&t._prevFocused.getBasicProps().memorizeCurrent||(t._setCurrent(void 0),t._prev=void 0,t._next=void 0),t._prevFocused=t._focused}if(t._prevCurrent!==t._current&&(e.push(t._prevCurrent),e.push(t._current),t._prevCurrent=t._current),t._prevPrev!==t._prev&&(e.push(t._prevPrev),e.push(t._prev),t._prevPrev=t._prev),t._prevNext!==t._next&&(e.push(t._prevNext),e.push(t._next),t._prevNext=t._next),t._prevFirst!==t._first&&(e.push(t._prevFirst),e.push(t._first),t._prevFirst=t._first),t._prevLast!==t._last&&(e.push(t._prevLast),e.push(t._last),t._prevLast=t._last),t._prevUnlimited!==t._unlimited&&(e.push(t._prevUnlimited),e.push(t._unlimited),t._prevUnlimited=t._unlimited),t._visibleGrouppers!==t._prevVisibleGrouppers){t._hasFullyVisibleGroupper=!1;for(var n=0,r=Object.keys(t._visibleGrouppers);n<r.length;n++){var s=r[n],u=t._visibleGrouppers[s];u!==t._prevVisibleGrouppers[s]&&e.push(t._grouppers[s]),u===te.Visible&&(t._hasFullyVisibleGroupper=!0)}for(var a=0,l=Object.keys(t._prevVisibleGrouppers);a<l.length;a++){s=l[a];t._visibleGrouppers[s]!==t._prevVisibleGrouppers[s]&&e.push(t._grouppers[s])}t._prevVisibleGrouppers=t._visibleGrouppers}for(var d={},c=0,h=e.filter(function(e){return e&&t._grouppers[e.id]});c<h.length;c++){var p=h[c];if(p&&!d[p.id]){d[p.id]=!0;var _=p.getExtendedProps().onChange;_&&_(p.getState())}}};this._onChangeTimer&&this._win().clearTimeout(this._onChangeTimer),e?i():this._onChangeTimer=this._win().setTimeout(i,0)}},e.prototype._setFirstLast=function(){this._first=void 0,this._last=void 0;var e=this._element.get();if(e){for(t=e.firstElementChild;t;t=t.nextElementSibling)if((i=I(this._ah,t))&&i.groupper&&i.groupper.id in this._grouppers){this._first=i.groupper;break}for(var t=e.lastElementChild;t;t=t.previousElementSibling){var i=I(this._ah,t);if(i&&i.groupper&&i.groupper.id in this._grouppers){this._last=i.groupper;break}}this._processOnChange()}},e.prototype.setCurrentGroupper=function(e){var t;this._setCurrent(e&&e.id in this._grouppers?e:void 0),this._prev=void 0,this._next=void 0;var i=null===(t=this._current)||void 0===t?void 0:t.getElement();if(i&&i.parentElement===this._element.get()){for(o=i.previousElementSibling;o;o=o.previousElementSibling)if((n=I(this._ah,o))&&n.groupper){this._prev=n.groupper;break}for(var o=i.nextElementSibling;o;o=o.nextElementSibling){var n=I(this._ah,o);if(n&&n.groupper){this._next=n.groupper;break}}}this._processOnChange()},e.prototype.getCurrentGroupper=function(){return this._current&&this._current.id in this._grouppers?this._current:(this._setCurrent(void 0),this._current||null)},e.prototype.getGroupperState=function(e){var t=e.getBasicProps(),i=t.isLimited,o=this._visibleGrouppers[e.id]||te.Invisible,n=this._current?this._current===e:void 0;return void 0===n&&t.lookupVisibility!==te.Invisible&&(o===te.Invisible||this._hasFullyVisibleGroupper&&o===te.PartiallyVisible)&&(n=!1),{isCurrent:n,isPrevious:this._prev===e,isNext:this._next===e,isFirst:this._first===e,isLast:this._last===e,isVisible:o,hasFocus:this._focused===e,siblingHasFocus:!!this._focused&&this._focused!==e,siblingIsVisible:this._hasFullyVisibleGroupper,isLimited:(i===ie.Limited||i===ie.LimitedTrapFocus)&&this._unlimited!==e}},e.prototype.isEmpty=function(){return 0===Object.keys(this._grouppers).length},e.prototype._setCurrent=function(e){var t=this._current;t!==e&&(t&&nt[t.id]&&delete nt[t.id],e&&(nt[e.id]=e),this._current=e)},e.prototype._updateVisible=function(e){var t=this,i=this._element.get();if(!this._updateVisibleTimer&&i){if(e)for(var o=i.parentElement;o;o=o.parentElement){var n=I(this._ah,o);n&&n.uberGroupper&&n.uberGroupper._updateVisible(!1)}this._updateVisibleTimer=this._win().setTimeout(function(){t._updateVisibleTimer=void 0;for(var e=!1,i={},o=0,n=Object.keys(t._grouppers);o<n.length;o++){var r=n[o],s=t._grouppers[r].getElement(),u=s?l(s,10):te.Invisible,a=t._visibleGrouppers[r]||te.Invisible;u!==te.Invisible&&(i[r]=u),a!==u&&(e=!0)}e&&(t._prevVisibleGrouppers=t._visibleGrouppers,t._visibleGrouppers=i,t._processOnChange())},0)}},e.updateVisible=function(t){for(var i={},o=0,n=t;o<n.length;o++)for(var r=n[o],s=0,u=Object.keys(e._containers);s<u.length;s++){var a=u[s],l=e._containers[a],d=l.getElement();d&&r.contains(d)&&(i[l.id]=l)}for(var c=0,h=Object.keys(i);c<h.length;c++)i[a=h[c]]._updateVisible(!1)},e._containers={},e}(),st=function(){function e(e,t,i,o,n){this._ah=e,this._win=i,this._element=new ye(t),this._basic=o||{},this._extended=n||{},this.id="fg"+ ++it,F(this._ah,t,{groupper:this}),this.setupContainer()}return e.prototype.dispose=function(){this._container&&this._container.removeGroupper(this),this.setupContainer(!0);var e=this._element.get();e&&F(this._ah,e,{groupper:void 0})},e.prototype.getBasicProps=function(){return this._basic},e.prototype.getExtendedProps=function(){return this._extended},e.prototype.setProps=function(e,t){e?this._basic=J.a(J.a({},this._basic),e):null===e&&(this._basic={}),t?this._extended=J.a(J.a({},this._extended),t):null===t&&(this._extended={})},e.prototype.getElement=function(){return this._element.get()},e.prototype.moveTo=function(e){this._element.get()!==e&&(this.setupContainer(!0),this._element=new ye(e),this.setupContainer())},e.prototype.getState=function(){return this._container?this._container.getGroupperState(this):{isCurrent:void 0,isPrevious:!1,isNext:!1,isFirst:!1,isLast:!1,isVisible:te.Invisible,hasFocus:!1,siblingIsVisible:!1,siblingHasFocus:!1,isLimited:!1}},e.prototype.setCurrent=function(e){this._container&&this._container.setCurrentGroupper(e?this:void 0)},e.prototype.isDefault=function(){var e=this._basic.isDefault||this._extended.isDefault;return"function"==typeof e?e.call(this._element):e},e.prototype.setFocused=function(e){this._container&&this._container.setFocusedGroupper(e?this:void 0)},e.prototype.setUnlimited=function(e){!this._container||this._basic.isLimited!==ie.Limited&&this._basic.isLimited!==ie.LimitedTrapFocus||this._container.setUnlimitedGroupper(e?this:void 0)},e.prototype.forceUpdate=function(){this._container&&this._container.forceUpdate()},e.prototype.setupContainer=function(e){var t,i=this._element.get(),o=null===i||void 0===i?void 0:i.parentElement,n=this._container;if(o){var r=I(this._ah,o);(t=r&&r.uberGroupper)||e||(t=new rt(this._ah,o,this._win))}n&&(e||n!==t)&&n.removeGroupper(this),this._container=t,t&&!e&&t.addGroupper(this)},e}(),ut=function(){function e(e,t){var i=this;this._scrollTargets=[],this._init=function(){i._initTimer=void 0;var e=i._win();e.document.addEventListener(Fe,i._onMutation,!0),e.addEventListener("scroll",i._onScroll,!0),i._ah.focusedElement.subscribe(i._onFocus)},this._onFocus=function(e){e&&i._updateFocusedGrouppers(e)},this._onMutation=function(e){e.target&&e.details.groupper&&e.details.groupper.setupContainer(e.details.removed)},this._onScroll=function(e){for(var t=!1,o=0,n=i._scrollTargets;o<n.length;o++)if(n[o]===e.target){t=!0;break}!t&&e.target.contains&&i._scrollTargets.push(e.target);var r=i._win();i._scrollTimer&&r.clearTimeout(i._scrollTimer),i._scrollTimer=r.setTimeout(function(){i._scrollTimer=void 0,rt.updateVisible(i._scrollTargets),i._scrollTargets=[]},tt)},this._ah=e,this._win=t,this._initTimer=t().setTimeout(this._init,0)}return e.prototype.dispose=function(){var e=this._win();this._initTimer&&(e.clearTimeout(this._initTimer),this._initTimer=void 0),this._scrollTimer&&(e.clearTimeout(this._scrollTimer),this._scrollTimer=void 0),e.document.removeEventListener(Fe,this._onMutation,!0),e.removeEventListener("scroll",this._onScroll,!0),this._ah.focusedElement.unsubscribe(this._onFocus),this._scrollTargets=[]},e.dispose=function(e){e.dispose()},e.prototype._getBody=function(){var e=this._ah.focusedElement.getLastFocusedElement();return e&&e.ownerDocument?e.ownerDocument.body:this._win().document.body},e.forgetFocusedGrouppers=function(e){e._updateFocusedGrouppers(null,!0)},e.prototype._updateFocusedGrouppers=function(e,t){for(var i={},o=e;o;o=o.parentElement){var n=I(this._ah,o);n&&n.groupper&&(i[n.groupper.id]=n.groupper)}for(var r=0,s=Object.keys(ot);r<s.length;r++)i[l=s[r]]||((d=ot[l]).setFocused(!1),d.setUnlimited(!1),t&&d.forceUpdate());for(var u=0,a=Object.keys(i);u<a.length;u++){var l=a[u];if(!ot[l]){var d=i[l],c=d.getElement();c&&(d.setFocused(!0),e!==this._getGroupFirst(c,!1)&&d.setUnlimited(!0))}}ot=i},e.prototype._getGroupFirst=function(e,t){return this._ah.focusable.isFocusable(e)?e:this._ah.focusable.findFirst(e,!1,!1,t)},e.prototype.addGroupper=function(e,t,i){var o=I(this._ah,e);if(o&&o.groupper)throw new Error("The element already has a focus group");k(e,{groupper:new st(this._ah,e,this._win,t,i)})},e.prototype.removeGroupper=function(e){var t=I(this._ah,e),i=t&&t.groupper;i&&(i.dispose(),k(e,{groupper:i,removed:!0}))},e.prototype.moveGroupper=function(e,t){if(e!==t){var i=I(this._ah,e),o=i&&i.groupper;o&&(o.moveTo(t),k(e,{groupper:o,removed:!0}),k(t,{groupper:o}))}},e.prototype.setGroupperProps=function(e,t,i){var o=this._findGroupper(e);o&&o.setProps(t,i)},e.prototype.setCurrentGroupper=function(e,t){var i,o=e?this._findGroupper(e):null;if(null===e)for(var n=0,r=Object.keys(nt);n<r.length;n++){var s=r[n],u=nt[s];u.setCurrent(!1),t&&u.forceUpdate()}else for(;o;){o.setCurrent(!0),t&&o.forceUpdate();var a=null===(i=o.getElement())||void 0===i?void 0:i.parentElement;o=a?this._findGroupper(a):null}},e.prototype.isInCurrentGroupper=function(e){return this._isInCurrentGroupper(e,!1)},e.prototype._isInCurrentGroupper=function(e,t){var i=this._findGroupper(e),o=null===i||void 0===i?void 0:i.getElement();if(i&&o){var n=!1;for(t&&(n=e.contains(this._getGroupFirst(o,!0)));i;){var r=i.getState();if(!1===r.isCurrent)return!1;if(t&&r.isLimited&&!n)return!1;var s=null===o||void 0===o?void 0:o.parentElement;(i=s?this._findGroupper(s):null)&&(o=i.getElement())}return!0}},e.prototype._findGroupper=function(e){for(var t=e;t;t=t.parentElement){var i=I(this._ah,t);if(i&&i.groupper)return i.groupper}return null},e.prototype.findGroupper=function(e){var t=this._findGroupper(e);return t?t.getElement()||null:null},e.prototype._findNextGroupper=function(e,t,i){var o=this.findGroupper(e),n=o&&o.parentElement;if(o&&n){var r=I(this._ah,n),s=r&&r.uberGroupper;if(s)for(var u=t(s,o);u;u=t(s,o,u)){var a=I(this._ah,u);if(a&&a.groupper&&(i||this.isAccessible(u))){if(!this._ah.focusable.isFocusable(u)&&!this._ah.focusable.findFirst(u,!1,!1,!0))continue;return u}}}return null},e.prototype.findFirstGroupper=function(e,t){return this._findNextGroupper(e,function(e,t,i){var o;return void 0===i?(null===(o=e.getElement())||void 0===o?void 0:o.firstElementChild)||null:i?i.nextElementSibling:null},t)},e.prototype.findLastGroupper=function(e,t){return this._findNextGroupper(e,function(e,t,i){var o;return void 0===i?(null===(o=e.getElement())||void 0===o?void 0:o.lastElementChild)||null:i?i.previousElementSibling:null},t)},e.prototype.findNextGroupper=function(e,t){return this._findNextGroupper(e,function(e,t,i){return void 0===i?t.nextElementSibling:i?i.nextElementSibling:null},t)},e.prototype.findPrevGroupper=function(e,t){return this._findNextGroupper(e,function(e,t,i){return void 0===i?t.previousElementSibling:i?i.previousElementSibling:null},t)},e.prototype.getProps=function(e){var t=I(this._ah,e);return t&&t.focusable||{}},e.prototype.setProps=function(e,t){var i=I(this._ah,e),o=i&&i.focusable||{},n={};t&&(n.isDefault=t.isDefault,n.isIgnored=t.isIgnored,n.mover=t.mover),o.isDefault===n.isDefault&&o.isIgnored===n.isIgnored&&o.mover===n.mover||F(this._ah,e,{focusable:n})},e.prototype.isFocusable=function(e,t,i,o){return!(!y(e,et)||!t&&-1===e.tabIndex)&&((i||this.isVisible(e))&&(o||this.isAccessible(e)))},e.prototype.isVisible=function(e){if(!e.ownerDocument)return!1;if(null===e.offsetParent&&e.ownerDocument.body!==e)return!1;var t=e.ownerDocument.defaultView;if(!t)return!1;var i=e.ownerDocument.body.getBoundingClientRect();return(0!==i.width||0!==i.height)&&"hidden"!==t.getComputedStyle(e).visibility},e.prototype.isAccessible=function(e){for(var t=e;t;t=t.parentElement){var i=I(this._ah,t);if(i&&i.modalizer&&!i.modalizer.isActive())return!0;var o=t.getAttribute("aria-hidden");if(o&&"true"===o.toLowerCase())return!1;if((o=t.getAttribute("aria-disabled"))&&"true"===o.toLowerCase())return!1}return!0},e.prototype.findFirst=function(e,t,i,o){return this._findElement(e||this._getBody(),null,t,i,o,!1)},e.prototype.findLast=function(e,t,i,o){return this._findElement(e||this._getBody(),null,t,i,o,!0)},e.prototype.findNext=function(e,t,i,o,n){return this._findElement(t||this._getBody(),e,i,o,n,!1)},e.prototype.findPrev=function(e,t,i,o,n){return this._findElement(t||this._getBody(),e,i,o,n,!0)},e.prototype.findDefault=function(e,t,i,o){var n=this;return this._findElement(e||this._getBody(),null,t,i,o,!1,function(e){return n._ah.focusable.isFocusable(e,t)&&!!n.getProps(e).isDefault})},e.prototype.findAll=function(e,t,i,o,n,r){var u=this,a=function(e){var o=u._ah.focusable.isFocusable(e,i),n=t(e);return r?!!n:o&&!!n},l=s(e.ownerDocument,e,function(e){return u._acceptElement(e,a,o,n)}),d=null===l||void 0===l?void 0:l.filter;if(!l||!e||!d)return[];for(var c,h=[];c=l.nextNode();)h.push(c);return h},e.prototype._findElement=function(e,t,i,o,n,r,u){var a=this;if(!e)return null;if(!e.ownerDocument||t&&e!==t&&!e.contains(t))return null;u||(u=function(e){return a._ah.focusable.isFocusable(e,i)});var l=s(e.ownerDocument,e,function(e){return a._acceptElement(e,u,o,n)});if(!l)return null;if(t)l.currentNode=t;else if(r){for(var d=null,c=e.lastElementChild;c;c=c.lastElementChild)d=c;if(!d)return null;if(this._acceptElement(d,u,o,n)===NodeFilter.FILTER_ACCEPT)return d;l.currentNode=d}return r?l.previousNode():l.nextNode()},e.prototype._acceptElement=function(e,t,i,o){var n=Oe.getAbilityHelpersContext(this._ah,e),r=n&&n.root.getCurrentModalizerId();return i||!n||!n.modalizer||void 0===r||r===n.modalizer.userId||n.modalizer.getBasicProps().isAlwaysAccessible?o||!1!==this._isInCurrentGroupper(e,!0)?t(e)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP:NodeFilter.FILTER_REJECT:n?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_SKIP},e}(),at=["input","textarea","*[contenteditable]"].join(", "),lt=function(e){function t(i,o){var n=e.call(this)||this;return n._canOverrideNativeFocus=!1,n._init=function(){n._initTimer=void 0;var e=n._win();n._canOverrideNativeFocus=M(e),t.replaceFocus(e),e.document.addEventListener("focusin",n._onFocusIn,!0),e.document.addEventListener("focusout",n._onFocusOut,!0),e.document.addEventListener("mousedown",n._onMouseDown,!0),e.addEventListener("keydown",n._onKeyDown)},n._onFocusIn=function(e){n._setFocusedElement(e.target,e.relatedTarget||void 0)},n._onFocusOut=function(e){n._setFocusedElement(void 0,e.relatedTarget||void 0)},n._onMouseDown=function(e){var t=n._ah.focusable.findGroupper(e.target);t&&n._ah.focusable.setCurrentGroupper(t)},n._onKeyDown=function(e){var t,i,o,r,s,u,a=n.getVal();if(a&&a.ownerDocument){switch(e.keyCode){case we.Enter:case we.Esc:case we.Tab:case we.Down:case we.Right:case we.Up:case we.Left:case we.PageDown:case we.PageUp:case we.Home:case we.End:break;default:return}var l=Oe.getAbilityHelpersContext(n._ah,a),c=e.keyCode,h=c===we.Tab;if((h||l&&l.mover&&!l.isGroupperFirst)&&c!==we.Enter&&c!==we.Esc){if(!l)return;var p=h&&e.shiftKey||!h&&(c===we.Left||c===we.Up||c===we.PageUp||c===we.Home);if(l&&l.modalizer){var f=l.root.getCurrentModalizerId();if(f&&f!==l.modalizer.userId&&(l.modalizer=l.root.getModalizerById(f),l.modalizer&&!(a=l.modalizer.getElement())))return}var v=h&&l.mover&&(null===(t=l.moverOptions)||void 0===t?void 0:t.navigationType)===q.Arrows?p?n._ah.focusable.findFirst(l.mover):n._ah.focusable.findLast(l.mover):a;if(!v)return;T=null;switch(c){case we.Tab:case we.Down:case we.Right:case we.Up:case we.Left:T=p?n._ah.focusable.findPrev(v):n._ah.focusable.findNext(v);break;case we.Home:T=(null===(i=l.mover)||void 0===i?void 0:i.contains(v))?n._ah.focusable.findFirst(l.mover):T;break;case we.End:T=(null===(o=l.mover)||void 0===o?void 0:o.contains(v))?n._ah.focusable.findLast(l.mover):T;break;case we.PageDown:case we.PageUp:return}if(!h&&l.mover&&(!T||T&&!l.mover.contains(T))){if(e.preventDefault(),!(null===(r=l.moverOptions)||void 0===r?void 0:r.cyclic))return;T=p?n._ah.focusable.findLast(l.mover):n._ah.focusable.findFirst(l.mover)}w=null===(y=null===l||void 0===l?void 0:l.groupper)||void 0===y?void 0:y.getElement();if(y&&w){var m=n._getFirstInGroupper(w,!1);if(!m||a===m||y.getBasicProps().isLimited!==ie.LimitedTrapFocus||T&&T!==m&&w.contains(T)){if(a===m&&w.parentElement){var g=null===(I=null===(s=Oe.getAbilityHelpersContext(n._ah,w.parentElement))||void 0===s?void 0:s.groupper)||void 0===I?void 0:I.getElement();I&&g&&!g.contains(T)&&I.getBasicProps().isLimited===ie.LimitedTrapFocus&&(T=a)}}else T=p?n._ah.focusable.findLast(w):n._ah.focusable.findNext(m,w)}if(l&&l.modalizer){var b=T&&Oe.getAbilityHelpersContext(n._ah,T);if((!b||l.root.uid!==b.root.uid||!b.modalizer||b.root.getCurrentModalizerId()!==b.modalizer.userId)&&l.modalizer.onBeforeFocusOut())return void e.preventDefault()}T?(e.preventDefault(),_(T)):l&&l.root.moveOutWithDefaultAction(p)}else{if((c===we.Left||c===we.Right)&&n._isInput(a))return;var y=null===l||void 0===l?void 0:l.groupper,w=null===y||void 0===y?void 0:y.getElement();if(!y||!w)return;var E=!0,T=null;switch(c){case we.Enter:case we.Esc:var F=y.getState();if(e.keyCode===we.Enter)F.isLimited&&a===n._getFirstInGroupper(w,!0)?(y.setUnlimited(!0),T=n._ah.focusable.findNext(a),w.contains(T)||(T=null),null===T&&(E=!1)):E=!1;else{if(F.isLimited&&w.parentElement){var I=null===(u=Oe.getAbilityHelpersContext(n._ah,w.parentElement))||void 0===u?void 0:u.groupper;I&&(w=I.getElement(),y=I,F=I.getState())}F.isLimited||(y.setUnlimited(!1),T=w||null)}break;case we.Down:case we.Right:case we.Up:case we.Left:T=n._findNextGroupper(w,e.keyCode,y.getBasicProps().nextDirection);break;case we.PageDown:(T=n._findPageDownGroupper(w))&&d(T,!0);break;case we.PageUp:(T=n._findPageUpGroupper(w))&&d(T,!1);break;case we.Home:w.parentElement&&(T=n._ah.focusable.findFirstGroupper(w));break;case we.End:w.parentElement&&(T=n._ah.focusable.findLastGroupper(w))}E&&(e.preventDefault(),e.stopImmediatePropagation()),T&&(n._ah.focusable.isFocusable(T)||(T=n._ah.focusable.findFirst(T,!1,!1,!0)),T&&(n._ah.focusable.setCurrentGroupper(T),Te.setVal(n._ah.keyboardNavigation,!0),_(T)))}}},n._validateFocusedElement=function(e,t){var i=Oe.getAbilityHelpersContext(n._ah,e),o=i?i.root.getCurrentModalizerId():void 0;if(n._ah.focusable.setCurrentGroupper(e),i&&i.modalizer){var r=i.modalizer;if(o!==r.userId)if(void 0===o||t.isFocusedProgrammatically)i.root.setCurrentModalizerId(r.userId);else if(r&&e.ownerDocument){var s=n._ah.focusable.findFirst(i.root.getElement());if(s){if(e.compareDocumentPosition(s)&document.DOCUMENT_POSITION_PRECEDING&&!(s=n._ah.focusable.findLast(e.ownerDocument.body)))throw new Error("Something went wrong.");n._ah.focusedElement.focus(s)}else e.blur()}}},n._ah=i,n._win=o,n._initTimer=o().setTimeout(n._init,0),n}return J.c(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this);var i=this._win();t.restoreFocus(i),this._initTimer&&(i.clearTimeout(this._initTimer),this._initTimer=void 0),i.document.removeEventListener("focusin",this._onFocusIn,!0),i.document.removeEventListener("focusout",this._onFocusOut,!0),i.document.removeEventListener("mousedown",this._onMouseDown,!0),i.removeEventListener("keydown",this._onKeyDown),delete t._lastFocusedProgrammatically,delete t._lastResetElement,delete this._nextVal,delete this._lastVal},t.dispose=function(e){e.dispose()},t.forgetMemorized=function(e,i){var o,n,r=t._lastFocusedProgrammatically,s=r&&r.get();s&&i.contains(s)&&delete t._lastFocusedProgrammatically,(s=(r=t._lastResetElement)&&r.get())&&i.contains(s)&&delete t._lastResetElement,(s=null===(n=null===(o=e._nextVal)||void 0===o?void 0:o.element)||void 0===n?void 0:n.get())&&i.contains(s)&&delete e._nextVal,(s=(r=e._lastVal)&&r.get())&&i.contains(s)&&delete e._lastVal},t.prototype.getFocusedElement=function(){return this.getVal()},t.prototype.getLastFocusedElement=function(){var e,t=null===(e=this._lastVal)||void 0===e?void 0:e.get();return(!t||t&&!b(t.ownerDocument,t))&&(this._lastVal=t=void 0),t},t.prototype.focus=function(e,i,o){return!!this._ah.focusable.isFocusable(e,i,!1,o)&&(t._lastFocusedProgrammatically=new ye(e),e.focus(),!0)},t.prototype.focusDefault=function(e){var t=this._ah.focusable.findDefault(e);return!!t&&(this._ah.focusedElement.focus(t),!0)},t.prototype.focusFirst=function(e){var t=this._ah.focusable.findFirst(e,!1,!0);return!!t&&(this.focus(t),!0)},t.prototype.resetFocus=function(e){if(!this._ah.focusable.isVisible(e))return!1;if(this._ah.focusable.isFocusable(e,!0,!0,!0))this.focus(e);else{var i=e.getAttribute("tabindex"),o=e.getAttribute("aria-hidden");e.tabIndex=-1,e.setAttribute("aria-hidden","true"),t._lastResetElement=new ye(e),this.focus(e,!0,!0),this._setOrRemoveAttribute(e,"tabindex",i),this._setOrRemoveAttribute(e,"aria-hidden",o)}return!0},t.prototype._setOrRemoveAttribute=function(e,t,i){null===i?e.removeAttribute(t):e.setAttribute(t,i)},t.prototype._setFocusedElement=function(e,i){var o,n,r={relatedTarget:i};if(e){var s=null===(o=t._lastResetElement)||void 0===o?void 0:o.get();if(t._lastResetElement=void 0,s===e||p(e))return;(this._canOverrideNativeFocus||t._lastFocusedProgrammatically)&&(r.isFocusedProgrammatically=e===(null===(n=t._lastFocusedProgrammatically)||void 0===n?void 0:n.get()),t._lastFocusedProgrammatically=void 0)}var u=this._nextVal={element:e?new ye(e):void 0,details:r};e&&e!==this._val&&this._validateFocusedElement(e,r),this._nextVal===u&&this.setVal(e,r),this._nextVal=void 0},t.prototype.setVal=function(t,i){e.prototype.setVal.call(this,t,i),t&&(this._lastVal=new ye(t))},t.replaceFocus=function(e){function i(){return t._lastFocusedProgrammatically=new ye(this),o.apply(this,arguments)}var o=e.HTMLElement.prototype.focus;o.__ahFocus||(e.HTMLElement.prototype.focus=i,i.__ahFocus=o)},t.restoreFocus=function(e){var t=e.HTMLElement.prototype,i=t.focus.__ahFocus;i&&(t.focus=i)},t.prototype._getFirstInGroupper=function(e,t){return this._ah.focusable.isFocusable(e)?e:this._ah.focusable.findFirst(e,!1,!1,t)},t.prototype._findNextGroupper=function(e,t,i){if(i===oe.Vertical&&(t===we.Left||t===we.Right))return null;if(i===oe.Horizontal&&(t===we.Up||t===we.Down))return null;if(void 0===i||i===oe.Both)return t===we.Left||t===we.Up?this._ah.focusable.findPrevGroupper(e):this._ah.focusable.findNextGroupper(e);for(var o,n,r,s=e.getBoundingClientRect(),u=t===we.Down||t===we.Right?"findNextGroupper":"findPrevGroupper",a=this._ah.focusable[u](e);a;a=this._ah.focusable[u](a)){var l=a.getBoundingClientRect();if(t===we.Up){if(l.top<s.top){if(void 0===r)r=l.top;else if(l.top<r)break;if(l.left<s.left){o||(o=a);break}o=a}}else if(t===we.Down){if(l.top>s.top){if(void 0===r)r=l.top;else if(l.top>r)break;if(l.left>s.left){o||(o=a);break}o=a}}else if(t===we.Left||t===we.Right){o=a;break}n=a}return o||n||null},t.prototype._findPageUpGroupper=function(e){for(var t=this._ah.focusable.findPrevGroupper(e),i=null;t;)i=t,t=a(t)?this._ah.focusable.findPrevGroupper(t):null;return i},t.prototype._findPageDownGroupper=function(e){for(var t=this._ah.focusable.findNextGroupper(e),i=null;t;)i=t,t=a(t)?this._ah.focusable.findNextGroupper(t):null;return i},t.prototype._isInput=function(e){return y(e,at)},t}(Ee),dt=0,ct=function(){function e(e,t,i,o,n){this._isAccessible=!0,this._isFocused=!1,this._ah=t,this._win=i,this.internalId="ml"+ ++dt,this.userId=o.id,this._element=new ye(e),this._basic=o,this._extended=n||{},this._setAccessibilityProps()}return e.prototype.setProps=function(e,t){e?(e.id&&(this.userId=e.id),this._basic=J.a(J.a({},this._basic),e)):null===e&&(this._basic={id:this.userId}),t?this._extended=J.a(J.a({},this._extended),t):null===t&&(this._extended={}),this._setAccessibilityProps()},e.prototype.dispose=function(){this._setAccessibleTimer&&(this._win().clearTimeout(this._setAccessibleTimer),this._setAccessibleTimer=void 0),this._isFocused&&this.setFocused(!1),this._remove(),this._extended={}},e.prototype.move=function(e){this._remove(),this._element=new ye(e),this._setAccessibilityProps(),this._isAccessible=!this._isAccessible,this._isActive=!this._isActive,this.setAccessible(!this._isAccessible),this.setActive(!this._isActive)},e.prototype.setAccessible=function(e){var t=this;if(e!==this._isAccessible){this._isAccessible=e,this._setAccessibleTimer&&(this._win().clearTimeout(this._setAccessibleTimer),this._setAccessibleTimer=void 0);var i=this._element.get();i&&(e?O(this._ah,i,"aria-hidden"):this._setAccessibleTimer=this._win().setTimeout(function(){t._setAccessibleTimer=void 0,O(t._ah,i,"aria-hidden","true")},0))}},e.prototype.setActive=function(e){e!==this._isActive&&(this._isActive=e)},e.prototype.isActive=function(){return!!this._isActive},e.prototype.getElement=function(){return this._element.get()},e.prototype.setFocused=function(e){this._isFocused!==e&&(this._isFocused=e,e?this._extended.onFocusIn&&this._extended.onFocusIn():this._extended.onFocusOut&&this._extended.onFocusOut(!1))},e.prototype.onBeforeFocusOut=function(){return!!this._extended.onFocusOut&&this._extended.onFocusOut(!0)},e.prototype.getBasicProps=function(){return this._basic},e.prototype.getExtendedProps=function(){return this._extended},e.prototype._remove=function(){},e.prototype._setAccessibilityProps=function(){},e}(),ht=function(){function e(e){var t=this;this._init=function(){t._initTimer=void 0,t._ah.focusedElement.subscribe(t._onFocus)},this._onFocus=function(e){t._focusOutTimer&&(t._win().clearTimeout(t._focusOutTimer),t._focusOutTimer=void 0);var i;if(e){var o=Oe.getAbilityHelpersContext(t._ah,e);o&&(i=o.modalizer)}i?(t._curModalizer&&i!==t._curModalizer&&t._curModalizer.setFocused(!1),t._curModalizer=i,t._curModalizer.setFocused(!0)):t._curModalizer&&(t._focusOutTimer=t._win().setTimeout(function(){t._focusOutTimer=void 0,t._curModalizer&&(t._curModalizer.setFocused(!1),t._curModalizer=void 0)},0))},this._ah=e,this._win=e.getWindow,this._initTimer=this._win().setTimeout(this._init,0)}return e.prototype.dispose=function(){var e=this._win();this._initTimer&&(e.clearTimeout(this._initTimer),this._initTimer=void 0),this._focusOutTimer&&(e.clearTimeout(this._focusOutTimer),this._focusOutTimer=void 0),this._ah.focusedElement.unsubscribe(this._onFocus),delete this._curModalizer},e.dispose=function(e){e.dispose()},e.prototype.add=function(e,t,i){var o=I(this._ah,e);if(!o||!o.modalizer){var n=new ct(e,this._ah,this._win,t,i);F(this._ah,e,{modalizer:n}),k(e,{modalizer:n})}},e.prototype.setProps=function(e,t,i){var o=I(this._ah,e);o&&o.modalizer&&o.modalizer.setProps(t,i)},e.prototype.remove=function(e){var t=I(this._ah,e),i=t&&t.modalizer;i&&(F(this._ah,e,{modalizer:void 0}),k(e,{modalizer:i,removed:!0}),i.dispose())},e.prototype.move=function(e,t){var i=I(this._ah,e),o=i&&i.modalizer;o&&(o.move(t),F(this._ah,t,{modalizer:o}),F(this._ah,e,{modalizer:void 0}),k(e,{modalizer:o,removed:!0}),k(t,{modalizer:o}))},e.prototype.focus=function(e,t,i){var o=Oe.getAbilityHelpersContext(this._ah,e);if(o&&o.modalizer){o.root.setCurrentModalizerId(o.modalizer.userId);var n=o.modalizer.getBasicProps(),r=o.modalizer.getElement();if(r){if(void 0===t&&(t=n.isNoFocusFirst),!t&&this._ah.keyboardNavigation.isNavigatingWithKeyboard()&&this._ah.focusedElement.focusFirst(r))return!0;if(void 0===i&&(i=n.isNoFocusDefault),!i&&this._ah.focusedElement.focusDefault(r))return!0;this._ah.focusedElement.resetFocus(r)}}return!1},e}(),pt={},_t={},ft=function(e){function t(t){var i=e.call(this)||this;return i._waiting={},i._lastRequestFocusId=0,i._init=function(){i._initTimer=void 0,i._win().document.addEventListener(Fe,i._onMutation,!0)},i._onMutation=function(e){e.target&&e.details.observed&&i._onObservedElementUpdate(e.details.observed)},i._ah=t,i._win=t.getWindow,i._initTimer=i._win().setTimeout(i._init,0),i}return J.c(t,e),t.prototype.dispose=function(){var e=this._win();this._initTimer&&(e.clearTimeout(this._initTimer),this._initTimer=void 0),e.document.removeEventListener(Fe,this._onMutation,!0);for(var t=0,i=Object.keys(this._waiting);t<i.length;t++){var o=i[t],n=this._waiting[o];n.timer&&e.clearTimeout(n.timer),n.reject&&n.reject(),delete this._waiting[o]}},t.dispose=function(e){e.dispose()},t.prototype.add=function(e,t,i){var o=I(this._ah,e);o&&o.observed||(F(this._ah,e,{observed:J.a(J.a({},t),i)}),this._onObservedElementUpdate(e))},t.prototype.remove=function(e){var t=I(this._ah,e);t&&t.observed&&(F(this._ah,e,{observed:void 0}),this._onObservedElementUpdate(e))},t.prototype.move=function(e,t){var i=I(this._ah,e),o=I(this._ah,t),n=i&&i.observed;if(n){if(F(this._ah,e,{observed:void 0}),this._onObservedElementUpdate(e),o&&o.observed)return;F(this._ah,t,{observed:n}),this._onObservedElementUpdate(t)}},t.prototype.setProps=function(e,t,i){var o=I(this._ah,e),n=o&&o.observed;n&&(F(this._ah,e,{observed:J.a(J.a(J.a({},n),t),i)}),this._onObservedElementUpdate(e))},t.prototype.getElement=function(e){var t=_t[e];if(t)for(var i=0,o=Object.keys(t);i<o.length;i++)return t[o[i]].element;return null},t.prototype.waitElement=function(e,t){var i=this,o=this.getElement(e);if(o)return w().resolve(o);var n=this._waiting[e];if(n&&n.promise)return n.promise;n=this._waiting[e]={timer:this._win().setTimeout(function(){n.timer=void 0,delete i._waiting[e],n.resolve&&n.resolve(null)},t)};var r=new(w())(function(e,t){n.resolve=e,n.reject=t});return n.promise=r,r},t.prototype.requestFocus=function(e,t){return J.b(this,void 0,void 0,function(){var i,o=this;return J.d(this,function(n){return i=++this._lastRequestFocusId,[2,this.waitElement(e,t).then(function(e){return!(o._lastRequestFocusId!==i||!e)&&o._ah.focusedElement.focus(e)})]})})},t.prototype._onObservedElementUpdate=function(e){var t=I(this._ah,e),i=t&&t.observed,o=v(e,this._win()),n=b(e.ownerDocument,e),r=pt[o];if(i&&n){if(r||(r=pt[o]={element:e}),i.name&&i.name!==r.triggeredName){if(r.triggeredName){var s=_t[r.triggeredName];s&&s[o]&&(Object.keys(s).length>1?delete s[o]:delete _t[r.triggeredName])}r.triggeredName=i.name,(u=_t[r.triggeredName])||(u=_t[r.triggeredName]={}),u[o]=r,this._trigger(e,{name:i.name,details:i.details})}}else if(r){if(r.triggeredName){var u=_t[r.triggeredName];u&&u[o]&&(Object.keys(u).length>1?delete u[o]:delete _t[r.triggeredName])}delete pt[o]}},t.prototype._trigger=function(e,t){this.trigger(e,t);var i=t.name,o=i&&this._waiting[i];o&&(o.timer&&this._win().clearTimeout(o.timer),delete this._waiting[i],o.resolve&&o.resolve(e))},t}(Ee),vt={areaClass:"ah-focus-outline-area",outlineClass:"ah-focus-outline",outlineColor:"#ff4500",outlineWidth:2,zIndex:2147483647},mt=vt;"undefined"!=typeof document&&("onfullscreenchange"in document?(me="fullscreenchange",ge="fullscreenElement"):"onwebkitfullscreenchange"in document?(me="webkitfullscreenchange",ge="webkitFullscreenElement"):"onmozfullscreenchange"in document?(me="mozfullscreenchange",ge="mozFullScreenElement"):"onmsfullscreenchange"in document&&(me="msfullscreenchange",ge="msFullscreenElement"));var gt=function(){function e(e,t,i,o){this.left=e,this.top=t,this.right=i,this.bottom=o}return e.prototype.equalsTo=function(e){return this.left===e.left&&this.top===e.top&&this.right===e.right&&this.bottom===e.bottom},e.prototype.clone=function(){return new e(this.left,this.top,this.right,this.bottom)},e}(),bt=function(){function e(t){var i=this;this._isVisible=!1,this._allOutlineElements=[],this._init=function(){i._initTimer=void 0,i._ah.keyboardNavigation.subscribe(i._onKeyboardNavigationStateChanged),i._ah.focusedElement.subscribe(i._onFocus);var e=i._win();e.addEventListener("scroll",i._onScroll,!0),me&&e.document.addEventListener(me,i._onFullScreenChanged)},this._onFullScreenChanged=function(e){if(ge&&e.target){var t=e.target.body||e.target,o=i._getDOM(t);if(t.ownerDocument&&o){var n=t.ownerDocument[ge];n?(n.appendChild(o.container),i._fullScreenElement=n):(t.ownerDocument.body.appendChild(o.container),i._fullScreenElement=void 0)}}},this._onKeyboardNavigationStateChanged=function(){i._onFocus(i._ah.focusedElement.getFocusedElement())},this._onFocus=function(e){!i._updateElement(e)&&i._isVisible&&i._setVisibility(!1)},this._onScroll=function(t){i._outlinedElement&&e._isParentChild(t.target,i._outlinedElement)&&(i._curPos=void 0,i._setOutlinePosition())},this._ah=t,this._win=t.getWindow,this._win().setTimeout(this._init,0)}return e.prototype.setup=function(e){mt=J.a(J.a({},mt),e);var t=this._win();t.__ahOutline||(t.__ahOutline={}),t.__ahOutline.style||(t.__ahOutline.style=U(t.document,mt)),e&&e.areaClass?t.document.body.classList.remove(vt.areaClass):t.document.body.classList.add(vt.areaClass)},e.prototype.setProps=function(e,t){var i=I(this._ah,e),o=i&&i.outline||{},n={};if(t)for(var r=0,s=Object.keys(t);r<s.length;r++){var u=s[r],a=t[u];a?n[u]=a:void 0===a&&o[u]&&(n[u]=o[u])}n.isIgnored!==o.isIgnored&&F(this._ah,e,{outline:n})},e.prototype.dispose=function(){var e=this,t=this._win();this._initTimer&&(t.clearTimeout(this._initTimer),this._initTimer=void 0),this._updateTimer&&(t.clearTimeout(this._updateTimer),this._updateTimer=void 0),this._ah.keyboardNavigation.unsubscribe(this._onKeyboardNavigationStateChanged),this._ah.focusedElement.unsubscribe(this._onFocus),t.removeEventListener("scroll",this._onScroll,!0),me&&t.document.removeEventListener(me,this._onFullScreenChanged),this._allOutlineElements.forEach(function(t){return e._removeDOM(t.container)}),this._allOutlineElements=[],delete this._outlinedElement,delete this._curPos,delete this._curOutlineElements,delete this._fullScreenElement},e.dispose=function(e){e.dispose()},e.prototype._shouldShowCustomOutline=function(e){var t=I(this._ah,e);if(t&&t.outline&&t.outline.isIgnored)return!1;for(var i=e;i;i=i.parentElement)if(i.classList&&i.classList.contains(mt.areaClass))return!0;return!1},e.prototype._updateElement=function(e){if(this._outlinedElement=void 0,this._updateTimer&&(this._win().clearTimeout(this._updateTimer),this._updateTimer=void 0),this._curPos=void 0,!this._ah.keyboardNavigation.isNavigatingWithKeyboard())return!1;if(e){if("INPUT"===e.tagName){if(!(e.type in{button:!0,checkbox:!0,file:!0,image:!0,radio:!0,range:!0,reset:!0,submit:!0}))return!1}else if("TEXTAREA"===e.tagName||"true"===e.contentEditable||"IFRAME"===e.tagName)return!1;return!!this._shouldShowCustomOutline(e)&&(this._ah.keyboardNavigation.isNavigatingWithKeyboard()&&(this._outlinedElement=e,this._updateOutline()),!0)}return!1},e.prototype._updateOutline=function(){var e=this;this._setOutlinePosition(),this._updateTimer&&(this._win().clearTimeout(this._updateTimer),this._updateTimer=void 0),this._outlinedElement&&(this._updateTimer=this._win().setTimeout(function(){e._updateTimer=void 0,e._updateOutline()},30))},e.prototype._setVisibility=function(e){this._isVisible=e,this._curOutlineElements&&(e?this._curOutlineElements.container.classList.add(mt.outlineClass+"_visible"):(this._curOutlineElements.container.classList.remove(mt.outlineClass+"_visible"),this._curPos=void 0))},e.prototype._setOutlinePosition=function(){if(this._outlinedElement){var e=u(this._outlinedElement),t=new gt(e.left,e.top,e.right,e.bottom);if(!this._curPos||!t.equalsTo(this._curPos)){var i=this._getDOM(this._outlinedElement),o=this._outlinedElement.ownerDocument&&this._outlinedElement.ownerDocument.defaultView;if(i&&o){this._curOutlineElements!==i&&(this._setVisibility(!1),this._curOutlineElements=i),this._curPos=t;var n=t.clone(),r=!1,s=!1,a=i.container,l=a&&a.ownerDocument&&a.ownerDocument.scrollingElement;if(l){for(var d=this._outlinedElement.parentElement;d&&d!==this._fullScreenElement;d=d.parentElement){e=u(d);var c=d.ownerDocument&&d.ownerDocument.defaultView;if(!c)return;var h=c.getComputedStyle(d),p=h.position;"absolute"===p?r=!0:"fixed"!==p&&"sticky"!==p||(s=!0),"visible"!==h.overflow&&((r||s)&&"hidden"!==h.overflow||(e.left>n.left&&(n.left=e.left),e.top>n.top&&(n.top=e.top),e.right<n.right&&(n.right=e.right),e.bottom<n.bottom&&(n.bottom=e.bottom)))}var _=u(l),f=_.left+_.right,v=_.top+_.bottom,m=mt.outlineWidth;n.left=n.left>m?n.left-m:0,n.top=n.top>m?n.top-m:0,n.right=n.right<f-m?n.right+m:f,n.bottom=n.bottom<v-m?n.bottom+m:v;var g=n.right-n.left,b=n.bottom-n.top;if(g>2*m&&b>2*m){var y=i.left,w=i.top,E=i.right,T=i.bottom,F=this._fullScreenElement||s?0:o.pageXOffset,I=this._fullScreenElement||s?0:o.pageYOffset;a.style.position=s?"fixed":"absolute",a.style.background=mt.outlineColor,y.style.width=E.style.width=w.style.height=T.style.height=mt.outlineWidth+"px",y.style.left=w.style.left=T.style.left=n.left+F+"px",E.style.left=n.left+F+g-m+"px",y.style.top=E.style.top=w.style.top=n.top+I+"px",T.style.top=n.top+I+b-m+"px",y.style.height=E.style.height=b+"px",w.style.width=T.style.width=g+"px",this._setVisibility(!0)}else this._setVisibility(!1)}}}}},e.prototype._getDOM=function(e){var t=e.ownerDocument,i=t&&t.defaultView;if(t&&i&&i.__ahOutline){if(i.__ahOutline.style||(i.__ahOutline.style=U(t,mt)),!i.__ahOutline.elements){var o={container:t.createElement("div"),left:t.createElement("div"),top:t.createElement("div"),right:t.createElement("div"),bottom:t.createElement("div")};o.container.className=mt.outlineClass,o.left.className=mt.outlineClass+"__left",o.top.className=mt.outlineClass+"__top",o.right.className=mt.outlineClass+"__right",o.bottom.className=mt.outlineClass+"__bottom",o.container.appendChild(o.left),o.container.appendChild(o.top),o.container.appendChild(o.right),o.container.appendChild(o.bottom),t.body.appendChild(o.container),i.__ahOutline.elements=o,this._allOutlineElements.push(o)}return i.__ahOutline.elements}},e.prototype._removeDOM=function(e){var t=e.ownerDocument&&e.ownerDocument.defaultView,i=t&&t.__ahOutline;if(i){i.style&&i.style.parentNode&&(i.style.parentNode.removeChild(i.style),delete i.style);var o=i&&i.elements;o&&(o.container.parentNode&&o.container.parentNode.removeChild(o.container),delete i.elements)}},e._isParentChild=function(e,t){return t===e||!!(e.compareDocumentPosition(t)&document.DOCUMENT_POSITION_CONTAINED_BY)},e}(),yt=function(){function e(e,t){var i=this;this._forgetMemorizedElements=[],this.getWindow=function(){if(!i._win)throw new Error("Using disposed AbilityHelpers.");return i._win},this._storage={},this._win=e,e&&e.document&&(this._unobserve=C(e.document,this,D));var o=this.getWindow;this.keyboardNavigation=new Te(this,o),this.focusedElement=new lt(this,o),this.focusable=new ut(this,o),this.root=new Oe(this,function(){ut.forgetFocusedGrouppers(i.focusable)},null===t||void 0===t?void 0:t.autoRoot),n(o)}return e.prototype.dispose=function(){var e,t;this._unobserve&&(this._unobserve(),delete this._unobserve),this._forgetMemorizedElements=[],this._win&&this._forgetMemorizedTimer&&(this._win.clearTimeout(this._forgetMemorizedTimer),delete this._forgetMemorizedTimer),this.outlineDispose&&(this.outlineDispose(),delete this.outline,delete this.outlineDispose),this.crossOriginDispose&&(this.crossOriginDispose(),delete this.crossOrigin,delete this.crossOriginDispose),this.deloserDispose&&(this.deloserDispose(),delete this.deloser,delete this.deloserDispose),this.modalizerDispose&&(this.modalizerDispose(),delete this.modalizer,delete this.modalizerDispose),this.observedElementDispose&&(this.observedElementDispose(),delete this.observedElement,delete this.observedElementDispose),Te.dispose(this.keyboardNavigation),ut.dispose(this.focusable),lt.dispose(this.focusedElement),Oe.dispose(this.root),r(this.getWindow),g(),this._storage={},(null===(e=this._win)||void 0===e?void 0:e.__ahInstance)&&(null===(t=this._win)||void 0===t||delete t.__ahInstance),delete this._win},e.dispose=function(e){e.dispose()},e.prototype.storageEntry=function(e,t){var i=this._storage[e];return i?!1===t&&0===Object.keys(i).length&&delete this._storage[e]:!0===t&&(i=this._storage[e]={}),i},e.forceCleanup=function(e){e._win&&(e._forgetMemorizedElements.push(e._win.document.body),e._forgetMemorizedTimer||(e._forgetMemorizedTimer=e._win.setTimeout(function(){delete e._forgetMemorizedTimer;for(var t=e._forgetMemorizedElements.shift();t;t=e._forgetMemorizedElements.shift())g(t),lt.forgetMemorized(e.focusedElement,t)},0),o(!0)))},e}()}},[2751]);