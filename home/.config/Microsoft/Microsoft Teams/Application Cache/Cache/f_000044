(window.webPackBridgeJsonp=window.webPackBridgeJsonp||[]).push([[42],{"615dbc455b25e563c17c":function(e,t,n){"use strict";var i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"authenticationToken"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"resource"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationToken"},arguments:[{kind:"Argument",name:{kind:"Name",value:"resource"},value:{kind:"Variable",name:{kind:"Name",value:"resource"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"token"}}]}}]}}]},a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"authenticationToken"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"resource"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"acquireTokenOptions"}},type:{kind:"NamedType",name:{kind:"Name",value:"AcquireTokenOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationToken"},arguments:[{kind:"Argument",name:{kind:"Name",value:"resource"},value:{kind:"Variable",name:{kind:"Name",value:"resource"}}},{kind:"Argument",name:{kind:"Name",value:"acquireTokenOptions"},value:{kind:"Variable",name:{kind:"Name",value:"acquireTokenOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"token"}}]}}]}}]},o=n("94a755535d135f12850c"),r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"authenticationUsers"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"filter"}},type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationUserFilter"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationUsers"},arguments:[{kind:"Argument",name:{kind:"Name",value:"filter"},value:{kind:"Variable",name:{kind:"Name",value:"filter"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isAuthenticated"}},{kind:"Field",name:{kind:"Name",value:"profile"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"objectId"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"upn"}},{kind:"Field",name:{kind:"Name",value:"puid"}}]}}]}}]}}]},s=n("682ca5ea0252efc642e4"),u=n("3525ad72f86c96c13479");n.d(t,"a",function(){return l});var l=function(e){return{acquireToken:function(t){return e.query({query:i,variables:{resource:t},fetchPolicy:"network-only"}).then(function(e){var t,n=e.data;return{token:null===(t=null==n?void 0:n.authenticationToken)||void 0===t?void 0:t.token}})},acquireTokenWithOptions:function(t,n){return d(e,t,n).then(function(e){var t,n=e.data;return{token:null===(t=null==n?void 0:n.authenticationToken)||void 0===t?void 0:t.token}}).catch(function(e){return Promise.reject(c(e)||e)})},getUser:function(){return e.query({query:r,variables:{filter:{isAuthenticated:!0}}}).then(function(e){var t=e.data,n=e.errors,i=null==t?void 0:t.authenticationUsers;if(!n&&i&&0!==i.length){var a=i[0].profile;return{profile:{oid:a.objectId,tid:a.tenantId,upn:a.upn}}}})}}},d=function(e,t,n){return e.query({query:a,variables:{resource:t,acquireTokenOptions:{claim:void 0,silent:n}},fetchPolicy:"network-only"})},c=function(e){if(f(e)){var t=Object(s.b)(e);return Object(u.d)(t,"innerError",void 0)}return null},f=function(e){return!!e&&!!Object(o.get)(e,"graphQLErrors")}},"7a94afd70fa704798b8b":function(e,t,n){"use strict";var i;n.d(t,"a",function(){return i}),function(e){e.iframe="iframe",e.webview="webview"}(i||(i={}))},"87d08a9dabb24a93ef74":function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return a}),n.d(t,"c",function(){return r});var i,a,o,r;!function(e){e.web="web",e.desktop="desktop",e.rigel="rigel"}(i||(i={})),function(e){e.settings="settings",e.content="content",e.authentication="authentication",e.remove="remove",e.task="task",e.sidePanel="sidePanel"}(a||(a={})),function(e){e[e.Admin=0]="Admin",e[e.User=1]="User",e[e.Guest=2]="Guest"}(o||(o={})),function(e){e.card="card",e.deepLink="deepLink",e.contentBubble="contentBubble",e.messageExtension="messageExtension",e.tab="tab",e.shareToOutlook="shareToOutlook",e.adaptiveCardTab="adaptiveCardTab",e.platformAppView="platformAppView",e.sidePanel="sidePanel"}(r||(r={}))},c521adff8f71ad960064:function(e,t,n){"use strict";var i=n("64328bb588b46459132d"),a=n("275976081ce1abf67779"),o=n("b3e258472a28e63623d9"),r=function(e){var t=e.sdkHost,n=e.contentUrl,o=e.frameContext,r=e.appDefinition,u=e.createWebview,l=e.title,d=a.useRef(null);return a.useEffect(function(){Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,u().then(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,t.setFrameAndLoadOrigin(d.current,n,r)];case 1:return e.sent(),[2]}})})})];case 1:return e.sent(),[2]}})})},[u,t,d,n,o,r]),a.createElement(s,{webviewRef:d,title:l})},s=function(e){var t=e.webviewRef,n=e.title;return a.createElement("webview",{ref:t,allowpopups:"true",style:{height:"100%",width:"100%",border:0,flex:1},"data-tid":"app-host-webview",title:n})},u=function(e){var t=e.sdkHost,n=e.contentUrl,o=e.frameContext,r=e.appDefinition,s=e.title,u=a.useRef(null);return a.useEffect(function(){Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,t.setFrameAndLoadOrigin(u.current,n,r)];case 1:return e.sent(),[2]}})})},[t,u,n,o,r]),a.createElement("iframe",{"data-tid":"app-host-iframe",ref:u,style:Object(i.__assign)({},{height:"100%",width:"100%",border:0,flex:1}),sandbox:"allow-forms allow-popups allow-popups-to-escape-sandbox allow-pointer-lock allow-scripts allow-same-origin allow-modals",title:s})},l=n("94a755535d135f12850c"),d=n("7a94afd70fa704798b8b");n("bf92262120ebdf79ce6a");var c,f=function(e){return new URL(e).href},h=function(e){return e&&new URL(e).hostname},p=function(e,t,n){return void 0!==t&&void 0!==e&&function(e,t){if(-1!==e.indexOf("local.teams.office.com"))return!0;for(var n=f(e),i=0,a=Object(l.uniqBy)(t,function(e){return e.toLowerCase()});i<a.length;i++){for(var o="",r=a[i].split("."),s=0;s<r.length;s++)o+=(s>0?"[.]":"")+r[s].replace("*","[^/^.]+");var u=new RegExp("^https://"+o+"((/|\\?).*)?$","i");if(e.match(u)||n.match(u))return!0}return!1}(w(t,n),v(e,n))},v=function(e,t){var n=e.validDomains?Object(l.cloneDeep)(e.validDomains):[];return e.galleryTabs&&n.push.apply(n,Object(l.map)(e.galleryTabs,function(e){return h(w(e.configurationUrl,t))})),e.staticTabs&&n.push.apply(n,Object(l.map)(e.staticTabs,function(e){return e.contentUrl?h(w(e.contentUrl,t)):null})),Object(l.remove)(n,function(e){return!e}),Object(l.uniqBy)(n,function(e){return e.toLowerCase()})},m=function(e){return e&&-1!==o.b.indexOf(e.toLowerCase())},g=function(e,t){return m(e)||!Object(l.isEmpty)(t)},b=function(e,t,n,i){var a;if(!n||n.isFullTrustApp||m(n.appId))return Promise.resolve(t);if(null===(a=null==n?void 0:n.webApplicationInfo)||void 0===a?void 0:a.resource){var o=k(n,i);return o&&y(o,e)?Promise.resolve([o]):Promise.reject("App resource defined in manifest and iframe origin do not match")}return Promise.reject("App webApplicationInfo or resource not defined in manifest")},w=function(e,t){if(e&&t){if(t.glassjarBaseUrl&&e.includes(o.d.glassjarBaseUrl)){var n=new RegExp(o.d.glassjarBaseUrl,"g");e=e.replace(n,t.glassjarBaseUrl)}if(t.teamSiteDomain&&e.includes(o.d.teamSiteDomain)){var i=new RegExp(o.d.teamSiteDomain,"g");e=e.replace(i,t.teamSiteDomain)}if(t.teamSitePath&&e.includes(o.d.teamSitePath)){i=new RegExp(o.d.teamSitePath,"g");e=e.replace(i,t.teamSitePath)}return e}return null!=e?e:""},k=function(e,t){var n,i;return(null===(n=e.webApplicationInfo)||void 0===n?void 0:n.resource)&&w(null===(i=e.webApplicationInfo)||void 0===i?void 0:i.resource,t)},y=function(e,t){if(e&&t){if(e===t)return!0;var n=h(t),i=o.e.validResourcePattern.replace(o.e.resourceDomainParameter,n);return new RegExp(i,"i").test(e)}return!1},A=n("87d08a9dabb24a93ef74"),M=function(){function e(e){this.listeners={},this.element=e}return e.prototype.addListener=function(e,t){this.element&&(this.removeListener(e),this.element.addEventListener(e,t),this.listeners[e]=t)},e.prototype.removeListener=function(e){this.element&&this.listeners[e]&&(this.element.removeEventListener(e,this.listeners[e]),delete this.listeners[e])},e.prototype.removeAllListeners=function(){for(var e=0,t=Object.keys(this.listeners);e<t.length;e++){var n=t[e];this.removeListener(n)}},e}();!function(e){e.InvalidAuthUrl="InvalidAuthUrl",e.CancelledByUser="CancelledByUser",e.UnsupportedFrameContext="UnsupportedFrameContext",e.AppDefinitionUnavailable="AppDefinitionUnavailable",e.Other="Other"}(c||(c={}));var O=function(){function e(e,t,n,i,a,r,s){var u=this;if(this.hostWindow=e,this.hostClientType=t,this.doneHandler=i,this.appDefinition=a,this.appContext=r,this.authenticationService=s,this.authHandlers={},this.initialized=!1,this.initialize=function(){return u.initialized=!0,[A.a.authentication,u.hostClientType]},this.handleAuthenticateSuccess=function(e,t){u.initialized&&e&&(u.closeWindow(),u.stopAuthWindowMonitor(),u.doneHandler(!0,t))},this.handleAuthenticateFailure=function(e,t){u.initialized&&e&&(u.closeWindow(),u.stopAuthWindowMonitor(),u.doneHandler(!1,t,c.Other))},this.removeMessageHandler=function(e){delete u.authHandlers[e]},this.onAuthMessageReceived=function(e){if(u.authWindow&&u.authWindow===e.source){var t=e.origin;t!==u.authOrigin&&p(u.appDefinition,t)&&(u.authOrigin=e.origin),u.authOrigin===t&&u.handleMessage(e)}},this.setupAuthMessageHandlers=function(){u.addMessageHandler(o.a.initialize,u.initialize),u.addMessageHandler(o.a.authentication.authenticateSuccess,u.handleAuthenticateSuccess),u.addMessageHandler(o.a.authentication.authenticateFailure,u.handleAuthenticateFailure),u.appContext&&u.authenticationService&&u.addMessageHandler(o.a.getContext,u.getContext(u.hostClientType,u.appContext,u.authenticationService))},p(a,n)){var l=this.hostWindow.opener.globalWindow;this.authWindow=l.open(n,"appAuthWindow",void 0),this.authWindow&&(this.globalWindowEventListener=new M(l),this.globalWindowEventListener.addListener("message",this.onAuthMessageReceived),this.startAuthWindowMonitor(),this.setupAuthMessageHandlers())}else i(!1,"Auth url is not valid",c.InvalidAuthUrl)}return e.prototype.isWindowOpen=function(){return!!this.authWindow&&!this.authWindow.closed},e.prototype.closeWindow=function(){var e;this.globalWindowEventListener&&this.globalWindowEventListener.removeListener("message"),null===(e=this.authWindow)||void 0===e||e.close()},e.prototype.addMessageHandler=function(e,t){this.authHandlers[e]=t},e.prototype.sendResponseMessage=function(e,t){if(this.authOrigin){var n={id:e,args:t,origin:this.authOrigin};this.postMessage(n)}},e.prototype.sendRequestMessage=function(e,t){if(this.authOrigin){var n={func:e,args:t};this.postMessage(n)}},e.prototype.startAuthWindowMonitor=function(){var e=this;this.stopAuthWindowMonitor(),this.authWindowMonitor=this.hostWindow.setInterval(function(){e.authWindowInterval()},100)},e.prototype.authWindowInterval=function(){this.isWindowOpen()?this.sendRequestMessage("ping"):(this.doneHandler(!1,"CancelledByUser",c.CancelledByUser),this.stopAuthWindowMonitor())},e.prototype.stopAuthWindowMonitor=function(){this.authWindowMonitor&&(this.hostWindow.clearInterval(this.authWindowMonitor),this.authWindowMonitor=void 0)},e.prototype.handleMessage=function(e){var t=this,n=e.data,i=this.authHandlers[n.func];if(i){var a=n.args;(a=n.args&&Array.isArray(n.args)?Object(l.cloneDeep)(n.args):[]).unshift(e);var o=i.apply(this,a);if(o){var r=function(e){t.processHandlerResultHelper(n,e)};"object"==typeof o&&"then"in o&&"function"==typeof o.then?o.then(r):r(o)}}},e.prototype.processHandlerResultHelper=function(e,t){var n=Array.isArray(t)?t:[t];this.sendResponseMessage(e.id,n)},e.prototype.postMessage=function(e){var t;this.authOrigin&&(null===(t=this.authWindow)||void 0===t||t.postMessage(e,this.authOrigin))},e.prototype.getContext=function(e,t,n){return function(){return null==n?void 0:n.getUser().then(function(n){var a,o,r,s,u;return Object(i.__assign)({hostClientType:e,loginHint:(null===(a=null==n?void 0:n.profile)||void 0===a?void 0:a.upn)||"",tid:(null===(o=null==n?void 0:n.profile)||void 0===o?void 0:o.tid)||"",upn:(null===(r=null==n?void 0:n.profile)||void 0===r?void 0:r.upn)||"",userObjectId:(null===(s=null==n?void 0:n.profile)||void 0===s?void 0:s.oid)||"",userPrincipalName:(null===(u=null==n?void 0:n.profile)||void 0===u?void 0:u.upn)||""},t)})}},e}(),x=function(){function e(e,t,n,a){var r=this;this.hostWindow=e,this.hostClientType=t,this.frameContext=n,this.telemetryService=a,this.handlers={},this.initialized=!1,this.removeMessageHandler=function(e){delete r.handlers[e]},this.initializeAuthenticationContext=function(e){var t;r.contextPromise=null===(t=r.authenticationService)||void 0===t?void 0:t.getUser().then(function(t){var n,a,o,s,u;return Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},r.getDefaultContext()),{loginHint:(null===(n=null==t?void 0:t.profile)||void 0===n?void 0:n.upn)||"",tid:(null===(a=null==t?void 0:t.profile)||void 0===a?void 0:a.tid)||"",upn:(null===(o=null==t?void 0:t.profile)||void 0===o?void 0:o.upn)||"",userObjectId:(null===(s=null==t?void 0:t.profile)||void 0===s?void 0:s.oid)||"",userPrincipalName:(null===(u=null==t?void 0:t.profile)||void 0===u?void 0:u.upn)||""}),e)})},this.initialize=function(e){return r.initialized=!0,[r.getFrameContext(),r.hostClientType]},this.getContext=function(){var e,t,n=null===(e=r.telemetryService)||void 0===e?void 0:e.createScenario("getContext",null===(t=r.appDefinition)||void 0===t?void 0:t.appId);try{return r.isInitialized()&&r.contextPromise?(null==n||n.stop(),r.contextPromise):(null==n||n.fail("SDK context is not initialized"),Promise.reject("SDK context is not initialized"))}catch(e){return null==n||n.fail("getContext Failed"),Promise.resolve({})}},this.handleNavigateCrossDomain=function(e,t){return r.load(t)},this.handleGetAuthToken=function(e,t){var n,i,a=null===(n=r.telemetryService)||void 0===n?void 0:n.createScenario("getAuthToken",null===(i=r.appDefinition)||void 0===i?void 0:i.appId);return r.getTabContext().then(function(n){return b(e.origin,t,r.appDefinition,n).then(function(e){return r.authenticationService?r.authenticationService.acquireToken(e[0]).then(function(e){return null==a||a.stop(),[!0,e.token]}):Promise.reject("No authentication service is available")})}).catch(function(){return null==a||a.fail("GetAuthToken failed"),[!1,"GetAuthToken failed"]})},this.handleAuthenticate=function(e,t){var n,i,a=null===(n=r.telemetryService)||void 0===n?void 0:n.createScenario("authenticationAuthenticate",null===(i=r.appDefinition)||void 0===i?void 0:i.appId),s=e.data.id,u=function(e,t,n){r.frame&&r.sendResponseMessage(r.frame,s,[e,t]),e?null==a||a.stop():null==a||a.fail("auth failed with reason "+n)};r.isInFrameContext(A.a.content,A.a.sidePanel,A.a.remove,A.a.settings,A.a.task)?r.appDefinition?new O(r.hostWindow,r.hostClientType,t,u,r.appDefinition).addMessageHandler(o.a.getContext,r.getContext):u(!1,"App definition not available",c.AppDefinitionUnavailable):u(!1,"Authentication API not supported in "+r.frameContext+" context",c.UnsupportedFrameContext)},this.handleOpenFilePreview=function(e,t,n,i,a,o,s,u,l,d,c,f){r.appDefinition&&(r.appDefinition.isFullTrustApp||g(r.appDefinition.appId,r.appDefinition.tenantId))&&r.hostWindow.open(o)},this.getTabContext=function(){return r.contextPromise?r.contextPromise.then(function(e){return e}).catch(function(){return r.getDefaultContext()}):Promise.resolve(r.getDefaultContext())},this.urlToLoad=function(e){return e},this.handleGetUser=function(){var e,t,n=null===(e=r.telemetryService)||void 0===e?void 0:e.createScenario("getUser",null===(t=r.appDefinition)||void 0===t?void 0:t.appId);return(r.authenticationService?Promise.resolve(r.authenticationService):Promise.reject("No authentication service is available")).then(function(e){return e.getUser().then(function(e){return e?(null==n||n.stop(),[!0,e.profile]):Promise.reject("Failed to fetch the user profile")}).catch(function(){return Promise.reject("Failed to fetch the user profile")})}).catch(function(){return null==n||n.fail("GetUser failed"),[!1,"GetUser failed"]})},this.isPlaceholderInUrlPart=function(e){return e===o.c.teamSiteDomain||e===o.c.teamSitePath||e===o.c.glassjarBaseUrl},this.getDefaultContext=function(){return{hostClientType:r.hostClientType,frameContext:r.getFrameContext()}},this.setupMessageHandlers=function(){r.addMessageHandler(o.a.getContext,r.getContext),r.addMessageHandler(o.a.navigateCrossDomain,r.handleNavigateCrossDomain),r.addMessageHandler(o.a.authentication.getAuthToken,r.handleGetAuthToken),r.addMessageHandler(o.a.authentication.getUser,r.handleGetUser),r.addMessageHandler(o.a.authentication.authenticate,r.handleAuthenticate),r.addMessageHandler(o.a.openFilePreview,r.handleOpenFilePreview)},this.setupMessageHandlers()}return e.prototype.isInitialized=function(){return this.initialized},e.prototype.addMessageHandler=function(e,t){this.handlers[e]=t},e.prototype.setFrameAndLoadOrigin=function(e,t,n){return this.appDefinition=n,this.frame=e,this.load(t)},e.prototype.sendRequestMessage=function(e,t){if(this.origin&&this.frame){var n={func:e,args:t};this.postMessage(this.frame,n)}},e.prototype.sendResponseMessage=function(e,t,n){if(this.origin){var i={id:t,args:n,origin:this.origin};this.postMessage(e,i)}},e.prototype.getFrameContext=function(){return this.frameContext},e.prototype.setAuthenticationService=function(e){this.authenticationService=e},e.prototype.postMessageToFrame=function(e){if(!this.frame)throw new Error("could not post message, frame is not defined");this.postMessage(this.frame,e)},e.prototype.handleMessage=function(e){var t=this,n=e.data,i=this.handlers[n.func||n.name];if(i){e.sendAsyncResponse=function(e){t.sendRequestMessage(e.func,e.args)},e.postMessageToFrame=function(e){t.postMessageToFrame(e)};var a=n.args;(a=n.args&&Array.isArray(n.args)?Object(l.cloneDeep)(n.args):[]).unshift(e);var o=i.apply(this,a);if(o){var r=function(e){t.processHandlerResultHelper(n,e)};"object"==typeof o&&"then"in o&&"function"==typeof o.then?o.then(r):r(o)}}},e.prototype.load=function(e){var t=this;return this.getTabContext().then(function(n){if(p(t.appDefinition,e,n)&&t.frame){var i=t.formatTabUrl(e,n);return t.origin=i,t.frame.src=f(t.urlToLoad(i)),Promise.resolve()}return Promise.reject("Url is invalid")})},e.prototype.formatTabUrl=function(e,t){if(t)for(var n in t)if(t.hasOwnProperty(n)){var i=new RegExp("{"+n+"}","g");e=this.isPlaceholderInUrlPart(n)?e.replace(i,t[n]):e.replace(i,encodeURIComponent(t[n]))}return e},e.prototype.processHandlerResultHelper=function(e,t){var n,i,a=e.id;if("object"==typeof t&&"target"in t){var o=t;n=o.target,i=o.args,void 0!==o.id&&null!==o.id&&(a=o.id)}else n=this.frame,i=Array.isArray(t)?t:[t];n&&this.sendResponseMessage(n,a,i)},e.prototype.isInFrameContext=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this.getFrameContext();if(n&&e)for(var i in e)if(n===e[i])return!0;return!1},e}(),C=function(e){function t(t,n,i,a){var o=e.call(this,t,n,i,a)||this;return o.onMessageReceived=function(e){if("webview-to-main-renderer-postmessage"===(e&&e.channel)){var t=e.target;if(o.frame===t){var n=e.args&&e.args[0];if(n){var i=e.args[1];n!==o.origin&&p(o.appDefinition,n)&&(o.origin=n),o.origin===n&&(i&&"iframeLoaded"===i.func||o.handleMessage({origin:n,data:i}))}}}},o.postMessage=function(e,t){e.send("main-renderer-to-webview-postmessage",t)},o.urlToLoad=function(e){return"https://teams.microsoft.com/iframe-container.html#iframeurl="+encodeURIComponent(e)+"&skipDomainValidation=true&multiwindow=true"},o}return Object(i.__extends)(t,e),t.prototype.setFrameAndLoadOrigin=function(t,n,i){return this.webviewEventListener=new M(t),this.webviewEventListener.addListener("ipc-message",this.onMessageReceived),e.prototype.setFrameAndLoadOrigin.call(this,t,n,i)},t}(x),S=function(e){function t(t,n,i,a){var o=e.call(this,t,n,i,a)||this;return o.onMessageReceived=function(e){if(o.frame&&o.frame.contentWindow===e.source){var t=e.origin;t!==o.origin&&p(o.appDefinition,t)&&(o.origin=e.origin),o.origin===t&&o.handleMessage(e)}},o.postMessage=function(e,t){o.origin&&(o.hostClientType===A.b.desktop?o.hostWindow.proxyPostMessage(e,t,o.origin):e.contentWindow&&e.contentWindow.postMessage(t,o.origin))},o.hostEventListener=new M(t),o.hostEventListener.addListener("message",o.onMessageReceived),o}return Object(i.__extends)(t,e),t}(x);n.d(t,"a",function(){return T});var T=function(e){var t,n,s,c=(t=e.hostWindow,n=e.hostType,s=e.frameContext,a.useMemo(function(){return n===d.a.webview?new C(t,A.b.desktop,s):new S(t,A.b.web,s)},[t,n,s]));return c.setAuthenticationService(e.authenticationService),c.initializeAuthenticationContext(e.appContext),c.addMessageHandler(o.a.initialize,c.initialize),e.messageHandlers&&Object(l.each)(e.messageHandlers,function(e){c&&c.addMessageHandler(e.messageName,e.handler)}),e.hostType===d.a.webview?a.createElement(r,Object(i.__assign)({},e,{sdkHost:c})):a.createElement(u,Object(i.__assign)({},e,{sdkHost:c}))}}}]);