var $jscomp={scope:{},getGlobal:function(e){return"undefined"!=typeof window&&window===e?e:"undefined"!=typeof global?global:e}};$jscomp.global=$jscomp.getGlobal(this),$jscomp.initSymbol=function(){$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol),$jscomp.initSymbol=function(){}},$jscomp.symbolCounter_=0,$jscomp.Symbol=function(e){return"jscomp_symbol_"+e+$jscomp.symbolCounter_++},$jscomp.initSymbolIterator=function(){$jscomp.initSymbol(),$jscomp.global.Symbol.iterator||($jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator")),$jscomp.initSymbolIterator=function(){}},$jscomp.makeIterator=function(e){if($jscomp.initSymbolIterator(),e[$jscomp.global.Symbol.iterator])return e[$jscomp.global.Symbol.iterator]();var t=0;return{next:function(){return t==e.length?{done:!0}:{done:!1,value:e[t++]}}}},$jscomp.arrayFromIterator=function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n},$jscomp.arrayFromIterable=function(e){return e instanceof Array?e:$jscomp.arrayFromIterator($jscomp.makeIterator(e))},$jscomp.inherits=function(e,t){function n(){}n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e;for(var r in t)if($jscomp.global.Object.defineProperties){var i=$jscomp.global.Object.getOwnPropertyDescriptor(t,r);i&&$jscomp.global.Object.defineProperty(e,r,i)}else e[r]=t[r]},$jscomp.array=$jscomp.array||{},$jscomp.array.done_=function(){return{done:!0,value:void 0}},$jscomp.array.arrayIterator_=function(e,t){e instanceof String&&(e=String(e));var n=0;$jscomp.initSymbol(),$jscomp.initSymbolIterator();var r={},i=(r.next=function(){if(n<e.length){var r=n++;return{value:t(r,e[r]),done:!1}}return i.next=$jscomp.array.done_,$jscomp.array.done_()},r[Symbol.iterator]=function(){return i},r);return i},$jscomp.array.findInternal_=function(e,t,n){e instanceof String&&(e=String(e));for(var r=e.length,i=0;i<r;i++){var o=e[i];if(t.call(n,o,i,e))return{i:i,v:o}}return{i:-1,v:void 0}},$jscomp.array.from=function(e,t,n){t=void 0===t?function(e){return e}:t;var r=[];if($jscomp.initSymbol(),$jscomp.initSymbolIterator(),e[Symbol.iterator]){$jscomp.initSymbol(),$jscomp.initSymbolIterator(),e=e[Symbol.iterator]();for(var i;!(i=e.next()).done;)r.push(t.call(n,i.value))}else{i=e.length;for(var o=0;o<i;o++)r.push(t.call(n,e[o]))}return r},$jscomp.array.of=function(e){for(var t=[],n=0;n<arguments.length;++n)t[n-0]=arguments[n];return $jscomp.array.from(t)},$jscomp.array.entries=function(){return $jscomp.array.arrayIterator_(this,function(e,t){return[e,t]})},$jscomp.array.entries$install=function(){Array.prototype.entries||(Array.prototype.entries=$jscomp.array.entries)},$jscomp.array.keys=function(){return $jscomp.array.arrayIterator_(this,function(e){return e})},$jscomp.array.keys$install=function(){Array.prototype.keys||(Array.prototype.keys=$jscomp.array.keys)},$jscomp.array.values=function(){return $jscomp.array.arrayIterator_(this,function(e,t){return t})},$jscomp.array.values$install=function(){Array.prototype.values||(Array.prototype.values=$jscomp.array.values)},$jscomp.array.copyWithin=function(e,t,n){var r=this.length;if(e=Number(e),t=Number(t),n=Number(null!=n?n:r),e<t)for(n=Math.min(n,r);t<n;)t in this?this[e++]=this[t++]:(delete this[e++],t++);else for(n=Math.min(n,r+t-e),e+=n-t;n>t;)--n in this?this[--e]=this[n]:delete this[e];return this},$jscomp.array.copyWithin$install=function(){Array.prototype.copyWithin||(Array.prototype.copyWithin=$jscomp.array.copyWithin)},$jscomp.array.fill=function(e,t,n){for(null!=n&&e.length||(n=this.length||0),n=Number(n),t=Number((void 0===t?0:t)||0);t<n;t++)this[t]=e;return this},$jscomp.array.fill$install=function(){Array.prototype.fill||(Array.prototype.fill=$jscomp.array.fill)},$jscomp.array.find=function(e,t){return $jscomp.array.findInternal_(this,e,t).v},$jscomp.array.find$install=function(){Array.prototype.find||(Array.prototype.find=$jscomp.array.find)},$jscomp.array.findIndex=function(e,t){return $jscomp.array.findInternal_(this,e,t).i},$jscomp.array.findIndex$install=function(){Array.prototype.findIndex||(Array.prototype.findIndex=$jscomp.array.findIndex)},$jscomp.Map=function(e){if(e=void 0===e?[]:e,this.data_={},this.head_=$jscomp.Map.createHead_(),this.size=0,e)for(var t=(e=$jscomp.makeIterator(e)).next();!t.done;t=e.next())t=t.value,this.set(t[0],t[1])},$jscomp.Map.checkBrowserConformance_=function(){var e=$jscomp.global.Map;if(!e||!e.prototype.entries||!Object.seal)return!1;try{var t=Object.seal({x:4}),n=new e($jscomp.makeIterator([[t,"s"]]));if("s"!=n.get(t)||1!=n.size||n.get({x:4})||n.set({x:4},"t")!=n||2!=n.size)return!1;var r=n.entries(),i=r.next();return!i.done&&i.value[0]==t&&"s"==i.value[1]&&!((i=r.next()).done||4!=i.value[0].x||"t"!=i.value[1]||!r.next().done)}catch(e){return!1}},$jscomp.Map.createHead_=function(){var e={};return e.previous=e.next=e.head=e},$jscomp.Map.getId_=function(e){return e instanceof Object?($jscomp.Map.key_ in e||e instanceof Object&&Object.isExtensible&&Object.isExtensible(e)&&$jscomp.Map.defineProperty_(e,$jscomp.Map.key_,++$jscomp.Map.index_),$jscomp.Map.key_ in e?e[$jscomp.Map.key_]:" "+e):String(e)},$jscomp.Map.prototype.set=function(e,t){var n=(i=this.maybeGetEntry_(e)).id,r=i.list,i=i.entry;return r||(r=this.data_[n]=[]),i?i.value=t:(i={next:this.head_,previous:this.head_.previous,head:this.head_,key:e,value:t},r.push(i),this.head_.previous.next=i,this.head_.previous=i,this.size++),this},$jscomp.Map.prototype.delete=function(e){var t=this.maybeGetEntry_(e);e=t.id;var n=t.list,r=t.index;return!(!(t=t.entry)||!n)&&(n.splice(r,1),n.length||delete this.data_[e],t.previous.next=t.next,t.next.previous=t.previous,t.head=null,this.size--,!0)},$jscomp.Map.prototype.clear=function(){this.data_={},this.head_=this.head_.previous=$jscomp.Map.createHead_(),this.size=0},$jscomp.Map.prototype.has=function(e){return!!this.maybeGetEntry_(e).entry},$jscomp.Map.prototype.get=function(e){return(e=this.maybeGetEntry_(e).entry)&&e.value},$jscomp.Map.prototype.maybeGetEntry_=function(e){var t=$jscomp.Map.getId_(e),n=this.data_[t];if(n)for(var r=0;r<n.length;r++){var i=n[r];if(e!==e&&i.key!==i.key||e===i.key)return{id:t,list:n,index:r,entry:i}}return{id:t,list:n,index:-1,entry:void 0}},$jscomp.Map.prototype.entries=function(){return this.iter_(function(e){return[e.key,e.value]})},$jscomp.Map.prototype.keys=function(){return this.iter_(function(e){return e.key})},$jscomp.Map.prototype.values=function(){return this.iter_(function(e){return e.value})},$jscomp.Map.prototype.forEach=function(e,t){for(var n=$jscomp.makeIterator(this.entries()),r=n.next();!r.done;r=n.next())r=r.value,e.call(t,r[1],r[0],this)},$jscomp.Map.prototype.iter_=function(e){var t=this,n=this.head_;$jscomp.initSymbol(),$jscomp.initSymbolIterator();var r={};return r.next=function(){if(n){for(;n.head!=t.head_;)n=n.previous;for(;n.next!=n.head;)return n=n.next,{done:!1,value:e(n)};n=null}return{done:!0,value:void 0}},r[Symbol.iterator]=function(){return this},r},$jscomp.Map.index_=0,$jscomp.Map.defineProperty_=Object.defineProperty?function(e,t,n){Object.defineProperty(e,t,{value:String(n)})}:function(e,t,n){e[t]=String(n)},$jscomp.Map.Entry_=function(){},$jscomp.Map.ASSUME_NO_NATIVE=!1,$jscomp.Map$install=function(){$jscomp.initSymbol(),$jscomp.initSymbolIterator(),!$jscomp.Map.ASSUME_NO_NATIVE&&$jscomp.Map.checkBrowserConformance_()?$jscomp.Map=$jscomp.global.Map:($jscomp.initSymbol(),$jscomp.initSymbolIterator(),$jscomp.Map.prototype[Symbol.iterator]=$jscomp.Map.prototype.entries,$jscomp.initSymbol(),$jscomp.Map.key_=Symbol("map-id-key")),$jscomp.Map$install=function(){}},$jscomp.math=$jscomp.math||{},$jscomp.math.clz32=function(e){if(0==(e=Number(e)>>>0))return 32;var t=0;return 0==(4294901760&e)&&(e<<=16,t+=16),0==(4278190080&e)&&(e<<=8,t+=8),0==(4026531840&e)&&(e<<=4,t+=4),0==(3221225472&e)&&(e<<=2,t+=2),0==(2147483648&e)&&t++,t},$jscomp.math.imul=function(e,t){var n=65535&(e=Number(e)),r=65535&(t=Number(t));return n*r+((e>>>16&65535)*r+n*(t>>>16&65535)<<16>>>0)|0},$jscomp.math.sign=function(e){return 0===(e=Number(e))||isNaN(e)?e:0<e?1:-1},$jscomp.math.log10=function(e){return Math.log(e)/Math.LN10},$jscomp.math.log2=function(e){return Math.log(e)/Math.LN2},$jscomp.math.log1p=function(e){if(.25>(e=Number(e))&&-.25<e){for(var t=e,n=1,r=e,i=0,o=1;i!=r;)t*=e,o*=-1,r=(i=r)+o*t/++n;return r}return Math.log(1+e)},$jscomp.math.expm1=function(e){if(.25>(e=Number(e))&&-.25<e){for(var t=e,n=1,r=e,i=0;i!=r;)t*=e/++n,r=(i=r)+t;return r}return Math.exp(e)-1},$jscomp.math.cosh=function(e){return e=Number(e),(Math.exp(e)+Math.exp(-e))/2},$jscomp.math.sinh=function(e){return 0===(e=Number(e))?e:(Math.exp(e)-Math.exp(-e))/2},$jscomp.math.tanh=function(e){if(0===(e=Number(e)))return e;var t=(1-(t=Math.exp(2*-Math.abs(e))))/(1+t);return 0>e?-t:t},$jscomp.math.acosh=function(e){return e=Number(e),Math.log(e+Math.sqrt(e*e-1))},$jscomp.math.asinh=function(e){if(0===(e=Number(e)))return e;var t=Math.log(Math.abs(e)+Math.sqrt(e*e+1));return 0>e?-t:t},$jscomp.math.atanh=function(e){return e=Number(e),($jscomp.math.log1p(e)-$jscomp.math.log1p(-e))/2},$jscomp.math.hypot=function(e,t,n){for(var r=[],i=2;i<arguments.length;++i)r[i-2]=arguments[i];e=Number(e),t=Number(t);for(var o=Math.max(Math.abs(e),Math.abs(t)),a=$jscomp.makeIterator(r),i=a.next();!i.done;i=a.next())o=Math.max(o,Math.abs(i.value));if(1e100<o||1e-100>o){for(a=(e/=o)*e+(t/=o)*t,i=(r=$jscomp.makeIterator(r)).next();!i.done;i=r.next())i=i.value,i=Number(i)/o,a+=i*i;return Math.sqrt(a)*o}for(o=e*e+t*t,i=(r=$jscomp.makeIterator(r)).next();!i.done;i=r.next())i=i.value,i=Number(i),o+=i*i;return Math.sqrt(o)},$jscomp.math.trunc=function(e){if(e=Number(e),isNaN(e)||1/0===e||-1/0===e||0===e)return e;var t=Math.floor(Math.abs(e));return 0>e?-t:t},$jscomp.math.cbrt=function(e){if(0===e)return e;e=Number(e);var t=Math.pow(Math.abs(e),1/3);return 0>e?-t:t},$jscomp.number=$jscomp.number||{},$jscomp.number.isFinite=function(e){return"number"==typeof e&&(!isNaN(e)&&1/0!==e&&-1/0!==e)},$jscomp.number.isInteger=function(e){return!!$jscomp.number.isFinite(e)&&e===Math.floor(e)},$jscomp.number.isNaN=function(e){return"number"==typeof e&&isNaN(e)},$jscomp.number.isSafeInteger=function(e){return $jscomp.number.isInteger(e)&&Math.abs(e)<=$jscomp.number.MAX_SAFE_INTEGER},$jscomp.number.EPSILON=Math.pow(2,-52),$jscomp.number.MAX_SAFE_INTEGER=9007199254740991,$jscomp.number.MIN_SAFE_INTEGER=-9007199254740991,$jscomp.object=$jscomp.object||{},$jscomp.object.assign=function(e,t){for(var n=[],r=1;r<arguments.length;++r)n[r-1]=arguments[r];for(r=(n=$jscomp.makeIterator(n)).next();!r.done;r=n.next())if(r=r.value)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i]);return e},$jscomp.object.is=function(e,t){return e===t?0!==e||1/e==1/t:e!==e&&t!==t},$jscomp.Set=function(e){if(e=void 0===e?[]:e,this.map_=new $jscomp.Map,e)for(var t=(e=$jscomp.makeIterator(e)).next();!t.done;t=e.next())this.add(t.value);this.size=this.map_.size},$jscomp.Set.checkBrowserConformance_=function(){var e=$jscomp.global.Set;if(!e||!e.prototype.entries||!Object.seal)return!1;var t=Object.seal({x:4});if((e=new e($jscomp.makeIterator([t]))).has(t)||1!=e.size||e.add(t)!=e||1!=e.size||e.add({x:4})!=e||2!=e.size)return!1;var n=(e=e.entries()).next();return!n.done&&n.value[0]==t&&n.value[1]==t&&(!(n=e.next()).done&&n.value[0]!=t&&4==n.value[0].x&&n.value[1]==n.value[0]&&e.next().done)},$jscomp.Set.prototype.add=function(e){return this.map_.set(e,e),this.size=this.map_.size,this},$jscomp.Set.prototype.delete=function(e){return e=this.map_.delete(e),this.size=this.map_.size,e},$jscomp.Set.prototype.clear=function(){this.map_.clear(),this.size=0},$jscomp.Set.prototype.has=function(e){return this.map_.has(e)},$jscomp.Set.prototype.entries=function(){return this.map_.entries()},$jscomp.Set.prototype.values=function(){return this.map_.values()},$jscomp.Set.prototype.forEach=function(e,t){var n=this;this.map_.forEach(function(r){return e.call(t,r,r,n)})},$jscomp.Set.ASSUME_NO_NATIVE=!1,$jscomp.Set$install=function(){!$jscomp.Set.ASSUME_NO_NATIVE&&$jscomp.Set.checkBrowserConformance_()?$jscomp.Set=$jscomp.global.Set:($jscomp.Map$install(),$jscomp.initSymbol(),$jscomp.initSymbolIterator(),$jscomp.Set.prototype[Symbol.iterator]=$jscomp.Set.prototype.values),$jscomp.Set$install=function(){}},$jscomp.string=$jscomp.string||{},$jscomp.string.noRegExp_=function(e,t){if(e instanceof RegExp)throw new TypeError("First argument to String.prototype."+t+" must not be a regular expression")},$jscomp.string.fromCodePoint=function(e){for(var t=[],n=0;n<arguments.length;++n)t[n-0]=arguments[n];for(var n="",r=(t=$jscomp.makeIterator(t)).next();!r.done;r=t.next()){if(r=r.value,0>(r=+r)||1114111<r||r!==Math.floor(r))throw new RangeError("invalid_code_point "+r);65535>=r?n+=String.fromCharCode(r):(r-=65536,n+=String.fromCharCode(r>>>10&1023|55296),n+=String.fromCharCode(1023&r|56320))}return n},$jscomp.string.repeat=function(e){var t=this.toString();if(0>e||1342177279<e)throw new RangeError("Invalid count value");e|=0;for(var n="";e;)1&e&&(n+=t),(e>>>=1)&&(t+=t);return n},$jscomp.string.repeat$install=function(){String.prototype.repeat||(String.prototype.repeat=$jscomp.string.repeat)},$jscomp.string.codePointAt=function(e){var t=this.toString(),n=t.length;if(0<=(e=Number(e)||0)&&e<n){e|=0;var r=t.charCodeAt(e);return 55296>r||56319<r||e+1===n?r:56320>(e=t.charCodeAt(e+1))||57343<e?r:1024*(r-55296)+e+9216}},$jscomp.string.codePointAt$install=function(){String.prototype.codePointAt||(String.prototype.codePointAt=$jscomp.string.codePointAt)},$jscomp.string.includes=function(e,t){return t=void 0===t?0:t,$jscomp.string.noRegExp_(e,"includes"),-1!==this.toString().indexOf(e,t)},$jscomp.string.includes$install=function(){String.prototype.includes||(String.prototype.includes=$jscomp.string.includes)},$jscomp.string.startsWith=function(e,t){t=void 0===t?0:t,$jscomp.string.noRegExp_(e,"startsWith");var n=this.toString();e+="";for(var r=n.length,i=e.length,o=Math.max(0,Math.min(0|t,n.length)),a=0;a<i&&o<r;)if(n[o++]!=e[a++])return!1;return a>=i},$jscomp.string.startsWith$install=function(){String.prototype.startsWith||(String.prototype.startsWith=$jscomp.string.startsWith)},$jscomp.string.endsWith=function(e,t){$jscomp.string.noRegExp_(e,"endsWith");var n=this.toString();e+="",void 0===t&&(t=n.length);for(var r=Math.max(0,Math.min(0|t,n.length)),i=e.length;0<i&&0<r;)if(n[--r]!=e[--i])return!1;return 0>=i},$jscomp.string.endsWith$install=function(){String.prototype.endsWith||(String.prototype.endsWith=$jscomp.string.endsWith)};var __extends=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),__awaiter=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}c((r=r.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,o&&(a=2&n[0]?o.return:n[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,n[1])).done)return a;switch(o=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,o=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(a=c.trys,!(a=0<a.length&&a[a.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3]))c.label=n[1];else if(6===n[0]&&c.label<a[1])c.label=a[1],a=n;else{if(!(a&&c.label<a[2])){a[2]&&c.ops.pop(),c.trys.pop();continue}c.label=a[2],c.ops.push(n)}}n=t.call(e,c)}catch(e){n=[6,e],o=0}finally{i=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,o,a,s,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return $jscomp.initSymbol(),$jscomp.initSymbol(),$jscomp.initSymbolIterator(),s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};define("logger",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.tracing=!1,this.mslogger_=void 0,this.tag=e,this.enabled=!0}return e.prototype.setMSLogger=function(e){this.mslogger_=e},e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&(void 0!=this.mslogger_?this.mslogger_.info(this.tag+" "+e):console.log(this.tag+" "+e))},e.prototype.trace=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.tracing&&this.log.apply(this,e)},e}();t.Logger=n,t.logger=new n("[HdxWebRTC.js]"),t.logger.enabled=!0}),define("util",["require","exports","logger"],function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),e=function(){function e(){}return e.stringifyArray=function(e){for(var t="[",n=0;n<e.length;++n)0!=n&&(t+=","),t+=this.stringify(e[n]);return t+"]"},e.stringifyObject=function(e){var t,n="{",r=!0;for(t in e)r?r=!1:n+=",",n=n+'"'+t+'":',n=e[t]instanceof Array?n+this.stringifyArray(e[t]):"object"==typeof e[t]?n+this.stringifyObject(e[t]):n+JSON.stringify(e[t]);return n+"}"},e.stringify=function(e){return"object"==typeof e?"[object Array]"==Object.prototype.toString.call(e)?this.stringifyArray(e):this.stringifyObject(e):JSON.stringify(e)},e.GetObjectPropertyDescriptor=function(e,t){for(var n=void 0;e!=Object.prototype&&void 0===(n=Object.getOwnPropertyDescriptor(e,t));)e=e.__proto__;return n},e.sendEvent=function(e,t){try{var r=document.createEvent("Event");r.initEvent(t,!0,!0),e.dispatchEvent(r)}catch(e){n.logger.log('sendEvent(): exception dispatching "'+t+'" event: '+e.message)}},e}(),t.Util=e}),define("webrpcclassinfo",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.HDXMS_VERSION="1.7.0.0";w=function(e,t,n,r){this.major=e,this.minor=t,this.revision=n,this.build=r};t.VersionData=w;n=function(){};t.FeatureData=n;var n=function(e,t){this.fature=e,this.version=t},r=function(e,t,n,r,i){this.family=e,this.version=t,this.architecture=n,this.distro=r,this.edition=i};t.OSInfo=r,r=function(e,t){this.machine=e,this.user=t},t.SessionIdentifier=r,t.FEATURE_ms_teams_redirection="ms_teams_redirection",t.FEATURE_ms_teams_desktop_sharing="ms_teams_desktop_sharing",t.FEATURE_ms_teams_speaking_indicator="ms_teams_speaking_indicator",t.FEATURE_ms_teams_common_media_constraints="ms_teams_common_media_constraints",t.FEATURE_ms_teams_1911="ms_teams_1911",t.FEATURE_ms_teams_pstn="ms_teams_pstn",t.FEATURE_ms_teams_1912="ms_teams_1912",t.FEATURE_ms_teams_mstrack_constraints="ms_teams_mstrack_constraints",t.FEATURE_ms_teams_osinfo="ms_teams_osinfo",t.FEATURE_ms_teams_sessionidentifier="ms_teams_sessionidentifier",t.FEATURE_ms_teams_remote_audio_notifications="ms_teams_remote_audio_notifications",new n(t.FEATURE_ms_teams_redirection,new w(1,1,0,0)),new n(t.FEATURE_ms_teams_desktop_sharing,new w(1,2,0,0)),new n(t.FEATURE_ms_teams_speaking_indicator,new w(1,2,0,0)),new n(t.FEATURE_ms_teams_common_media_constraints,new w(1,4,0,0)),new n(t.FEATURE_ms_teams_1911,new w(1,4,0,0)),new n(t.FEATURE_ms_teams_1912,new w(1,5,0,0)),new n(t.FEATURE_ms_teams_mstrack_constraints,new w(1,6,0,0)),new n(t.FEATURE_ms_teams_pstn,new w(1,6,0,0)),new n(t.FEATURE_ms_teams_osinfo,new w(1,7,0,0)),new n(t.FEATURE_ms_teams_sessionidentifier,new w(1,7,0,0)),new n(t.FEATURE_ms_teams_remote_audio_notifications,new w(1,7,0,0)),t.FEATURE_public_screenshare="screenshare",t.FEATURE_public_redirection="redirection",t.FEATURE_public_speaking_indicator="speaking_indicator",t.FEATURE_public_pstn="pstn",t.FEATURE_public_osinfo="osinfo",t.FEATURE_public_sessionidentifier="sessionidentifier",t.FEATURE_public_remote_audio_notifications="remoteAudioNotifications",t.featureNameMap={},t.featureNameMap[t.FEATURE_public_screenshare]=[t.FEATURE_ms_teams_desktop_sharing],t.featureNameMap[t.FEATURE_public_redirection]=[t.FEATURE_ms_teams_redirection],t.featureNameMap[t.FEATURE_public_speaking_indicator]=[t.FEATURE_ms_teams_speaking_indicator],t.featureNameMap[t.FEATURE_public_pstn]=[t.FEATURE_ms_teams_pstn],t.featureNameMap[t.FEATURE_public_osinfo]=[t.FEATURE_ms_teams_osinfo],t.featureNameMap[t.FEATURE_public_sessionidentifier]=[t.FEATURE_ms_teams_sessionidentifier],t.featureNameMap[t.FEATURE_public_remote_audio_notifications]=[t.FEATURE_ms_teams_remote_audio_notifications],function(e){e[e.EngineControl=0]="EngineControl",e[e.RTCPeerConnection=1]="RTCPeerConnection",e[e.RTCSessionDescription=2]="RTCSessionDescription",e[e.RTCIceCandidate=3]="RTCIceCandidate",e[e.RTCIceCandidateEvent=4]="RTCIceCandidateEvent",e[e.MediaDevices=5]="MediaDevices",e[e.MediaDeviceInfo=6]="MediaDeviceInfo",e[e.MediaStreamTrack=7]="MediaStreamTrack",e[e.MediaStreamEvent=8]="MediaStreamEvent",e[e.MediaStream=9]="MediaStream",e[e.NavigatorUserMedia=10]="NavigatorUserMedia",e[e.VideoElement=11]="VideoElement",e[e.AudioElement=12]="AudioElement",e[e.RTCRtpReceiver=13]="RTCRtpReceiver",e[e.RTCRtpSender=14]="RTCRtpSender",e[e.RTCDtlsTransport=15]="RTCDtlsTransport",e[e.RTCIceTransport=16]="RTCIceTransport",e[e.RTCDTMFSender=17]="RTCDTMFSender",e[e.RTCDTMFToneChangeEvent=18]="RTCDTMFToneChangeEvent",e[e.RTCIceCandidatePair=19]="RTCIceCandidatePair",e[e.RTCRtpTransceiver=20]="RTCRtpTransceiver"}(w=t.class_id_t||(t.class_id_t={})),function(e){e[e.ctor=0]="ctor",e[e.version=1]="version",e[e.feature_flags=2]="feature_flags",e[e.version_info=3]="version_info",e[e.osinfo=4]="osinfo",e[e.session_identifier=5]="session_identifier"}(n=t.method_id_EngineControl_t||(t.method_id_EngineControl_t={})),function(e){e[e.ctor=0]="ctor",e[e.localDescription=1]="localDescription",e[e.remoteDescription=2]="remoteDescription",e[e.readyState=3]="readyState",e[e.iceState=4]="iceState",e[e.localStreams=5]="localStreams",e[e.remoteStreams=6]="remoteStreams",e[e.createOffer=7]="createOffer",e[e.createAnswer=8]="createAnswer",e[e.setLocalDescription=9]="setLocalDescription",e[e.setRemoteDescription=10]="setRemoteDescription",e[e.updateIce=11]="updateIce",e[e.addIceCandidate=12]="addIceCandidate",e[e.addStream=13]="addStream",e[e.removeStream=14]="removeStream",e[e.close=15]="close",e[e.iceConnectionState=16]="iceConnectionState",e[e.iceGatheringState=17]="iceGatheringState",e[e.signalingState=18]="signalingState",e[e.onaddstream=19]="onaddstream",e[e.onicecandidate=20]="onicecandidate",e[e.oniceconnectionstatechange=21]="oniceconnectionstatechange",e[e.onicegatheringstatechange=22]="onicegatheringstatechange",e[e.onsignalingstatechange=23]="onsignalingstatechange",e[e.onnegotiationneeded=24]="onnegotiationneeded",e[e.onremovestream=25]="onremovestream",e[e.getStats=26]="getStats",e[e.getReceivers=27]="getReceivers",e[e.getSenders=28]="getSenders",e[e.addTrack=29]="addTrack",e[e.removeTrack=30]="removeTrack",e[e.ontrack=31]="ontrack"}(r=t.method_id_RTCPeerConnection_t||(t.method_id_RTCPeerConnection_t={}));var i;!function(e){e[e.ctor=0]="ctor",e[e.enumerateDevices=1]="enumerateDevices",e[e.getDisplayMedia=2]="getDisplayMedia",e[e.ondevicechange=3]="ondevicechange"}(i=t.method_id_MediaDevices_t||(t.method_id_MediaDevices_t={}));var o;!function(e){e[e.ctor=0]="ctor",e[e.deviceId=1]="deviceId",e[e.kind=2]="kind",e[e.label=3]="label",e[e.groupId=4]="groupId"}(o=t.method_id_MediaDeviceInfo_t||(t.method_id_MediaDeviceInfo_t={}));var a;!function(e){e[e.ctor=0]="ctor",e[e.type=1]="type",e[e.sdp=2]="sdp"}(a=t.method_id_RTCSessionDescription_t||(t.method_id_RTCSessionDescription_t={}));var s;!function(e){e[e.ctor=0]="ctor",e[e.kind=1]="kind",e[e.id=2]="id",e[e.label=3]="label",e[e.enabled=4]="enabled",e[e.muted=5]="muted",e[e.readyState=6]="readyState",e[e.onended=7]="onended",e[e.onmute=8]="onmute",e[e.onunmute=9]="onunmute",e[e.clone=10]="clone",e[e.stop=11]="stop",e[e.getCapabilities=12]="getCapabilities",e[e.getSettings=13]="getSettings",e[e.applyConstraints=14]="applyConstraints",e[e.getConstraints=15]="getConstraints"}(s=t.method_id_MediaStreamTrack_t||(t.method_id_MediaStreamTrack_t={}));var c;!function(e){e[e.ctor=0]="ctor",e[e.id=1]="id",e[e.getAudioTracks=2]="getAudioTracks",e[e.getVideoTracks=3]="getVideoTracks",e[e.getTracks=4]="getTracks",e[e.getTrackById=5]="getTrackById",e[e.addTrack=6]="addTrack",e[e.removeTrack=7]="removeTrack",e[e.clone=8]="clone",e[e.active=9]="active"}(c=t.method_id_MediaStream_t||(t.method_id_MediaStream_t={}));var d;!function(e){e[e.ctor=0]="ctor",e[e.getUserMedia=1]="getUserMedia"}(d=t.method_id_NavigatorUserMedia_t||(t.method_id_NavigatorUserMedia_t={}));var l;!function(e){e[e.ctor=0]="ctor",e[e.candidate=1]="candidate",e[e.sdpMid=2]="sdpMid",e[e.sdpMLineIndex=3]="sdpMLineIndex"}(l=t.method_id_RTCIceCandidate_t||(t.method_id_RTCIceCandidate_t={}));var u;!function(e){e[e.ctor=0]="ctor",e[e.candidate=1]="candidate"}(u=t.method_id_RTCIceCandidateEvent_t||(t.method_id_RTCIceCandidateEvent_t={}));var g;!function(e){e[e.ctor=0]="ctor",e[e.stream=1]="stream"}(g=t.method_id_MediaStreamEvent_t||(t.method_id_MediaStreamEvent_t={}));var _;!function(e){e[e.ctor=0]="ctor",e[e.sinkId=1]="sinkId",e[e.connectTo=2]="connectTo",e[e.disconnect=3]="disconnect",e[e.setFrame=4]="setFrame",e[e.addClipRect=5]="addClipRect",e[e.removeClipRect=6]="removeClipRect",e[e.onerror=7]="onerror",e[e.onvideoframechanged=8]="onvideoframechanged"}(_=t.method_id_VideoElement_t||(t.method_id_VideoElement_t={}));var h;!function(e){e[e.ctor=0]="ctor",e[e.sinkId=1]="sinkId",e[e.srcObject=2]="srcObject",e[e.src=3]="src",e[e.play=4]="play",e[e.pause=5]="pause"}(h=t.method_id_AudioElement_t||(t.method_id_AudioElement_t={}));var m;!function(e){e[e.ctor=0]="ctor",e[e.track=1]="track",e[e.getContributingSources=2]="getContributingSources",e[e.getSynchronizationSources=3]="getSynchronizationSources",e[e.transport=4]="transport",e[e.rtcpTransport=5]="rtcpTransport",e[e.getCapabilities=6]="getCapabilities",e[e.getParameters=7]="getParameters",e[e.getStats=8]="getStats"}(m=t.method_id_RTCRtpReceiver_t||(t.method_id_RTCRtpReceiver_t={}));var f;!function(e){e[e.ctor=0]="ctor",e[e.track=1]="track",e[e.transport=2]="transport",e[e.rtcpTransport=3]="rtcpTransport",e[e.dtmf=4]="dtmf",e[e.getCapabilities=5]="getCapabilities",e[e.getParameters=6]="getParameters",e[e.setParameters=7]="setParameters",e[e.replaceTrack=8]="replaceTrack",e[e.getStats=9]="getStats",e[e.setStreams=10]="setStreams"}(f=t.method_id_RTCRtpSender_t||(t.method_id_RTCRtpSender_t={}));var p;!function(e){e[e.ctor=0]="ctor",e[e.transport=1]="transport",e[e.state=2]="state",e[e.getRemoteCertificates=3]="getRemoteCertificates",e[e.onstatechange=4]="onstatechange",e[e.onerror=5]="onerror"}(p=t.method_id_RTCDtlsTransport_t||(t.method_id_RTCDtlsTransport_t={}));var y;!function(e){e[e.ctor=0]="ctor",e[e.role=1]="role",e[e.component=2]="component",e[e.state=3]="state",e[e.gatheringState=4]="gatheringState",e[e.localcandidates=5]="localcandidates",e[e.remotecandidates=6]="remotecandidates",e[e.onstatechange=7]="onstatechange",e[e.ongatheringstatechange=8]="ongatheringstatechange",e[e.onselectedcandidatepairchange=9]="onselectedcandidatepairchange"}(y=t.method_id_RTCIceTransport_t||(t.method_id_RTCIceTransport_t={}));var v;!function(e){e[e.ctor=0]="ctor",e[e.insertDTMF=1]="insertDTMF",e[e.ontonechange=2]="ontonechange",e[e.canInsertDTMF=3]="canInsertDTMF",e[e.toneBuffer=4]="toneBuffer"}(v=t.method_id_RTCDTMFSender_t||(t.method_id_RTCDTMFSender_t={}));var C;!function(e){e[e.ctor=0]="ctor",e[e.tone=1]="tone",e[e.tone_buffer=2]="tone_buffer"}(C=t.method_id_RTCDTMFToneChangeEvent_t||(t.method_id_RTCDTMFToneChangeEvent_t={}));var b;!function(e){e[e.ctor=0]="ctor",e[e.local=1]="local",e[e.remote=2]="remote"}(b=t.method_id_RTCIceCandidatePair_t||(t.method_id_RTCIceCandidatePair_t={}));var T;!function(e){e[e.ctor=0]="ctor",e[e.mid=1]="mid",e[e.sender=2]="sender",e[e.receiver=3]="receiver",e[e.direction=4]="direction",e[e.currentDirection=5]="currentDirection",e[e.stop=6]="stop",e[e.setCodecPreferences=7]="setCodecPreferences"}(T=t.method_id_RTCRtpTransceiver_t||(t.method_id_RTCRtpTransceiver_t={}));var S=function(e,n,r,i,o){void 0===o&&(o=t.FEATURE_ms_teams_redirection),this.iid=e,this.mid=n,this.name=r,this.isprop=i,this.feature=o};t.WebrpcMethodInfo=S;var R=function(e,t,n){this.id=e,this.name=t,this.methods=n};t.WebrpcClassInfo=R;var k=new function(e,t){this.name=e,this.classes=t}("msteams_class_library",[new R(w.EngineControl,"EngineControl",[new S(w.EngineControl,n.ctor,"ctor",!1),new S(w.EngineControl,n.version,"version",!0),new S(w.EngineControl,n.feature_flags,"feature_flags",!0),new S(w.EngineControl,n.version_info,"version_info",!0,t.FEATURE_ms_teams_desktop_sharing),new S(w.EngineControl,n.osinfo,"osinfo",!0,t.FEATURE_ms_teams_osinfo),new S(w.EngineControl,n.session_identifier,"session_identifier",!0,t.FEATURE_ms_teams_sessionidentifier)]),new R(w.RTCPeerConnection,"RTCPeerConnection",[new S(w.RTCPeerConnection,r.ctor,"ctor",!1),new S(w.RTCPeerConnection,r.localDescription,"localDescription",!0),new S(w.RTCPeerConnection,r.remoteDescription,"remoteDescription",!0),new S(w.RTCPeerConnection,r.readyState,"readyState",!0),new S(w.RTCPeerConnection,r.iceState,"iceState",!0),new S(w.RTCPeerConnection,r.localStreams,"localStreams",!0),new S(w.RTCPeerConnection,r.remoteStreams,"remoteStreams",!0),new S(w.RTCPeerConnection,r.createOffer,"createOffer",!1),new S(w.RTCPeerConnection,r.createAnswer,"createAnswer",!1),new S(w.RTCPeerConnection,r.setLocalDescription,"setLocalDescription",!1),new S(w.RTCPeerConnection,r.setRemoteDescription,"setRemoteDescription",!1),new S(w.RTCPeerConnection,r.updateIce,"updateIce",!0),new S(w.RTCPeerConnection,r.addIceCandidate,"addIceCandidate",!0),new S(w.RTCPeerConnection,r.addStream,"addStream",!0),new S(w.RTCPeerConnection,r.removeStream,"removeStream",!0),new S(w.RTCPeerConnection,r.close,"close",!0),new S(w.RTCPeerConnection,r.iceConnectionState,"iceConnectionState",!0),new S(w.RTCPeerConnection,r.iceGatheringState,"iceGatheringState",!0),new S(w.RTCPeerConnection,r.signalingState,"signalingState",!0),new S(w.RTCPeerConnection,r.onaddstream,"onaddstream",!0),new S(w.RTCPeerConnection,r.onicecandidate,"onicecandidate",!0),new S(w.RTCPeerConnection,r.oniceconnectionstatechange,"oniceconnectionstatechange",!0),new S(w.RTCPeerConnection,r.onicegatheringstatechange,"onicegatheringstatechange",!0),new S(w.RTCPeerConnection,r.onsignalingstatechange,"onsignalingstatechange",!0),new S(w.RTCPeerConnection,r.onnegotiationneeded,"onnegotiationneeded",!0),new S(w.RTCPeerConnection,r.onremovestream,"onremovestream",!0),new S(w.RTCPeerConnection,r.getStats,"getStats",!1),new S(w.RTCPeerConnection,r.getReceivers,"getReceivers",!1,t.FEATURE_ms_teams_speaking_indicator),new S(w.RTCPeerConnection,r.getSenders,"getSenders",!1,t.FEATURE_ms_teams_pstn),new S(w.RTCPeerConnection,r.addTrack,"addTrack",!1,t.FEATURE_ms_teams_pstn),new S(w.RTCPeerConnection,r.removeTrack,"removeTrack",!1,t.FEATURE_ms_teams_pstn),new S(w.RTCPeerConnection,r.ontrack,"ontrack",!0,t.FEATURE_ms_teams_pstn)]),new R(w.RTCSessionDescription,"RTCSessionDescription",[new S(w.RTCSessionDescription,a.ctor,"ctor",!1),new S(w.RTCSessionDescription,a.type,"type",!0),new S(w.RTCSessionDescription,a.sdp,"sdp",!0)]),new R(w.RTCIceCandidate,"RTCIceCandidate",[new S(w.RTCIceCandidate,l.ctor,"ctor",!1),new S(w.RTCIceCandidate,l.candidate,"candidate",!0),new S(w.RTCIceCandidate,l.sdpMid,"sdpMid",!0),new S(w.RTCIceCandidate,l.sdpMLineIndex,"sdpMLineIndex",!0)]),new R(w.RTCIceCandidateEvent,"RTCIceCandidateEvent",[new S(w.RTCIceCandidateEvent,u.ctor,"ctor",!1),new S(w.RTCIceCandidateEvent,u.candidate,"candidate",!0)]),new R(w.MediaDevices,"MediaDevices",[new S(w.MediaDevices,i.ctor,"ctor",!1),new S(w.MediaDevices,i.enumerateDevices,"enumerateDevices",!1),new S(w.MediaDevices,i.getDisplayMedia,"getDisplayMedia",!1,t.FEATURE_ms_teams_desktop_sharing),new S(w.MediaDevices,i.ondevicechange,"ondevicechange",!0,t.FEATURE_ms_teams_speaking_indicator)]),new R(w.MediaDeviceInfo,"MediaDeviceInfo",[new S(w.MediaDeviceInfo,o.ctor,"ctor",!1),new S(w.MediaDeviceInfo,o.deviceId,"deviceId",!0),new S(w.MediaDeviceInfo,o.kind,"kind",!0),new S(w.MediaDeviceInfo,o.label,"label",!0),new S(w.MediaDeviceInfo,o.groupId,"groupId",!0)]),new R(w.MediaStreamTrack,"MediaStreamTrack",[new S(w.MediaStreamTrack,s.ctor,"ctor",!1),new S(w.MediaStreamTrack,s.clone,"clone",!1),new S(w.MediaStreamTrack,s.stop,"stop",!1),new S(w.MediaStreamTrack,s.getCapabilities,"getCapabilities",!1),new S(w.MediaStreamTrack,s.getSettings,"getSettings",!1),new S(w.MediaStreamTrack,s.applyConstraints,"applyConstraints",!1,t.FEATURE_ms_teams_desktop_sharing),new S(w.MediaStreamTrack,s.kind,"kind",!0),new S(w.MediaStreamTrack,s.id,"id",!0),new S(w.MediaStreamTrack,s.label,"label",!0),new S(w.MediaStreamTrack,s.enabled,"enabled",!0),new S(w.MediaStreamTrack,s.muted,"muted",!0),new S(w.MediaStreamTrack,s.readyState,"readyState",!0),new S(w.MediaStreamTrack,s.onended,"onended",!0),new S(w.MediaStreamTrack,s.onmute,"onmute",!0),new S(w.MediaStreamTrack,s.onunmute,"onunmute",!0),new S(w.MediaStreamTrack,s.getConstraints,"getConstraints",!1,t.FEATURE_ms_teams_mstrack_constraints)]),new R(w.MediaStream,"MediaStream",[new S(w.MediaStream,c.ctor,"ctor",!1),new S(w.MediaStream,c.id,"id",!0),new S(w.MediaStream,c.getAudioTracks,"getAudioTracks",!1),new S(w.MediaStream,c.getVideoTracks,"getVideoTracks",!1),new S(w.MediaStream,c.getTracks,"getTracks",!1),new S(w.MediaStream,c.getTrackById,"getTrackById",!1),new S(w.MediaStream,c.addTrack,"addTrack",!1),new S(w.MediaStream,c.removeTrack,"removeTrack",!1),new S(w.MediaStream,c.clone,"clone",!0),new S(w.MediaStream,c.active,"active",!0)]),new R(w.NavigatorUserMedia,"NavigatorUserMedia",[new S(w.NavigatorUserMedia,d.ctor,"ctor",!1),new S(w.NavigatorUserMedia,d.getUserMedia,"getUserMedia",!1)]),new R(w.MediaStreamEvent,"MediaStreamEvent",[new S(w.MediaStreamEvent,g.ctor,"ctor",!1),new S(w.MediaStreamEvent,g.stream,"stream",!0)]),new R(w.VideoElement,"VideoElement",[new S(w.VideoElement,_.ctor,"ctor",!1),new S(w.VideoElement,_.sinkId,"sinkId",!0),new S(w.VideoElement,_.connectTo,"connectTo",!1),new S(w.VideoElement,_.disconnect,"disconnect",!1),new S(w.VideoElement,_.setFrame,"setFrame",!1),new S(w.VideoElement,_.addClipRect,"addClipRect",!1),new S(w.VideoElement,_.removeClipRect,"removeClipRect",!1),new S(w.VideoElement,_.onerror,"onerror",!0),new S(w.VideoElement,_.onvideoframechanged,"onvideoframechanged",!0)]),new R(w.AudioElement,"AudioElement",[new S(w.AudioElement,h.ctor,"ctor",!1),new S(w.AudioElement,h.sinkId,"sinkId",!0),new S(w.AudioElement,h.srcObject,"srcObject",!0),new S(w.AudioElement,h.src,"src",!0),new S(w.AudioElement,h.play,"play",!1),new S(w.AudioElement,h.pause,"pause",!1)]),new R(w.RTCRtpReceiver,"RTCRtpReceiver",[new S(w.RTCRtpReceiver,m.ctor,"ctor",!1,t.FEATURE_ms_teams_speaking_indicator),new S(w.RTCRtpReceiver,m.track,"track",!0,t.FEATURE_ms_teams_speaking_indicator),new S(w.RTCRtpReceiver,m.getContributingSources,"getContributingSources",!1,t.FEATURE_ms_teams_speaking_indicator),new S(w.RTCRtpReceiver,m.getSynchronizationSources,"getSynchronizationSources",!1,t.FEATURE_ms_teams_pstn),new S(w.RTCRtpReceiver,m.transport,"transport",!0,t.FEATURE_ms_teams_pstn),new S(w.RTCRtpReceiver,m.rtcpTransport,"rtcptransport",!0,t.FEATURE_ms_teams_pstn),new S(w.RTCRtpReceiver,m.getCapabilities,"getCapabilities",!1,t.FEATURE_ms_teams_pstn),new S(w.RTCRtpReceiver,m.getParameters,"getParameters",!1,t.FEATURE_ms_teams_pstn),new S(w.RTCRtpReceiver,m.getStats,"getStats",!1,t.FEATURE_ms_teams_pstn)]),new R(w.RTCRtpSender,"RTCRtpSender",[new S(w.RTCRtpSender,f.ctor,"ctor",!1,t.FEATURE_ms_teams_pstn),new S(w.RTCRtpSender,f.track,"track",!0,t.FEATURE_ms_teams_pstn),new S(w.RTCRtpSender,f.transport,"transport",!0,t.FEATURE_ms_teams_pstn),new S(w.RTCRtpSender,f.rtcpTransport,"rtcpTransport",!0,t.FEATURE_ms_teams_pstn),new S(w.RTCRtpSender,f.dtmf,"dtmf",!0,t.FEATURE_ms_teams_pstn),new S(w.RTCRtpSender,f.getCapabilities,"getCapabilities",!1,t.FEATURE_ms_teams_pstn),new S(w.RTCRtpSender,f.getParameters,"getParameters",!1,t.FEATURE_ms_teams_pstn),new S(w.RTCRtpSender,f.setParameters,"setParameters",!1,t.FEATURE_ms_teams_pstn),new S(w.RTCRtpSender,f.replaceTrack,"replaceTrack",!1,t.FEATURE_ms_teams_pstn),new S(w.RTCRtpSender,f.getStats,"getStats",!1,t.FEATURE_ms_teams_pstn),new S(w.RTCRtpSender,f.setStreams,"setStreams",!1,t.FEATURE_ms_teams_pstn)]),new R(w.RTCDtlsTransport,"RTCDtlsTransport",[new S(w.RTCDtlsTransport,p.ctor,"ctor",!1,t.FEATURE_ms_teams_pstn),new S(w.RTCDtlsTransport,p.transport,"transport",!0,t.FEATURE_ms_teams_pstn),new S(w.RTCDtlsTransport,p.state,"state",!0,t.FEATURE_ms_teams_pstn),new S(w.RTCDtlsTransport,p.getRemoteCertificates,"getRemoteCertificates",!1,t.FEATURE_ms_teams_pstn),new S(w.RTCDtlsTransport,p.onstatechange,"onstatechange",!0,t.FEATURE_ms_teams_pstn),new S(w.RTCDtlsTransport,p.onerror,"onerror",!0,t.FEATURE_ms_teams_pstn)]),new R(w.RTCIceTransport,"RTCIceTransport",[new S(w.RTCIceTransport,y.ctor,"ctor",!1,t.FEATURE_ms_teams_pstn),new S(w.RTCIceTransport,y.role,"role",!0,t.FEATURE_ms_teams_pstn),new S(w.RTCIceTransport,y.component,"component",!0,t.FEATURE_ms_teams_pstn),new S(w.RTCIceTransport,y.state,"state",!0,t.FEATURE_ms_teams_pstn),new S(w.RTCIceTransport,y.gatheringState,"gatheringState",!0,t.FEATURE_ms_teams_pstn),new S(w.RTCIceTransport,y.localcandidates,"localcandidates",!0,t.FEATURE_ms_teams_pstn),new S(w.RTCIceTransport,y.remotecandidates,"remotecandidates",!0,t.FEATURE_ms_teams_pstn),new S(w.RTCIceTransport,y.onstatechange,"onstatechange",!0,t.FEATURE_ms_teams_pstn),new S(w.RTCIceTransport,y.ongatheringstatechange,"ongatheringstatechange",!0,t.FEATURE_ms_teams_pstn),new S(w.RTCIceTransport,y.onselectedcandidatepairchange,"onselectedcandidatepairchange",!0,t.FEATURE_ms_teams_pstn)]),new R(w.RTCDTMFSender,"RTCDTMFSender",[new S(w.RTCDTMFSender,v.ctor,"ctor",!1,t.FEATURE_ms_teams_pstn),new S(w.RTCDTMFSender,v.insertDTMF,"insertDTMF",!1,t.FEATURE_ms_teams_pstn),new S(w.RTCDTMFSender,v.ontonechange,"ontonechange",!0,t.FEATURE_ms_teams_pstn),new S(w.RTCDTMFSender,v.canInsertDTMF,"canInsertDTMF",!0,t.FEATURE_ms_teams_pstn),new S(w.RTCDTMFSender,v.toneBuffer,"toneBuffer",!0,t.FEATURE_ms_teams_pstn)]),new R(w.RTCDTMFToneChangeEvent,"RTCDTMFToneChangeEvent",[new S(w.RTCDTMFToneChangeEvent,C.ctor,"ctor",!1,t.FEATURE_ms_teams_pstn),new S(w.RTCDTMFToneChangeEvent,C.tone,"tone",!0,t.FEATURE_ms_teams_pstn),new S(w.RTCDTMFToneChangeEvent,C.tone_buffer,"tone_buffer",!0,t.FEATURE_ms_teams_pstn)]),new R(w.RTCIceCandidatePair,"RTCIceCandidatePair",[new S(w.RTCIceCandidatePair,b.ctor,"ctor",!1,t.FEATURE_ms_teams_pstn),new S(w.RTCIceCandidatePair,b.local,"local",!0,t.FEATURE_ms_teams_pstn),new S(w.RTCIceCandidatePair,b.remote,"remote",!0,t.FEATURE_ms_teams_pstn)]),new R(w.RTCRtpTransceiver,"RTCRtpTransceiver",[new S(w.RTCRtpTransceiver,T.ctor,"ctor",!1,t.FEATURE_ms_teams_pstn),new S(w.RTCRtpTransceiver,T.mid,"mid",!0,t.FEATURE_ms_teams_pstn),new S(w.RTCRtpTransceiver,T.sender,"sender",!0,t.FEATURE_ms_teams_pstn),new S(w.RTCRtpTransceiver,T.receiver,"receiver",!0,t.FEATURE_ms_teams_pstn),new S(w.RTCRtpTransceiver,T.direction,"direction",!0,t.FEATURE_ms_teams_pstn),new S(w.RTCRtpTransceiver,T.currentDirection,"currentDirection",!0,t.FEATURE_ms_teams_pstn),new S(w.RTCRtpTransceiver,T.stop,"stop",!1,t.FEATURE_ms_teams_pstn),new S(w.RTCRtpTransceiver,T.setCodecPreferences,"setCodecPreferences",!1,t.FEATURE_ms_teams_pstn)])]),w=function(){function e(){}return e.getInterfaceByid=function(e){for(var t=0,n=k.classes;t<n.length;t++){var r=n[t];if(r.id==e)return r}return null},e.getMethodByid=function(e,t){if(null!=(r=this.getInterfaceByid(e)))for(var n=0,r=r.methods;n<r.length;n++){var i=r[n];if(i.mid==t)return i}return null},e.getMethodFeatureByid=function(e,t){if(null!=(r=this.getInterfaceByid(e)))for(var n=0,r=r.methods;n<r.length;n++){var i=r[n];if(i.mid==t)return i.feature}return null},e.composeClassInfoData=function(e){if(void 0==(e=e.hdr))return"*** Invalid packet: Couldn't find hdr object ***";if(void 0==(t=e.proc))return"";e=t.iid;for(var t=t.methodid,n=0,r=k.classes;n<r.length;n++){var i=r[n];if(i.id==e)for(var o=0,a=i.methods;o<a.length;o++){var s=a[o];if(s.mid==t)return i.name+"::"+s.name}}return""},e}();t.WebrpcClassLibInfoUtil=w}),define("wsjsonutil",["require","exports","webrpcclassinfo"],function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.req=0]="req",e[e.reply=1]="reply",e[e.event_req=2]="event_req",e[e.event_reply=3]="event_reply"}(r=t.ws_msg_type_t||(t.ws_msg_type_t={})),e=function(){function e(){}return e.createMessageByid=function(e,t,r,i,o,a){for(var s=[],c=6;c<arguments.length;c++)s[c-6]=arguments[c];return(c=n.WebrpcClassLibInfoUtil.getMethodByid(i,o))&&c.isprop||(e=!1),this.createMessage.apply(this,[r,e,t,i,o,a].concat(s))},e.createMessage=function(e,t,n,r,i,o){for(var a=[],s=6;s<arguments.length;s++)a[s-6]=arguments[s];return{v:"webrtc",hdr:{version:this._version,msg_type:this.getMsgType(e),modifier:t,destroy:n,proc:{iid:r,methodid:i}},objref:{oid:o},params:a.slice()}},e.getMsgType=function(e){var t="";switch(e){default:t="req";break;case r.reply:t="reply";break;case r.event_req:t="event-req";break;case r.event_reply:t="event-reply"}return t},e._version=1,e}(),t.WsJsonUtil=e}),define("garbagecollector",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.parent_=this.object_=null,this.children_=[],this.object_=e}return e.prototype.addChild=function(e){e.parent_!=this&&(e.parent_=this,this.children_.push(e))},e.prototype.removeChild=function(e){var t=this.children_.indexOf(e);this.children_.splice(t,1),e.parent_=null},e}(),r=function(){function e(){this.root_=new n(null)}return e.prototype.trackObject=function(e,t){if(void 0===t&&(t=null),null===this.findNode(e,this.root_)){var r=this.findNode(t,this.root_),i=new n(e);r.addChild(i)}},e.prototype.releaseObject=function(e){return null!==(e=this.findNode(e,this.root_))&&e!==this.root_&&(this.destroyNodeObjectRecurse(e),e.parent_.removeChild(e),!0)},e.prototype.destroyNodeObjectRecurse=function(e){for(var t=0,n=e.children_;t<n.length;t++)this.destroyNodeObjectRecurse(n[t]);e.object_.destroy()},e.prototype.setParent=function(e,t){var n=this.findNode(e,this.root_);if(null===n)return!1;var r=this.findNode(t,this.root_);return null!==r&&(n.parent_===r||(n.parent_.removeChild(n),r.addChild(n),!0))},e.prototype.reset=function(){this.root_.children_=[]},e.prototype.findNode=function(e,t){if(t.object_===e)return t;for(var n=null,r=0,i=t.children_;r<i.length&&null===(n=this.findNode(e,i[r]));r++);return n},e}();t.GC=r,t.gc=new r}),define("proxyobject","require exports hdxms logger wsjsonutil garbagecollector webrpcclassinfo".split(" "),function(e,t,n,r,i,o,a){Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t,n){this.resolve=e,this.reject=t,this.name=n}return e.prototype.post=function(e){1==e?(r.logger.log('deferred_action.post(): resolving "'+this.name+'"'),this.resolve()):(r.logger.log('deferred_action.post(): rejecting "'+this.name+'"'),this.reject())},e}();t.deferred_action=s;var c=function(e,t){this.id=e,this.is_null=t};t.rpc_callback=c;var d=function(){function e(e,t,n){this.success=new c(e<<16,t),this.fail=new c(e<<16|1,t),this.id=e,this.oneShot=n}return e.prototype.resolve=function(e){r.logger.trace("callback.resolve() called. [id="+this.id+"]"),null!=this.handler&&this.handler(e)},e.prototype.reject=function(e){null!=this.err_handler&&this.err_handler(e)},e.prototype.then=function(e){this.handler=e},e.prototype.prom=function(){var e=this;return new Promise(function(t,n){e.handler=t,e.err_handler=n})},e}();t.callback=d;var l;!function(e){e[e.NotConfigured=0]="NotConfigured",e[e.Configured=1]="Configured",e[e.Error=2]="Error",e[e.Destroyed=3]="Destroyed"}(l||(l={}));var u;!function(e){e[e.Local=0]="Local",e[e.Remote=1]="Remote",e[e.Pseudo=2]="Pseudo"}(u=t.ProxyMode||(t.ProxyMode={})),e=function(){function e(t,s,c,d,g){void 0===g&&(g=null);for(var _=[],h=5;h<arguments.length;h++)_[h-5]=arguments[h];var m=this;this.hdxms=n.getRedirector(),this.iid=s,this.oid=c,this.mode=d,this.state=l.NotConfigured,this.deferredActions=[],this.cbs=new Map,d===u.Local?(h=!1,this.iid===a.class_id_t.EngineControl&&(h=!0),this.hdxms.startRedirection(h,this.user_friendly_id()).then(function(){m.oid=e.nextId++,r.logger.log(m.user_friendly_id()+" assigned local oid:"+m.oid);var t=a.WebrpcClassLibInfoUtil.getMethodFeatureByid(s,0);return m.hdxms.WSSendObjectWrapper(t,s,0,i.WsJsonUtil.createMessageByid.apply(i.WsJsonUtil,[!1,!1,i.ws_msg_type_t.req,s,0,m.oid].concat(_)))}).then(function(e){r.logger.trace("ProxyObject: setting state to configured. (iid: "+m.iid+" oid: "+m.oid+")");var n=m.oid;m.state=l.Configured,m.oid=m.param0(e),r.logger.log(m.user_friendly_id()+" assigned remote oid for local oid:"+n),m.onConnected(),g&&g(),o.gc.trackObject(m,t)}).catch(function(){m.state=l.Error,m.onConnected()})):d===u.Remote&&(this.state=l.Configured,o.gc.trackObject(this,t))}return e.prototype.bind=function(e,t){if(r.logger.trace("ProxyObject: binding object. (iid: "+this.iid+" oid: "+t+" mode: "+this.mode+")"),this.mode===u.Pseudo){this.state=l.Configured;var n=this.oid;this.oid=t,r.logger.log(this.user_friendly_id()+" assigned remote oid for local oid:"+n),this.onConnected(),o.gc.trackObject(this,e),this.mode=u.Remote}else r.logger.log("ProxyObject: binding failure. incorrect mode!")},e.prototype.reconstructor=function(e,t,n){for(var s=this,c=[],d=3;d<arguments.length;d++)c[d-3]=arguments[d];this.state=l.NotConfigured,this.deferredActions=[],d=a.WebrpcClassLibInfoUtil.getMethodFeatureByid(t,0),this.hdxms.WSSendObjectWrapper(d,t,0,i.WsJsonUtil.createMessageByid.apply(i.WsJsonUtil,[!1,!1,i.ws_msg_type_t.req,t,0,this.oid].concat(c))).then(function(t){r.logger.trace("ProxyObject: setting state to configured. (iid: "+s.iid+" oid: "+s.oid+")");var n=s.oid;s.state=l.Configured,s.oid=s.param0(t),r.logger.log(s.user_friendly_id()+" assigned remote oid for local oid:"+n),s.onConnected(),o.gc.trackObject(s,e)}).catch(function(){s.state=l.Error,s.onConnected()})},e.prototype.setParent=function(e){o.gc.setParent(this,e)},e.prototype.release=function(){r.logger.log(this.user_friendly_id()+".release() called."),o.gc.releaseObject(this)},e.prototype.destroy=function(){this.state=l.Destroyed;var e=a.WebrpcClassLibInfoUtil.getMethodFeatureByid(this.iid,0);this.hdxms.WSSendObjectWrapper(e,this.iid,0,i.WsJsonUtil.createMessageByid(!1,!0,i.ws_msg_type_t.req,this.iid,0,this.oid))},e.prototype.onConnected=function(){for(;this.deferredActions&&0<this.deferredActions.length;)this.deferredActions.shift().post(this.state==l.Configured)},e.prototype.checkState=function(e,t){var n=this;0>=e?(r.logger.log("ProxyObject.checkState() timeout waiting for connection response! failed. (iid: "+n.iid+" oid: "+n.oid+")"),n.onConnected()):setTimeout(function(){n.state==l.Configured?n.onConnected():n.state==l.Error?n.onConnected():n.state==l.Destroyed?n.onConnected():(r.logger.log('ProxyObject.checkState(): count= "'+e+'". (iid: '+n.iid+" oid: "+n.oid+")"),n.checkState(--e,t))},t)},e.prototype.waitUntilConnected=function(e){var t=this;return new Promise(function(n,i){r.logger.trace("ProxyObject.waitUntilConnected(): readyState="+t.state+". (iid: "+t.iid+" oid: "+t.oid+")"),t.state==l.Destroyed&&(t.onConnected(),i("Object already destroyed :"+t.user_friendly_id())),t.state==l.Configured?(t.onConnected(),n()):t.state==l.Error?(r.logger.trace("ProxyObject.waitUntilConnected(): readyState="+t.state+". (iid: "+t.iid+" oid: "+t.oid+")"),t.onConnected(),i()):(r.logger.log('ProxyObject.waitUntilConnected(): deferring action "'+e+'". (iid: '+t.iid+" oid: "+t.oid+")"),t.deferredActions.push(new s(n,i,e)),t.checkState(15,1e3))})},e.prototype.remoteInvoke=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return this.state==l.Destroyed?Promise.reject("Cannot invoke destroyed object :"+this.user_friendly_id()):this.state==l.Error?Promise.reject("Cannot invoke object in Error state:"+this.user_friendly_id()):(r=a.WebrpcClassLibInfoUtil.getMethodFeatureByid(this.iid,t),this.hdxms.WSSendObjectWrapper(r,this.iid,t,i.WsJsonUtil.createMessageByid.apply(i.WsJsonUtil,[e,!1,i.ws_msg_type_t.req,this.iid,t,this.oid].concat(n))))},e.prototype.registerCallbacks=function(t,n,r){this.unregisterCallbacks(r);var i=e.nextcbid++,o=new d(i,n,t);return n||(t||this.cbs.set(r,i),this.hdxms.registerHandler(this.iid,this.oid,o)),o},e.prototype.unregisterCallbacks=function(e){this.cbs.has(e)?(this.hdxms.unregisterHandler(this.iid,this.oid,this.cbs.get(e)),this.cbs.delete(e)):r.logger.trace(this.cbs)},e.prototype.object_id=function(){return this.oid},e.prototype.param0=function(e){return e.params[0]},e.prototype.isNullCallback=function(e){return void 0==e||null==e},e.prototype.user_friendly_id=function(){return this.constructor.name+"["+this.oid+"]"},e.prototype.isRedirected=function(){return this.hdxms.isRedirected()},e.prototype.isValid=function(){return!(this.state===l.Error||this.state===l.Destroyed)},e.prototype.registerStateChangeNotification=function(e){this.hdxms.registerStateChangeNotification(e)},e.prototype.unregisterStateChangeNotification=function(e){this.hdxms.unregisterStateChangeNotification(e)},e.nextId=0,e.nextcbid=0,e}(),t.ProxyObject=e}),define("telemetry",["require","exports","hdxms","logger"],function(e,t,n,r){Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.unknown=0]="unknown",e[e.active=1]="active",e[e.idle=2]="idle"}(t.tel_CallState||(t.tel_CallState={})),function(e){e[e.unknown=0]="unknown",e[e.incoming=1]="incoming",e[e.outgoing=2]="outgoing"}(t.tel_CallDirection||(t.tel_CallDirection={})),function(e){e[e.unknown=0]="unknown",e[e.audio=1]="audio",e[e.video=2]="video",e[e.multi=3]="multi",e[e.dshare=4]="dshare"}(t.tel_CallType||(t.tel_CallType={}));var i;!function(e){e[e.Unknown=0]="Unknown",e[e.Cap=1]="Cap",e[e.Init=2]="Init",e[e.Data=3]="Data"}(i=t.tel_cmd||(t.tel_cmd={})),t.tel_key_ConferenceCallDuration="ConferenceCallDuration",t.tel_key_AudioCallDuration="AudioCallDuration",t.tel_key_VideoCallDuration="VideoCallDuration",t.tel_key_ScreensharingCallDuration="ScreensharingCallDuration",t.tel_key_CallEstIncoming="CallEstIncoming",t.tel_key_CallEstOutgoing="CallEstOutgoing",t.tel_key_AudioDeviceUsed="AudioDeviceUsed",t.tel_key_VideoDeviceUsed="VideoDeviceUsed",t.tel_key_SpeakerDeviceUsed="SpeakerDeviceUsed",t.tel_key_PerfCallDirection="PerfCallDirection",t.tel_key_PerfCallState="PerfCallState",t.tel_key_PerfCallType="PerfCallType",t.tel_key_VerWebrpc="VerWebrpc",t.tel_key_VerWebrtcCodecs="VerWebrtcCodecs",t.tel_key_VerReceiver="VerReceiver",t.tel_key_VerVda="VerVda",t.tel_key_VerEndpoint="VerEndpoint",t.tel_key_VerTypeScript="VerTypeScript",t.tel_key_OSFamily="OSFamily",t.tel_key_OSVersion="OSVersion",t.tel_key_OSArchitecture="OSArchitecture",t.tel_key_OSDistro="OSDistro",t.tel_key_OSEdition="OSEdition";var o=function(){function e(e,t,n,r){this.cmd=e,this.key=t,this.value=n,this.flags=r}return e.prototype.SendTelemetryData=function(e){e.SendTelemetryData(this.cmd,this.key,this.value,this.flags)},e}();e=function(){function e(){this.id=0,this.deferredData=[]}return e.prototype.reset=function(){this.id=0,this.deferredData=[]},e.prototype.onInitialized=function(e){for(this.id=e;this.deferredData&&0<this.deferredData.length;)this.deferredData.shift().SendTelemetryData(this)},e.prototype.SendTelemetryInit=function(){0<this.id&&this.reset();try{n.getRedirector().WSSendObject({v:"telemetry",hdr:{command:i.Init,id:0},init:{domain:"HDXMM Teams",subdomain:"Teams",feature:"msteams",version:"1.1.1.1"}})}catch(e){r.logger.log(e)}},e.prototype.SendTelemetryData=function(e,t,a,s){if(e!=i.Data)r.logger.log("invalid telemetry command!");else if(0==this.id)this.deferredData.push(new o(e,t,a,s));else try{n.getRedirector().WSSendObject({v:"telemetry",hdr:{command:e,id:this.id},data:{key:t,value:a,flags:s}})}catch(e){r.logger.log(e)}},e}(),t.Telemetry=e}),define("hdxms","require exports proxyobject logger webrpcclassinfo wsjsonutil telemetry".split(" "),function(e,t,n,r,i,o,a){Object.defineProperty(t,"__esModule",{value:!0});var s,c=function(e,t,n,r,i,o,a){this.resolve=e,this.reject=t,this.iid=n,this.oid=r,this.cbid=i,this.oneShot=o,this.mid=a};!function(e){e[e.NotRedirected=0]="NotRedirected",e[e.Connecting=1]="Connecting",e[e.Binding=2]="Binding",e[e.Redirected=3]="Redirected"}(s=t.RedirectionStatus||(t.RedirectionStatus={})),e=function(){function e(){this.pingactive=!1,this.status=s.NotRedirected,this.reqs=[],this.cbs=[],this.deferredActions=[],this.telemetry_=new a.Telemetry,this.stateChangeNotifcations=[]}return Object.defineProperty(e.prototype,"telemetry",{get:function(){return this.telemetry_},enumerable:!0,configurable:!0}),e.prototype.setRemoteSessionInfoCb=function(e){this.remoteSessionInfoCb=e},e.prototype.setFeatures=function(e){this.features=e},e.prototype.getFeatureValue=function(e){var t=this.features.find(function(t){return t.name===e});return void 0!==t&&t.value},e.prototype.onRedirectionComplete=function(){for(;this.deferredActions&&0<this.deferredActions.length;)this.deferredActions.shift().post(this.status==s.Redirected)},e.prototype.connectToService=function(){return r.logger.log("Redirection status: Connecting..."),this.status=s.Connecting,new Promise(function(e,t){var n=new WebSocket("wss://127.0.0.1:9002");n.onopen=function(){e(n)},n.onerror=function(e){r.logger.log("websocket connection error: "+e.type),t(e)}})},e.prototype.waitUntilRedirected=function(e){var t=this;return new Promise(function(n,i){t.status==s.Redirected?n():0>=e?i():setTimeout(function(){r.logger.log("waitUntilRedirected() timeout. count="+e),t.status!=s.Redirected?t.waitUntilRedirected(--e).then(function(){n()}).catch(function(){i()}):n()},2e3)})},e.prototype.handleRemoteSessionInfo=function(){var e=this;r.logger.log("handleRemoteSessionInfo called.");var t=this;t.remoteSessionInfoCb?t.remoteSessionInfoCb().then(function(n){r.logger.log("remoteSessionInfo success! info:"+JSON.stringify(n)),r.logger.log("Redirection status: Redirected"),t.status=s.Redirected,t.pingConnectionEnd(),(0,window.onVdiClientConnected)(),e.telemetry.SendTelemetryInit(),t.onRedirectionComplete()}).catch(function(){r.logger.log("remoteSessionInfo failure!"),t.suspendRedirection(!0),t.onRedirectionComplete()}):(r.logger.log("remoteSessionInfoCb is invalid!"),t.suspendRedirection(!0),t.onRedirectionComplete())},e.prototype.startRedirection=function(e,t){var i=this,o=window.onVdiClientDisconnected;return new Promise(function(a,c){i.status!=s.Redirected?(r.logger.log("Attempting to start redirection: "+t),!1===e?i.deferredActions.push(new n.deferred_action(a,c,t)):i.connectToService().then(function(e){r.logger.log("Redirection status: Binding..."),i.status=s.Binding,i.websocket=e,i.websocket.onmessage=function(e){i.onWSMessage(e)},i.websocket.onclose=function(e){i.onWSClose(e)},a(),i.handleRemoteSessionInfo()}).catch(function(e){r.logger.log("Unable to connect to websocket service!"),c(),i.suspendRedirection(!0),i.onRedirectionComplete(),o(!0)})):(r.logger.log("Redirection already started."),a())})},e.prototype.suspendRedirection=function(e){var t=this;r.logger.log("Suspending redirection."),(0,window.onVdiClientDisconnected)(!1);var n=!1;(0,window.getCitrixMSTeamsRedir)().then(function(e){r.logger.log("sucesss on disconnect"+e),"1"==e&&(n=!0,r.logger.log("Reg key exists while disconnecting")),t.status===s.Redirected&&1==n&&(r.logger.log("Calling ping not normal disconnect"),t.pingConnectionBegin(!1)),r.logger.log("Redirection status: NotRedirected"),t.status=s.NotRedirected}).catch(function(){r.logger.log("Failure to Read MS Teams redir Reg Key, not retrying...")}),this.dispatchStateChangeNotifications()},e.prototype.onWSOpen=function(){},e.prototype.onWSClose=function(e){r.logger.log("disconnected from websocket service.");try{this.suspendRedirection(!0)}catch(e){r.logger.log("suspendRedirection(): exception closing WebSocket: "+e.message)}},e.prototype.onWSError=function(){try{this.suspendRedirection(!0)}catch(e){r.logger.log("suspendRedirection(): exception on WebSocket error: "+e.message)}},e.prototype.WSSendObjectWrapper=function(e,t,n,r){a=!0;t!=i.class_id_t.EngineControl||n!=i.method_id_EngineControl_t.ctor&&n!=i.method_id_EngineControl_t.version&&n!=i.method_id_EngineControl_t.feature_flags||(a=!1);var o=!0;if(a&&(o=!1,void 0!=this.features))for(var a=0,s=this.features;a<s.length;a++){var c=s[a];if(!0===c.value&&c.name==e){o=!0;break}}return 1==o?this.WSSendObject(r):Promise.reject("Cannot invoke method that is not supported by webrpc: iid("+t+") mid("+n+")")},e.prototype.WSSendObject=function(e){var t=this;return new Promise(function(n,o){if("webrtc"==e.v){var a=e.hdr.proc.iid,s=e.hdr.proc.methodid,d=e.objref.oid;e.hdr.destroy||(a=new c(n,o,a,d,0,!0,s),t.reqs.push(a)),a=JSON.stringify(e),r.logger.trace("WSSendObject: >>> "+i.WebrpcClassLibInfoUtil.composeClassInfoData(e)+" "+a);try{t.websocket.send(a)}catch(e){r.logger.log("WSSendObject(): exception: "+e.message),o(e.message)}}else"overlay"==e.v?(a=JSON.stringify(e),r.logger.log("HDXMS: SendOverlayData: >>> "+a+"'"),t.websocket.send(a)):"telemetry"==e.v?(a=JSON.stringify(e),r.logger.log("HDXMS: SendTelemetryData: >>> "+a+"'"),t.websocket.send(a)):r.logger.log("HDXMS: Unknown protocol: '"+JSON.stringify(e)+"'")})},e.prototype.onWSMessage=function(e){var t,n=e.data;try{t=JSON.parse(n)}catch(e){console.log("invalid JSON!!!"),console.log(e),console.log(n)}if("webrtc"==t.v){r.logger.trace("onWSMessage: <<< "+i.WebrpcClassLibInfoUtil.composeClassInfoData(t)+" "+n);var a=t.hdr.proc.iid,s=t.hdr.proc.methodid,c=t.objref.oid;if(e=t.status,t.hdr.msg_type==o.WsJsonUtil.getMsgType(o.ws_msg_type_t.reply))0<=(n=this.reqs.findIndex(function(e){return e.iid==a&&e.oid==c&&e.mid==s}))?0==e?this.reqs.splice(n,1).shift().resolve(t):this.reqs.splice(n,1).shift().reject():(r.logger.log("HDXMS didnt find this one. (reqs)"),r.logger.log(this.reqs));else if(t.hdr.msg_type==o.WsJsonUtil.getMsgType(o.ws_msg_type_t.event_req)){var d=t.func.id;0<=(n=this.cbs.findIndex(function(e){return e.iid==a&&e.oid==c&&e.cbid==d>>16}))?(0==(65535&d)?this.cbs[n].resolve(t):this.cbs[n].reject(t),1==this.cbs[n].oneShot&&this.cbs.splice(n,1)):(r.logger.log("HDXMS didnt find this one. (cbs)"),r.logger.log(this.cbs))}else r.logger.log("HDXMS Received bogus message: "+n+"'")}else"telemetry"==t.v?0==t.status&&2==(2147483647&t.hdr.command)&&(this.telemetry.onInitialized(t.hdr.id),r.logger.log("Telemetry init response received")):r.logger.log("HDXMS: Unknown protocol: "+n+"'")},e.prototype.clearReqs=function(){r.logger.log("clearReqs()"),this.reqs.forEach(function(e,t){e.reject()}),this.reqs=[]},e.prototype.registerHandler=function(e,t,n){e=new c(n.resolve.bind(n),n.reject.bind(n),e,t,n.id,n.oneShot,0),this.cbs.push(e)},e.prototype.unregisterHandler=function(e,t,n){var i=this.cbs.findIndex(function(r){return r.iid==e&&r.oid==t&&r.cbid==n});0<=i?this.cbs.splice(i,1):(r.logger.log("HDXMS Didnt find this callback in the list!"),console.log(this.cbs))},e.prototype.isRedirected=function(){return this.status===s.Redirected||this.status===s.Binding||this.status===s.Connecting},e.prototype.isPingActive=function(){return this.pingactive},e.prototype.pingConnectionBegin=function(e){r.logger.log("Started timer"),this.pingactive=!0;var t=window.onVdiClientDisconnectedTimer;1==e?(r.logger.log("checking if we are connected..."),t()):this.conntimer=setTimeout(function(){r.logger.log("checking if we are connected..."),t()},15e3)},e.prototype.pingConnectionEnd=function(){this.pingactive=!1,clearTimeout(this.conntimer)},e.prototype.SendTelemetryData_Speaker=function(e){this.telemetry.SendTelemetryData(a.tel_cmd.Data,a.tel_key_SpeakerDeviceUsed,e,0)},e.prototype.registerStateChangeNotification=function(e){this.stateChangeNotifcations.push(e)},e.prototype.unregisterStateChangeNotification=function(e){this.stateChangeNotifcations=this.stateChangeNotifcations.filter(function(t){return t!=e})},e.prototype.dispatchStateChangeNotifications=function(){this.stateChangeNotifcations.forEach(function(e){e()})},e}(),t.HdxMediaStream=e;var d=new e;t.getRedirector=function(){return d}}),define("remotemedia","require exports webrpcclassinfo proxyobject logger hdxms telemetry".split(" "),function(e,t,n,r,i,o,a){Object.defineProperty(t,"__esModule",{value:!0});var s;t.enumerateddecices=s;var c=function(e,t){this.type=e,this.target=t},d=function(){function e(){this.is_local_clone=!1,this.clone_id=this.clone_count=0}return e.prototype.clone=function(){this.clone_count++;var t=new e;return t.is_local_clone=!0,t.clone_id=this.clone_count,t},e.prototype.synchronize=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return this.is_local_clone?[2,e.asyncClone()]:[2,e]})})},e}(),l=function(e){function t(t,i){var o=e.call(this,t,n.class_id_t.MediaStreamTrack,i,r.ProxyMode.Remote)||this;return o.refCount_=0,o.refCount_++,o.clone_state=new d,o}return __extends(t,e),Object.defineProperty(t.prototype,"refcount",{get:function(){return this.refCount_},enumerable:!0,configurable:!0}),t.prototype.addRef=function(){this.refCount_++,i.logger.log(this.user_friendly_id()+".addRef() called. [id="+this.id+"] refcount="+this.refCount_)},Object.defineProperty(t.prototype,"onended",{get:function(){return i.logger.log(this.user_friendly_id()+".get_onended() called. [id="+this.id+"]"),this.onended_},set:function(e){var t=this;i.logger.log(this.user_friendly_id()+".set_onended() called. [id="+this.id+"]"),this.onended_=e,this.waitUntilConnected("MediaStreamTrack.onended").then(function(){var r=t.registerCallbacks(!1,t.isNullCallback(e),n.method_id_MediaStreamTrack_t.onended);return r.then(function(e){i.logger.log(t.user_friendly_id()+"onended event received!!!"),e=new c("ended",t),t.readyState_="ended",t.onended_(e)}),t.remoteInvoke(!0,n.method_id_MediaStreamTrack_t.onended,r.success)}).catch(function(){i.logger.log(t.user_friendly_id()+".onended failed!!!")})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onmute",{get:function(){return i.logger.log(this.user_friendly_id()+".get_onmute() called. [id="+this.id+"]"),this.onmute_},set:function(e){var t=this;i.logger.log(this.user_friendly_id()+".set_onmute() called. [id="+this.id+"]"),this.onmute_=e,this.waitUntilConnected("MediaStreamTrack.onmute").then(function(){var r=t.registerCallbacks(!1,t.isNullCallback(e),n.method_id_MediaStreamTrack_t.onmute);return r.then(function(e){i.logger.log(t.user_friendly_id()+"onmute event received!!!"),e=new c("mute",t),t.muted=!0,t.onmute_(e)}),t.remoteInvoke(!0,n.method_id_MediaStreamTrack_t.onmute,r.success)}).catch(function(){i.logger.log(t.user_friendly_id()+".onmute failed!!!")})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onunmute",{get:function(){return i.logger.log(this.user_friendly_id()+".get_onunmute() called. [id="+this.id+"]"),this.onunmute_},set:function(e){var t=this;i.logger.log(this.user_friendly_id()+".set_onunmute() called. [id="+this.id+"]"),this.onunmute_=e,this.waitUntilConnected("MediaStreamTrack.onunmute").then(function(){var r=t.registerCallbacks(!1,t.isNullCallback(e),n.method_id_MediaStreamTrack_t.onunmute);return r.then(function(e){i.logger.log("onunmute event received!!!"),e=new c("unmute",t),t.muted=!1,t.onunmute_(e)}),t.remoteInvoke(!0,n.method_id_MediaStreamTrack_t.onunmute,r.success)}).catch(function(){i.logger.log(t.user_friendly_id()+".onunmute failed!!!")})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onstop",{set:function(e){this.onstop_=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"enabled",{get:function(){return i.logger.log(this.user_friendly_id()+".get_enabled() called. [id="+this.id+", value="+this.enabled_+"]"),this.enabled_},set:function(e){i.logger.log(this.user_friendly_id()+".set_enabled() called. [id="+this.id+", value="+e+"]"),this.enabled_=e,this.remoteInvoke(!0,n.method_id_MediaStreamTrack_t.enabled,e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"readyState",{get:function(){return i.logger.log(this.user_friendly_id()+".get_readyState() called. [id="+this.id+"]"),this.readyState_},enumerable:!0,configurable:!0}),t.prototype.asyncClone=function(){return __awaiter(this,void 0,void 0,function(){var e,r,i;return __generator(this,function(o){switch(o.label){case 0:return[4,this.waitUntilConnected("RemoteMediaTrack.asyncClone")];case 1:return o.sent(),[4,this.remoteInvoke(!1,n.method_id_MediaStreamTrack_t.clone,[])];case 2:return e=o.sent(),r=this.param0(e),i=new t(this,r.oid),[2,i.syncBarrier()]}})})},t.prototype.clone=function(){i.logger.log(this.user_friendly_id()+".clone() called. [id="+this.id+"]");var e=this.clone_state.clone(),n=new t(this,this.object_id());return n.id=this.id+"."+e.clone_id.toString(),n.label=this.label,n.kind=this.kind,n.enabled_=this.enabled_,n.muted=this.muted,n.readyState_=this.readyState_,n.trackSettings_=this.trackSettings_,n.clone_state=e,n.constraints_=this.constraints_,n.capabilities_=this.capabilities_,n},t.prototype.stop=function(){var e=this;i.logger.log(this.user_friendly_id()+".stop() called. [id="+this.id+"] refcount="+this.refCount_),this.readyState_="ended",0<this.refCount_&&0==--this.refCount_&&(i.logger.log(this.user_friendly_id()+".stop() called. [id="+this.id+"] remote invoking..."),this.remoteInvoke(!1,n.method_id_MediaStreamTrack_t.stop).catch(function(t){i.logger.log(e.user_friendly_id()+".stop() failed with:"+t)}),null!==this.onstop_&&void 0!=this.onstop_)&&this.onstop_()},t.prototype.getCapabilities=function(){return this.capabilities_},t.prototype.getConstraints=function(){return this.constraints_},t.prototype.getSettings=function(){return"audio"==this.kind?function(e){return{deviceId:e.deviceId,echoCancellation:e.echoCancellation}}(this.trackSettings_):function(e){return{aspectRatio:e.aspectRatio,deviceId:e.deviceId,frameRate:e.frameRate,height:e.height,width:e.width}}(this.trackSettings_)},t.prototype.applyConstraints=function(e){var t=this;return i.logger.log(this.user_friendly_id()+".applyConstraints() called."),new Promise(function(r,o){t.waitUntilConnected("MediaStreamTrack.applyConstraints").then(function(){return Promise.all([t.remoteInvoke(!1,n.method_id_MediaStreamTrack_t.applyConstraints,e),t.syncBarrier()])}).catch(function(){o({name:"OverconstrainedError",message:"Failed to apply constraints."})}).then(function(){return t.constraints_=e,t.remoteInvoke(!1,n.method_id_MediaStreamTrack_t.getConstraints)}).then(function(e){t.constraints_=t.param0(e)}).catch(function(){i.logger.log(t.user_friendly_id()+".syncBarrier() remote client doesn't support getConstraints method. Ignore it")}).then(function(){return r()})})},t.convertReadyState=function(e){return 0==e?"live":"ended"},t.prototype.syncBarrier=function(){var e=this;return i.logger.log(this.user_friendly_id()+".syncBarrier() called."),new Promise(function(r,i){e.waitUntilConnected("MediaStreamTrack.syncBarrier").then(function(){return Promise.all([e.remoteInvoke(!1,n.method_id_MediaStreamTrack_t.kind,""),e.remoteInvoke(!1,n.method_id_MediaStreamTrack_t.id,""),e.remoteInvoke(!1,n.method_id_MediaStreamTrack_t.label,""),e.remoteInvoke(!1,n.method_id_MediaStreamTrack_t.enabled,!1),e.remoteInvoke(!1,n.method_id_MediaStreamTrack_t.muted,!1),e.remoteInvoke(!1,n.method_id_MediaStreamTrack_t.readyState,0),e.remoteInvoke(!1,n.method_id_MediaStreamTrack_t.getSettings),e.remoteInvoke(!1,n.method_id_MediaStreamTrack_t.getCapabilities)])}).then(function(n){var i=0;n=n.map(function(t){return e.param0(t)}),e.kind=n[0],e.id=n[1],e.label=n[2],e.enabled_=n[3],e.muted=n[4],i=n[5],e.trackSettings_=n[6],e.capabilities_=n[7],e.readyState_=t.convertReadyState(i),r(e)}).catch(function(){i()})})},t}(r.ProxyObject);t.RemoteMediaTrack=l;var u=function(){},g=function(e){function t(t,i){var o=e.call(this,t,n.class_id_t.MediaStream,i,r.ProxyMode.Remote)||this;return o.clone_state=new d,o}return __extends(t,e),t.prototype.dumpTrackInfo=function(){i.logger.log(this.user_friendly_id()+".dumpTrackInfo() called. [id="+this.id+"]");for(var e=0,t=this.tracks_;e<t.length;e++){var n=t[e];i.logger.log(n.user_friendly_id()+" [id="+n.id+"] refcount="+n.refcount)}},t.prototype.toJSON=function(){var e=new u;return e.id=this.id,e.active=this.active,e.oid=this.object_id(),"RemoteStream:"+JSON.stringify(e)},t.prototype.getAudioTracks=function(){i.logger.log(this.user_friendly_id()+".getAudioTracks() called. [id="+this.id+"]");for(var e=[],t=0,n=this.tracks_;t<n.length;t++){var r=n[t];"audio"==r.kind&&e.push(r)}return e},t.prototype.getVideoTracks=function(){i.logger.log(this.user_friendly_id()+".getVideoTracks() called. [id="+this.id+"]");for(var e=[],t=0,n=this.tracks_;t<n.length;t++){var r=n[t];"video"==r.kind&&e.push(r)}return e},t.prototype.getTracks=function(){return i.logger.log(this.user_friendly_id()+".getTracks() called. [id="+this.id+"]"),this.tracks_},t.prototype.getTrackById=function(e){i.logger.log(this.user_friendly_id()+".getTrackById() called. [id="+this.id+"]");for(var t=0,n=this.tracks_;t<n.length;t++){var r=n[t];if(r.id==e)return r}},t.prototype.addTrack=function(e){i.logger.log(this.user_friendly_id()+".addTrack() called. [id="+this.id+"]"),this.tracks_.push(e),this.remoteInvoke(!1,n.method_id_MediaStream_t.addTrack,{oid:e.object_id()})},t.prototype.removeTrack=function(e){i.logger.log(this.user_friendly_id()+".removeTrack() called. [id="+this.id+"]");var t=this.tracks_.indexOf(e);this.tracks_.splice(t,1),this.remoteInvoke(!1,n.method_id_MediaStream_t.removeTrack,{oid:e.object_id()})},t.prototype.asyncClone=function(){return __awaiter(this,void 0,void 0,function(){var e,r,o;return __generator(this,function(a){switch(a.label){case 0:return i.logger.log(this.user_friendly_id()+".asyncClone() called. [id="+this.id+"]"),[4,this.waitUntilConnected("asyncClone")];case 1:return a.sent(),[4,this.remoteInvoke(!1,n.method_id_MediaStream_t.clone,[])];case 2:return e=a.sent(),console.log(e),r=this.param0(e),o=new t(this,r.oid),[2,o.syncBarrier()]}})})},t.prototype.clone=function(){i.logger.log(this.user_friendly_id()+".clone() called. [id="+this.id+"]");var e=this.clone_state.clone(),n=new t(this,this.object_id());return n.id=this.id+"."+e.clone_id.toString(),this.tracks_.forEach(function(e){e.addRef()}),n.tracks_=this.tracks_,n.clone_state=e,n},t.prototype.syncBarrier=function(){var e=this;return i.logger.log(this.user_friendly_id()+".syncBarrier() called. [id="+this.id+"]"),new Promise(function(t,r){e.waitUntilConnected("MediaStream.syncBarrier").then(function(){return Promise.all([e.remoteInvoke(!1,n.method_id_MediaStream_t.id,""),e.remoteInvoke(!1,n.method_id_MediaStream_t.active,!1),e.remoteInvoke(!1,n.method_id_MediaStream_t.getTracks,[])])}).then(function(t){t=t.map(function(t){return e.param0(t)}),e.id=t[0],e.active=t[1],t=t[2];for(var n=[],r=0;r<t.length;r++){var i=new l(e,t[r].oid);n.push(i.syncBarrier())}return Promise.all(n)}).then(function(n){e.tracks_=[],n.forEach(function(t){t.onstop=function(){var t=!0;e.tracks_.forEach(function(e){"ended"!=e.readyState&&(t=!1)}),t&&e.release()},e.tracks_.push(t)}),t(e)}).catch(function(){r()})})},t}(r.ProxyObject);t.RemoteStream=g,e=function(e){function t(t,i){return e.call(this,t,n.class_id_t.MediaStreamEvent,i,r.ProxyMode.Remote)||this}return __extends(t,e),t.prototype.syncBarrier=function(){var e=this;return i.logger.log(this.user_friendly_id()+".syncBarrier() called."),new Promise(function(t,r){e.waitUntilConnected("MediaStreamEvent.syncBarrier").then(function(){return e.remoteInvoke(!1,n.method_id_MediaStreamEvent_t.stream,{oid:0})}).then(function(t){return new g(e,t.params[0].oid).syncBarrier()}).then(function(n){e.stream=n,t(e)}).catch(function(){r()})})},t}(r.ProxyObject),t.RemoteStreamEvent=e;var _=function(e){function t(t){return e.call(this,null,n.class_id_t.MediaDeviceInfo,t,r.ProxyMode.Remote)||this}return __extends(t,e),t.prototype.convertKind=function(e){return 0==e?"audioinput":1==e?"audiooutput":"videoinput"},t.prototype.syncBarrier=function(){var e=this;return i.logger.log(this.user_friendly_id()+".syncBarrier() called."),new Promise(function(t,r){e.waitUntilConnected("RemoteDeviceInfo.syncBarrier").then(function(){return Promise.all([e.remoteInvoke(!1,n.method_id_MediaDeviceInfo_t.deviceId,""),e.remoteInvoke(!1,n.method_id_MediaDeviceInfo_t.kind,0),e.remoteInvoke(!1,n.method_id_MediaDeviceInfo_t.label,""),e.remoteInvoke(!1,n.method_id_MediaDeviceInfo_t.groupId,"")])}).then(function(n){e.kind=e.convertKind(e.param0(n.splice(1,1)[0])),n=n.map(function(t){return e.param0(t)}),e.deviceId=n[0],e.label=n[1],e.groupId=n[2],t(e)}).catch(function(){i.logger.log(e.user_friendly_id()+".syncBarrier(): rejected."),r()})})},t}(r.ProxyObject);t.RemoteDeviceInfo=_,e=function(e){function a(){var t=e.call(this,null,n.class_id_t.MediaDevices,0,r.ProxyMode.Local,function(){t.setDeviceChangeCallback()})||this;return t.devices_=[],t}return __extends(a,e),a.prototype.enumerateDevices=function(){var e=this;return i.logger.log(this.user_friendly_id()+".enumerateDevices() called"),new Promise(function(r,o){e.waitUntilConnected("RemoteDevices.enumerateDevices").then(function(){return i.logger.log(e.user_friendly_id()+".enumerateDevices() remote invoking..."),e.remoteInvoke(!1,n.method_id_MediaDevices_t.enumerateDevices,[])}).then(function(t){var n=[];return t.params[0].forEach(function(t){var r=e.devices_.find(function(e){return e.object_id()===t.oid});void 0===r?(r=new _(t.oid),n.push(r.syncBarrier())):n.push(r)}),Promise.all(n)}).then(function(n){i.logger.log(e.user_friendly_id()+".enumerateDevices: returning enumerated devices with ids ["+n.map(function(e){return e.object_id()})+"]"),r(n),i.logger.log(e.user_friendly_id()+".enumerateDevices: resolved promise"),e.devices_.forEach(function(e){for(var t=!0,r=0;r<n.length;r++)if(e===n[r]){t=!1;break}t&&e.release()}),e.devices_=n,t.enumerateddecices=s=n}).catch(function(){i.logger.log(e.user_friendly_id()+".enumerateDevices() didnt get response, resolving with empty list"),e.devices_=[],r([])})})},a.prototype.getDisplayMedia=function(e){var t=this;return new Promise(function(r,o){t.waitUntilConnected("RemoteDevices.getDisplayMedia").then(function(){var r=t.prepareDisplayConstraints(e);return t.remoteInvoke(!1,n.method_id_MediaDevices_t.getDisplayMedia,r)}).then(function(e){return new g(null,e.params[0].oid).syncBarrier()}).then(function(e){r(e)}).catch(function(){i.logger.log(t.user_friendly_id()+".getDisplayMedia() returned an error."),o(new DOMException("Unable to get a display stream.","NotReadableError"))})})},a.prototype.setDeviceChangeCallback=function(){var e=this;i.logger.log(this.user_friendly_id()+".set_DeviceChangeCallback() called."),this.waitUntilConnected("MediaDevices.ondevicechange").then(function(){var t=e.registerCallbacks(!1,!1,n.method_id_MediaDevices_t.ondevicechange);return t.then(function(){i.logger.log(e.user_friendly_id()+".ondevicechange(): callback received!!!"),navigator.mediaDevices.dispatchEvent(new CustomEvent("devicechange"))}),e.remoteInvoke(!0,n.method_id_MediaDevices_t.ondevicechange,t.success)}).catch(function(){i.logger.log(e.user_friendly_id()+".set_ondevicechange(): failed.")})},a.prototype.prepareDisplayConstraints=function(e){if(o.getRedirector().getFeatureValue(n.FEATURE_ms_teams_common_media_constraints))return e;var t={frameRate:15,width:{max:1920},height:{max:1080}};return void 0!==e.video&&null!==e.video&&void 0!==(e=e.video).frameRate&&void 0!==e.width&&void 0!==e.height&&(t.frameRate=e.frameRate,t.width.max=e.width.max||e.width,t.height.max=e.height.max||e.height),{video:t}},a}(r.ProxyObject),t.RemoteDevices=e,e=function(e){function t(){return e.call(this,null,n.class_id_t.NavigatorUserMedia,0,r.ProxyMode.Local)||this}return __extends(t,e),t.prototype.webkitGetUserMedia=function(e,t,n){this.getUserMedia(e,t,n)},t.prototype.LogTelemetryDevice_=function(e){try{if(void 0!==e.audio){var t,n=e.audio.deviceId;s.forEach(function(e){n==e.deviceId&&(t=e.label)}),i.logger.log(t),this.SendTelemetryData(a.tel_key_AudioDeviceUsed,t,0)}if(void 0!==e.video){var r,o=e.video.mandatory.sourceId;s.forEach(function(e){o==e.deviceId&&(r=e.label)}),i.logger.log(r),this.SendTelemetryData(a.tel_key_VideoDeviceUsed,r,0)}}catch(e){i.logger.log(e)}},t.prototype.getUserMedia=function(e,t,r){var a=this;i.logger.log(this.user_friendly_id()+".getUserMedia() called: "+JSON.stringify(e)),this.waitUntilConnected("NavigatorUserMedia.getUserMedia").then(function(){var t=a.registerCallbacks(!0,!1,n.method_id_NavigatorUserMedia_t.getUserMedia);if(void 0!==e.audio&&0==Object.keys(e.audio).length&&(e.audio={dummy:1}),void 0!==e.video){var r=e.video;void 0==r.mandatory.maxFrameRate&&(r.mandatory.maxFrameRate=30),void 0==r.mandatory.minWidth&&(r.mandatory.minWidth=360),void 0==r.mandatory.maxWidth&&(r.mandatory.maxWidth=1920),void 0==r.mandatory.minHeight&&(r.mandatory.minHeight=180),void 0==r.mandatory.maxHeight&&(r.mandatory.maxHeight=1080)}return a.remoteInvoke(!1,n.method_id_NavigatorUserMedia_t.getUserMedia,e,t.success,t.fail),t.prom()}).then(function(e){return i.logger.log(a.user_friendly_id()+".getUserMedia: received success callback!"),new g(null,a.param0(e).oid).syncBarrier()}).then(function(n){i.logger.log(a.user_friendly_id()+".getUserMedia: MediaStream ready to deliver",JSON.stringify(n)),0==n.getTracks().length?(i.logger.log(a.user_friendly_id()+".getUserMedia: reporting no tracks as error."),r({constraintName:"",name:"OverconstrainedError",message:""})):(a.LogTelemetryDevice_(e),t(n))}).catch(function(e){r(o.getRedirector().getFeatureValue(n.FEATURE_ms_teams_1912)?a.param0(e):{constraintName:"",name:"OverconstrainedError",message:""})})},t.prototype.SendTelemetryData=function(e,t,n){o.getRedirector().telemetry.SendTelemetryData(a.tel_cmd.Data,e,t,n)},t}(r.ProxyObject),t.NavigatorUserMedia=e}),define("icecandidate",["require","exports","proxyobject","webrpcclassinfo","logger"],function(e,t,n,r,i){Object.defineProperty(t,"__esModule",{value:!0}),e=function(e){function t(t,i){return e.call(this,t,r.class_id_t.RTCIceCandidate,i,n.ProxyMode.Remote)||this}return __extends(t,e),Object.defineProperty(t.prototype,"candidate",{get:function(){return this.candidate_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sdpMid",{get:function(){return this.sdpMid_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sdpMLineIndex",{get:function(){return this.sdpMLineIndex_},enumerable:!0,configurable:!0}),t.prototype.syncBarrier=function(){var e=this;return i.logger.log(this.user_friendly_id()+".syncBarrier() called."),new Promise(function(t,n){e.waitUntilConnected("IceCandidate.syncBarrier").then(function(){return Promise.all([e.remoteInvoke(!1,r.method_id_RTCIceCandidate_t.candidate,""),e.remoteInvoke(!1,r.method_id_RTCIceCandidate_t.sdpMid,""),e.remoteInvoke(!1,r.method_id_RTCIceCandidate_t.sdpMLineIndex,0)])}).then(function(n){n=n.map(function(t){return e.param0(t)}),e.candidate_=n[0],e.sdpMid_=n[1],e.sdpMLineIndex_=n[2],t(e)}).catch(function(){n()})})},t}(n.ProxyObject),t.IceCandidate=e,e=function(e){function t(t,i){return e.call(this,t,r.class_id_t.RTCIceCandidatePair,i,n.ProxyMode.Remote)||this}return __extends(t,e),Object.defineProperty(t.prototype,"local",{get:function(){return this.local_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"remote",{get:function(){return this.remote_},enumerable:!0,configurable:!0}),t.prototype.syncBarrier=function(){var e=this;return i.logger.log(this.user_friendly_id()+".syncBarrier() called."),new Promise(function(t,n){e.waitUntilConnected("IceCandidatePair.syncBarrier").then(function(){return Promise.all([e.remoteInvoke(!1,r.method_id_RTCIceCandidatePair_t.local,{}),e.remoteInvoke(!1,r.method_id_RTCIceCandidatePair_t.remote,{})])}).then(function(n){n=n.map(function(t){return e.param0(t)}),e.local_=n[0],e.remote_=n[1],t(e)}).catch(function(){n()})})},t}(n.ProxyObject),t.IceCandidatePair=e}),define("stats",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.items=[]}return e.fromJSON=function(t){for(var n=new e,i=0;i<t.length;i++){var o=r.fromJSON(t[i]);n.items.push(o)}return n},e.prototype.toJSON=function(){return JSON.stringify(this.items)},e.prototype.result=function(){return this.items},e}();t.StatsReport=n;var r=function(){function e(){this.names_=[],this.stat_=new Map,this.id="",this.timestamp=0,this.type=""}return e.fromJSON=function(t){var n=new e;return n.id=t.id||"",n.timestamp=t.timestamp||"",n.type=t.type||"",Object.keys(t).forEach(function(e){"id"!==e&&"timestamp"!==e&&"type"!==e&&(n.names_.push(e),n.stat_.set(e,t[e]))}),n},e.prototype.toJSON=function(){return JSON.stringify({id:this.id,timestamp:this.timestamp,type:this.type,stat:this.stat_})},e.prototype.names=function(){return this.names_},e.prototype.stat=function(e){return this.stat_.get(e)},e}();t.Stats=r}),define("enginecontrol","require exports webrpcclassinfo hdxms proxyobject logger".split(" "),function(e,t,n,r,i,o){Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Webrpc=0]="Webrpc",e[e.WebrtcCodecs=1]="WebrtcCodecs",e[e.Receiver=2]="Receiver",e[e.Vda=3]="Vda",e[e.Endpoint=4]="Endpoint",e[e.TypeScript=5]="TypeScript",e[e.Max=6]="Max"}(t.VersionType||(t.VersionType={})),e=function(e){function t(){return e.call(this,null,n.class_id_t.EngineControl,0,i.ProxyMode.Local)||this}return __extends(t,e),t.prototype.bind=function(){o.logger.log(this.user_friendly_id()+".bind() called."),this.reconstructor(null,n.class_id_t.EngineControl,0)},t.prototype.syncBarrier=function(){var e=this;return o.logger.log(this.user_friendly_id()+".syncBarrier() called."),new Promise(function(t,i){e.waitUntilConnected("EngineControl.syncBarrier").then(function(){return Promise.all([e.remoteInvoke(!1,n.method_id_EngineControl_t.version,{major:0,minor:0,revision:0,build:0}),e.remoteInvoke(!1,n.method_id_EngineControl_t.feature_flags,[])])}).then(function(t){o.logger.log(e.user_friendly_id()+"received webrpc version and supported feature list."),t=t.map(function(t){return e.param0(t)}),e.version_=t[0],e.features_=t[1],r.getRedirector().setFeatures(e.features_),t=[];for(var i=0,a=e.features_;i<a.length;i++){var s=a[i];"ms_teams_desktop_sharing"===s.name&&s.value?t.push(e.remoteInvoke(!1,n.method_id_EngineControl_t.version_info,[])):"ms_teams_osinfo"===s.name&&s.value?t.push(e.remoteInvoke(!1,n.method_id_EngineControl_t.osinfo,{family:"",version:"",architecture:"",distro:"",edition:""})):"ms_teams_sessionidentifier"===s.name&&s.value&&t.push(e.remoteInvoke(!1,n.method_id_EngineControl_t.session_identifier,{machine_id:"",user_id:""}))}if(0<t.length)return Promise.all(t)}).then(function(r){if(void 0===r)o.logger.log(e.user_friendly_id()+"release-1905 client.");else{o.logger.log(e.user_friendly_id()+"release-1906 or later client: received detailed client version list.");for(var i=0;i<r.length;i++){var a=r[i];a.hdr.proc.iid==n.class_id_t.EngineControl&&a.hdr.proc.methodid==n.method_id_EngineControl_t.version_info?e.versions_=e.param0(a):a.hdr.proc.iid==n.class_id_t.EngineControl&&a.hdr.proc.methodid==n.method_id_EngineControl_t.osinfo?e.osinfo_=e.param0(a):a.hdr.proc.iid==n.class_id_t.EngineControl&&a.hdr.proc.methodid==n.method_id_EngineControl_t.session_identifier&&(e.sessionidentifier_=e.param0(a))}}t(e)}).catch(function(){o.logger.log(e.user_friendly_id()+"failure to retrieve version/feature related client info."),i()})})},t}(i.ProxyObject),t.EngineControl=e}),define("remotesession","require exports hdxms webrpcclassinfo enginecontrol logger webrpcclassinfo telemetry".split(" "),function(e,t,n,r,i,o,a,s){Object.defineProperty(t,"__esModule",{value:!0});var c;!function(e){e[e.Unknown=0]="Unknown",e[e.Windows=1]="Windows",e[e.Linux=2]="Linux"}(c=t.RemoteType||(t.RemoteType={}));var d=function(){};t.SessionInfo=d,e=function(){function e(){var e=this;this.isremote_=!1,this.isremote_=!0,this.type_=c.Windows,this.address_="0.0.0.0",this.sessioninfo_=null,n.getRedirector().setRemoteSessionInfoCb(function(){return e.remoteSessionInfo()}),this.enginecontrol_=new i.EngineControl}return e.prototype.release=function(){n.getRedirector().setRemoteSessionInfoCb(null)},e.prototype.user_friendly_id=function(){return"[RemoteSession]"},e.prototype.getFeatureFlags=function(){var e={};return null!==this.enginecontrol_&&null!==this.enginecontrol_.features_&&void 0!==this.enginecontrol_.features_&&this.enginecontrol_.features_.forEach(function(t){e[t.name]=t.value}),e},e.prototype.isFeatureSupported=function(e){if("video"===e)return!0;if(!(e in a.featureNameMap))return!1;e=a.featureNameMap[e];for(var t=this.getFeatureFlags(),n=0;n<e.length;n++)if(!(e[n]in t)||!0!==t[e[n]])return!1;return!0},e.isFeaturePstnSupported=function(){return e.pstn_},e.prototype.getSessionInfo=function(){return o.logger.log(this.user_friendly_id()+".getSessionInfo() called."),null!=this.sessioninfo_?Promise.resolve(this.sessioninfo_):Promise.reject()},e.prototype.remoteSessionInfo=function(){var t=this,a=this;return o.logger.log(a.user_friendly_id()+".remoteSessionInfo() called."),new Promise(function(c,l){a.enginecontrol_.syncBarrier().then(function(n){if(o.logger.log(a.user_friendly_id()+"enginecontrol info received!"),a.sessioninfo_=new d,a.sessioninfo_.type_script=r.HDXMS_VERSION,a.sessioninfo_.webrpc=n.version_.major.toString()+"."+n.version_.minor.toString()+"."+n.version_.revision.toString()+"."+n.version_.build.toString(),void 0!=n.versions_&&null!=n.versions_){a.SendTelemetryData(s.tel_key_VerTypeScript,r.HDXMS_VERSION,0);for(var l=0,u=0,g=n.versions_;u<g.length;u++){var _=(_=g[u]).major.toString()+"."+_.minor.toString()+"."+_.revision.toString()+"."+_.build.toString();switch(l){case i.VersionType.Webrpc:a.sessioninfo_.webrpc=_,a.SendTelemetryData(s.tel_key_VerWebrpc,_,0);break;case i.VersionType.WebrtcCodecs:a.sessioninfo_.webrtc_codecs=_,a.SendTelemetryData(s.tel_key_VerWebrtcCodecs,_,0);break;case i.VersionType.Receiver:a.sessioninfo_.receiver=_,a.SendTelemetryData(s.tel_key_VerReceiver,_,0);break;case i.VersionType.Vda:a.sessioninfo_.vda=_,a.SendTelemetryData(s.tel_key_VerVda,_,0);break;case i.VersionType.Endpoint:a.sessioninfo_.endpoint=_,a.SendTelemetryData(s.tel_key_VerEndpoint,_,0);break;default:o.logger.log(a.user_friendly_id()+"Unknown version type!")}l++}}void 0!=n.osinfo_&&null!=n.osinfo_&&(a.sessioninfo_.osinfo=n.osinfo_,a.SendTelemetryData(s.tel_key_OSFamily,n.osinfo_.family,0),a.SendTelemetryData(s.tel_key_OSVersion,n.osinfo_.version,0),a.SendTelemetryData(s.tel_key_OSArchitecture,n.osinfo_.architecture,0),a.SendTelemetryData(s.tel_key_OSDistro,n.osinfo_.distro,0),a.SendTelemetryData(s.tel_key_OSEdition,n.osinfo_.edition,0)),void 0!=n.sessionidentifier_&&null!=n.sessionidentifier_&&(a.sessioninfo_.session_identifier=n.sessionidentifier_),e.pstn_=t.isFeatureSupported(r.FEATURE_public_pstn),c(a.sessioninfo_),a.enginecontrol_.release()}).catch(function(){n.getRedirector().isPingActive()?a.retrySessionInfo():(l(),a.enginecontrol_.release(),a.enginecontrol_=null)})})},e.prototype.retrySessionInfo=function(){var e=this;setTimeout(function(){o.logger.log("checking if we are connected..."),e.enginecontrol_.bind(),n.getRedirector().handleRemoteSessionInfo()},15e3)},e.prototype.SendTelemetryData=function(e,t,r){n.getRedirector().telemetry.SendTelemetryData(s.tel_cmd.Data,e,t,r)},e.pstn_=!1,e}(),t.RemoteSession=e}),define("rtpsender","require exports proxyobject webrpcclassinfo logger remotemedia stats remotesession".split(" "),function(e,t,n,r,i,o,a,s){Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){function t(t,o){var a=e.call(this,t,r.class_id_t.RTCDTMFToneChangeEvent,o,n.ProxyMode.Remote)||this;return i.logger.log(a.user_friendly_id()+".constructor"),a}return __extends(t,e),t.prototype.syncBarrier=function(){return __awaiter(this,void 0,void 0,function(){var e,t,n=this;return __generator(this,function(o){switch(o.label){case 0:return i.logger.log(this.user_friendly_id()+".syncBarrier() called."),[4,this.waitUntilConnected("DTMFToneChangeEvent.syncBarrier")];case 1:return o.sent(),[4,Promise.all([this.remoteInvoke(!1,r.method_id_RTCDTMFToneChangeEvent_t.tone,""),this.remoteInvoke(!1,r.method_id_RTCDTMFToneChangeEvent_t.tone_buffer,"")])];case 2:return t=o.sent(),e=t.map(function(e){return n.param0(e)}),this.tone=e[0],this.tone_buffer_=e[1],[2,this]}})})},Object.defineProperty(t.prototype,"tone_buffer",{get:function(){return this.tone_buffer_},enumerable:!0,configurable:!0}),t}(n.ProxyObject);t.DTMFToneChangeEvent=c;var d=function(e){function t(t,o){var a=e.call(this,t,r.class_id_t.RTCDTMFSender,o,n.ProxyMode.Remote)||this;return i.logger.log(a.user_friendly_id()+".constructor"),a.canInsertDTMF=!0,a.toneBuffer_="",a}return __extends(t,e),t.prototype.insertDTMF=function(e,t,n){var o=this;void 0===t&&(t=100),void 0===n&&(n=70),i.logger.log(this.user_friendly_id()+".insertDTMF() called, tones: "+e),this.waitUntilConnected("DtmfSender.insertDTMF").then(function(){return o.remoteInvoke(!1,r.method_id_RTCDTMFSender_t.insertDTMF,e,t,n)}).then(function(){i.logger.log(o.user_friendly_id()+".insertDTMF() success, tones: "+e)}).catch(function(){i.logger.log(o.user_friendly_id()+".insertDTMF() failed, tones: "+e)})},Object.defineProperty(t.prototype,"ontonechange",{get:function(){return this.ontonechange_},set:function(e){var t=this;i.logger.log(this.user_friendly_id()+".set_ontonechange() called."),this.ontonechange_=e,this.waitUntilConnected("DtmfSender.ontonechange").then(function(){var n=t.registerCallbacks(!1,t.isNullCallback(e),r.method_id_RTCDTMFSender_t.ontonechange);return n.then(function(e){i.logger.log(t.user_friendly_id()+".ontonechange callback received!"),new c(t,t.param0(e).oid).syncBarrier().then(function(e){i.logger.log(t.user_friendly_id()+"tone: "+e.tone+" tone_buffer: "+e.tone_buffer),t.toneBuffer_=e.tone_buffer,t.ontonechange_(e)}).catch(function(){i.logger.log(t.user_friendly_id()+"toneEvt.syncBarrier(): failed!")})}),t.remoteInvoke(!0,r.method_id_RTCDTMFSender_t.ontonechange,n.success)}).catch(function(){i.logger.log(t.user_friendly_id()+".set_ontonechange(): failed!")})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"toneBuffer",{get:function(){return i.logger.log(this.user_friendly_id()+".toneBuffer() called."),this.toneBuffer_},enumerable:!0,configurable:!0}),t}(n.ProxyObject);t.DtmfSender=d;var l=function(e){function t(t,o){var a=e.call(this,t,r.class_id_t.RTCIceTransport,o,n.ProxyMode.Remote)||this;return i.logger.log(a.user_friendly_id()+".constructor"),a.selectedPair=null,a.localCandidates_=[],a.remoteCandidates_=[],a}return __extends(t,e),t.prototype.syncBarrier=function(){return __awaiter(this,void 0,void 0,function(){var e,n,o,a,s=this;return __generator(this,function(c){switch(c.label){case 0:return i.logger.log(this.user_friendly_id()+".syncBarrier() called."),[4,this.waitUntilConnected("IceTransport.syncBarrier")];case 1:return c.sent(),[4,Promise.all([this.remoteInvoke(!1,r.method_id_RTCIceTransport_t.role,0),this.remoteInvoke(!1,r.method_id_RTCIceTransport_t.component,0),this.remoteInvoke(!1,r.method_id_RTCIceTransport_t.state,0),this.remoteInvoke(!1,r.method_id_RTCIceTransport_t.gatheringState,0)])];case 2:return n=c.sent(),a=o=0,e=n.map(function(e){return s.param0(e)}),this.role_=e[0],this.component_=e[1],o=e[2],a=e[3],this.state_=t.convertState(o),this.gatheringState_=t.convertGatheringState(a),this.syncCandidates().then(function(e){i.logger.log(s.user_friendly_id()+"received updated ice candidates!")}),[2,this]}})})},t.prototype.syncCandidates=function(){return __awaiter(this,void 0,void 0,function(){var e,t,n=this;return __generator(this,function(o){switch(o.label){case 0:return i.logger.log(this.user_friendly_id()+".syncCandidates() called."),[4,this.waitUntilConnected("IceTransport.syncCandidates")];case 1:return o.sent(),[4,Promise.all([this.remoteInvoke(!1,r.method_id_RTCIceTransport_t.localcandidates,[]),this.remoteInvoke(!1,r.method_id_RTCIceTransport_t.remotecandidates,[])])];case 2:return t=o.sent(),e=t.map(function(e){return n.param0(e)}),this.localCandidates_=e[0],this.remoteCandidates_=e[1],[2,this]}})})},Object.defineProperty(t.prototype,"role",{get:function(){return this.role_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"component",{get:function(){return this.component_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"State",{get:function(){return this.state_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"gatheringState",{get:function(){return this.gatheringState_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onstatechange",{get:function(){return this.onstatechange_},set:function(e){var n=this;i.logger.log(this.user_friendly_id()+".set_onstatechange() called."),this.onstatechange_=e,this.waitUntilConnected("IceTransport.onstatechange").then(function(){var o=n.registerCallbacks(!1,n.isNullCallback(e),r.method_id_RTCIceTransport_t.onstatechange);return o.then(function(e){i.logger.log(n.user_friendly_id()+".onstatechange callback received!"),n.syncCandidates().then(function(e){i.logger.log(n.user_friendly_id()+"received updated ice candidates!")}),n.state_=t.convertState(n.param0(e)),i.logger.log(n.user_friendly_id()+"state: "+n.state_),n.onstatechange_()}),n.remoteInvoke(!0,r.method_id_RTCIceTransport_t.onstatechange,o.success)}).catch(function(){i.logger.log(n.user_friendly_id()+".set_onstatechange failed!")})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ongatheringstatechange",{get:function(){return this.ongatheringstatechange_},set:function(e){var n=this;i.logger.log(this.user_friendly_id()+".set_ongatheringstatechange() called."),this.ongatheringstatechange_=e,this.waitUntilConnected("IceTransport.ongatheringstatechange").then(function(){var o=n.registerCallbacks(!1,n.isNullCallback(e),r.method_id_RTCIceTransport_t.ongatheringstatechange);return o.then(function(e){i.logger.log(n.user_friendly_id()+".ongatheringstatechange callback received!"),n.syncCandidates().then(function(e){i.logger.log(n.user_friendly_id()+"received updated ice candidates!")}),n.gatheringState_=t.convertGatheringState(n.param0(e)),i.logger.log(n.user_friendly_id()+"gatheringState: "+n.gatheringState_),n.ongatheringstatechange_()}),n.remoteInvoke(!0,r.method_id_RTCIceTransport_t.ongatheringstatechange,o.success)}).catch(function(){i.logger.log(n.user_friendly_id()+".set_ongatheringstatechange failed!")})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onselectedcandidatepairchange",{get:function(){return this.onselectedcandidatepairchange_},set:function(e){var t=this;i.logger.log(this.user_friendly_id()+".set_onselectedcandidatepairchange() called."),this.onselectedcandidatepairchange_=e,this.waitUntilConnected("IceTransport.onselectedcandidatepairchange").then(function(){var n=t.registerCallbacks(!1,t.isNullCallback(e),r.method_id_RTCIceTransport_t.onselectedcandidatepairchange);return n.then(function(e){i.logger.log(t.user_friendly_id()+".onselectedcandidatepairchange callback received!"),t.syncCandidates().then(function(e){i.logger.log(t.user_friendly_id()+"received updated ice candidates!")}),t.selectedPair=t.param0(e),i.logger.log(t.user_friendly_id()+"selectedPair: "+t.selectedPair),t.onselectedcandidatepairchange_()}),t.remoteInvoke(!0,r.method_id_RTCIceTransport_t.onselectedcandidatepairchange,n.success)}).catch(function(){i.logger.log(t.user_friendly_id()+".set_onselectedcandidatepairchange failed!")})},enumerable:!0,configurable:!0}),t.prototype.getLocalCandidates=function(){return this.localCandidates_},t.prototype.getRemoteCandidates=function(){return this.remoteCandidates_},t.prototype.getLocalParameters=function(){return null},t.prototype.getRemoteParameters=function(){return null},t.prototype.getSelectedCandidatePair=function(){return this.selectedPair},t.convertState=function(e){return 0==e?"new":1==e?"checking":2==e?"connected":3==e?"completed":4==e?"failed":5==e?"disconnected":"closed"},t.convertGatheringState=function(e){return 0==e?"new":1==e?"gathering":"complete"},t}(n.ProxyObject);t.IceTransport=l;var u;!function(e){e[e.new=0]="new",e[e.connecting=1]="connecting",e[e.connected=2]="connected",e[e.closed=3]="closed",e[e.failed=4]="failed",e[e.max=5]="max"}(u||(u={}));var g=function(e){function t(t,o){var a=e.call(this,t,r.class_id_t.RTCDtlsTransport,o,n.ProxyMode.Remote)||this;return i.logger.log(a.user_friendly_id()+".constructor"),a.state_="new",a.transport_=null,a.remoteCertificates_=[],a}return __extends(t,e),t.prototype.syncBarrier=function(){return __awaiter(this,void 0,void 0,function(){var e,t,n,o,a,s=this;return __generator(this,function(c){switch(c.label){case 0:return i.logger.log(this.user_friendly_id()+".syncBarrier() called."),[4,Promise.all([this.remoteInvoke(!1,r.method_id_RTCDtlsTransport_t.transport,{}),this.remoteInvoke(!1,r.method_id_RTCDtlsTransport_t.getRemoteCertificates,[])])];case 1:return t=c.sent(),e=t.map(function(e){return s.param0(e)}),n=e[0],this.remoteCertificates_=e[1],void 0==n||0!=n.is_null?[3,3]:(o=new l(this,n.oid),a=this,[4,o.syncBarrier()]);case 2:a.transport_=c.sent(),c.label=3;case 3:return[2,this]}})})},Object.defineProperty(t.prototype,"transport",{get:function(){return this.transport_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"State",{get:function(){return this.state_},enumerable:!0,configurable:!0}),t.prototype.getRemoteCertificates=function(){return this.remoteCertificates_},Object.defineProperty(t.prototype,"onstatechange",{get:function(){return this.onstatechange_},set:function(e){var n=this;i.logger.log(this.user_friendly_id()+".set_onstatechange() called."),this.onstatechange_=e,this.waitUntilConnected("DtlsTransport.onstatechange").then(function(){var o=n.registerCallbacks(!1,n.isNullCallback(e),r.method_id_RTCDtlsTransport_t.onstatechange);return o.then(function(e){i.logger.log(n.user_friendly_id()+".onstatechange callback received!"),n.state_=t.convertState(n.param0(e)),i.logger.log(n.user_friendly_id()+"state_: "+n.state_),n.onstatechange_()}),n.remoteInvoke(!0,r.method_id_RTCDtlsTransport_t.onstatechange,o.success)}).catch(function(){})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onerror",{get:function(){return this.onerror_},set:function(e){var t=this;i.logger.log(this.user_friendly_id()+".set_onerror() called."),this.onerror_=e,this.waitUntilConnected("DtlsTransport.onerror").then(function(){var n=t.registerCallbacks(!1,t.isNullCallback(e),r.method_id_RTCDtlsTransport_t.onerror);return n.then(function(e){i.logger.log(t.user_friendly_id()+".onerror callback received!"),e=t.param0(e),i.logger.log(t.user_friendly_id()+"error: "+e),t.onerror_(e)}),t.remoteInvoke(!0,r.method_id_RTCDtlsTransport_t.onerror,n.success)}).catch(function(){})},enumerable:!0,configurable:!0}),t.convertState=function(e){return e==u.new?"new":e==u.connecting?"connecting":e==u.connected?"connected":e==u.closed?"closed":"failed"},t}(n.ProxyObject);t.DtlsTransport=g,e=function(e){function t(t,n,r,o){return t=e.call(this,t,n,r,o)||this,i.logger.log(t.user_friendly_id()+".constructor base"),t.track_=null,t.transport_=null,t.rtcpTransport_=null,t.capabilities_=null,t}return __extends(t,e),t.prototype.syncBarrierBase=function(){return __awaiter(this,void 0,void 0,function(){var e,t,n,a,c,d,l,u,m,f,p,y,v=this;return __generator(this,function(C){switch(C.label){case 0:return i.logger.log(this.user_friendly_id()+".syncBarrierBase() called."),[4,this.waitUntilConnected("RtpSenderReceiver.syncBarrierBase")];case 1:return C.sent(),this instanceof _?(t=r.method_id_RTCRtpSender_t.track,n=r.method_id_RTCRtpSender_t.transport,a=r.method_id_RTCRtpSender_t.rtcpTransport,c=r.method_id_RTCRtpSender_t.getCapabilities):this instanceof h&&(t=r.method_id_RTCRtpReceiver_t.track,n=r.method_id_RTCRtpReceiver_t.transport,a=r.method_id_RTCRtpReceiver_t.rtcpTransport,c=r.method_id_RTCRtpReceiver_t.getCapabilities),s.RemoteSession.isFeaturePstnSupported()?[4,Promise.all([this.remoteInvoke(!1,t,{oid:this.object_id()}),this.remoteInvoke(!1,n,{oid:this.object_id()}),this.remoteInvoke(!1,a,{oid:this.object_id()}),this.remoteInvoke(!1,c,{oid:this.object_id()})])]:[3,3];case 2:return d=C.sent(),[3,5];case 3:return[4,Promise.all([this.remoteInvoke(!1,t,{oid:this.object_id()})])];case 4:d=C.sent(),C.label=5;case 5:return e=d.map(function(e){return v.param0(e)}),l=e[0],u=e[1],m=e[2],this.capabilities_=e[3],f=this,[4,Promise.all(d.map(function(){return void 0==l||!1!==l.is_null||null!==v.track&&v.track_.object_id()==l.oid?new Promise(function(e,t){e(null)}):new o.RemoteMediaTrack(v,l.oid).syncBarrier()})).catch(function(){return i.logger.log(v.user_friendly_id()+"track.syncBarrier(): failed!"),null})];case 6:return f.track_=C.sent()[0],p=this,[4,Promise.all(d.map(function(){return void 0==u||!1!==u.is_null||null!==v.transport_&&v.transport_.object_id()==u.oid?new Promise(function(e,t){e(null)}):new g(v,u.oid).syncBarrier()})).catch(function(){return i.logger.log(v.user_friendly_id()+"transport.syncBarrier(): failed!"),null})];case 7:return p.transport_=C.sent()[0],y=this,[4,Promise.all(d.map(function(){return void 0==m||!1!==m.is_null||null!==v.rtcpTransport_&&v.rtcpTransport_.object_id()==m.oid?new Promise(function(e,t){e(null)}):new g(v,m.oid).syncBarrier()})).catch(function(){return i.logger.log(v.user_friendly_id()+"rtcpTransport.syncBarrier(): failed!"),null})];case 8:return y.rtcpTransport_=C.sent()[0],[2,new Promise(function(e){e(v)})]}})})},Object.defineProperty(t.prototype,"transport",{get:function(){return i.logger.log(this.user_friendly_id()+".get transport() called."),this.transport_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rtcpTransport",{get:function(){return i.logger.log(this.user_friendly_id()+".get rtcpTransport() called."),this.rtcpTransport_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"track",{get:function(){return i.logger.log(this.user_friendly_id()+".get track() called.track_: "+this.track_),this.track_},enumerable:!0,configurable:!0}),t.prototype.reinitTrack=function(e){this.track_=e},t.prototype.getCapabilities=function(e){return i.logger.log(this.user_friendly_id()+".getCapabilities() called."),this.capabilities_},t.prototype.getStats=function(){i.logger.log(this.user_friendly_id()+".getStats() called.");var e=this;return new Promise(function(t,n){var o=this;e.isRedirected()?e.waitUntilConnected("RtpReceiver.getStats").then(function(){var n;o instanceof _?n=r.method_id_RTCRtpSender_t.getStats:o instanceof h&&(n=r.method_id_RTCRtpReceiver_t.getStats);var i=e.registerCallbacks(!0,!1,n);return i.then(function(e){void 0!==e.params&&0!==e.params.length&&t(a.StatsReport.fromJSON(JSON.parse(e.params[0])))}),e.remoteInvoke(!1,n,i.success)}).catch(function(){i.logger.log(e.user_friendly_id()+".getStats(): failed!"),n()}):(i.logger.log(e.user_friendly_id()+".getStats(): not in active redirection!"),t())})},t}(n.ProxyObject),t.RtpSenderReceiver=e;var _=function(e){function t(t,n,o){return t=e.call(this,t,r.class_id_t.RTCRtpSender,n,o)||this,i.logger.log(t.user_friendly_id()+".constructor"),t.dtmf_=null,t.params_=null,t}return __extends(t,e),t.prototype.syncBarrier=function(){return __awaiter(this,void 0,void 0,function(){var t,n,o,a=this;return __generator(this,function(s){switch(s.label){case 0:return i.logger.log(this.user_friendly_id()+".syncBarrier() called."),[4,e.prototype.syncBarrierBase.call(this)];case 1:return s.sent(),[4,this.waitUntilConnected("RtpSender.syncBarrier")];case 2:return s.sent(),[4,Promise.all([this.remoteInvoke(!1,r.method_id_RTCRtpSender_t.dtmf,{oid:this.object_id()}),this.remoteInvoke(!1,r.method_id_RTCRtpSender_t.getParameters,{oid:this.object_id()})])];case 3:return n=s.sent(),t=n.map(function(e){return a.param0(e)}),o=t[0],this.params_=t[1],void 0==o||!1!==o.is_null||null!==this.dtmf_&&this.dtmf_.object_id()==o.oid||(this.dtmf_=new d(this,o.oid)),[2,new Promise(function(e){e(a)})]}})})},Object.defineProperty(t.prototype,"dtmf",{get:function(){return i.logger.log(this.user_friendly_id()+".get dtmf() called."),this.dtmf_},enumerable:!0,configurable:!0}),t.prototype.setParameters=function(e){var t=this;return i.logger.log(this.user_friendly_id()+".setParameters() called."),new Promise(function(n,o){t.waitUntilConnected("RtpSender.setParameters").then(function(){return Promise.all([t.remoteInvoke(!1,r.method_id_RTCRtpSender_t.setParameters,e)])}).then(function(r){i.logger.log(t.user_friendly_id()+".setParameters(): success."),n(),t.params_=e}).catch(function(){i.logger.log(t.user_friendly_id()+".setParameters(): rejected."),o()})})},t.prototype.getParameters=function(){return i.logger.log(this.user_friendly_id()+".getParameters() called."),this.params_},t.prototype.replaceTrack=function(e){var t=this;return i.logger.log(this.user_friendly_id()+".replaceTrack() called."),new Promise(function(n,o){t.waitUntilConnected("RtpSender.replaceTrack").then(function(){return Promise.all([t.remoteInvoke(!1,r.method_id_RTCRtpSender_t.replaceTrack,{oid:e.object_id()})])}).then(function(r){i.logger.log(t.user_friendly_id()+".replaceTrack(): success."),n(),t.reinitTrack(e)}).catch(function(){i.logger.log(t.user_friendly_id()+".setParameters(): rejected."),o()})})},t}(e);t.RtpSender=_;var h=function(e){function t(t,o){var a=e.call(this,t,r.class_id_t.RTCRtpReceiver,o,n.ProxyMode.Remote)||this;return i.logger.log(a.user_friendly_id()+".constructor"),a.contribsources_=[],a.syncsources_=[],a.params_=null,a}return __extends(t,e),t.prototype.syncBarrier=function(){return __awaiter(this,void 0,void 0,function(){var t,n,o=this;return __generator(this,function(a){switch(a.label){case 0:return i.logger.log(this.user_friendly_id()+".syncBarrier() called."),[4,e.prototype.syncBarrierBase.call(this)];case 1:return a.sent(),[4,this.waitUntilConnected("RtpReceiver.syncBarrier")];case 2:return a.sent(),s.RemoteSession.isFeaturePstnSupported()?[4,Promise.all([this.remoteInvoke(!1,r.method_id_RTCRtpReceiver_t.getContributingSources,[]),this.remoteInvoke(!1,r.method_id_RTCRtpReceiver_t.getSynchronizationSources,[]),this.remoteInvoke(!1,r.method_id_RTCRtpReceiver_t.getParameters,{oid:this.object_id()})])]:[3,4];case 3:return n=a.sent(),[3,6];case 4:return[4,Promise.all([this.remoteInvoke(!1,r.method_id_RTCRtpReceiver_t.getContributingSources,[])])];case 5:n=a.sent(),a.label=6;case 6:return t=n.map(function(e){return o.param0(e)}),this.contribsources_=t[0],this.syncsources_=t[1],this.params_=t[2],[2,new Promise(function(e){e(o)})]}})})},t.prototype.getContributingSources=function(){var e=this;return i.logger.log(this.user_friendly_id()+".getContributingSources() called. "+JSON.stringify(this.contribsources_)),this.waitUntilConnected("RtpReceiver.getContributingSources").then(function(){return Promise.all([e.remoteInvoke(!1,r.method_id_RTCRtpReceiver_t.getContributingSources,[])])}).then(function(t){e.contribsources_=t.map(function(t){return e.param0(t)})[0]}).catch(function(){i.logger.log(e.user_friendly_id()+".getContributingSources() didnt get response."),e.contribsources_=[]}),this.contribsources_},t.prototype.getParameters=function(){return i.logger.log(this.user_friendly_id()+".getParameters() called."),this.params_},t.prototype.getSynchronizationSources=function(){return i.logger.log(this.user_friendly_id()+".getSynchronizationSources() called."),this.syncsources_},t}(e);t.RtpReceiver=h}),define("map",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}),define("rtptransceiver","require exports proxyobject webrpcclassinfo logger rtpsender".split(" "),function(e,t,n,r,i,o){Object.defineProperty(t,"__esModule",{value:!0}),e=function(e){function t(t,o){var a=e.call(this,t,r.class_id_t.RTCRtpTransceiver,o,n.ProxyMode.Remote)||this;return i.logger.log(a.user_friendly_id()+".constructor"),a.sender_=null,a.receiver_=null,a}return __extends(t,e),t.prototype.syncBarrier=function(){return __awaiter(this,void 0,void 0,function(){var e,t,a,s,c,d,l,u,g=this;return __generator(this,function(_){switch(_.label){case 0:return i.logger.log(this.user_friendly_id()+".syncBarrier() called."),[4,Promise.all([this.remoteInvoke(!1,r.method_id_RTCRtpTransceiver_t.sender,{}),this.remoteInvoke(!1,r.method_id_RTCRtpTransceiver_t.receiver,{})])];case 1:return t=_.sent(),e=t.map(function(e){return g.param0(e)}),a=e[0],s=e[1],void 0==a||!1!==a.is_null||null!==this.sender_&&this.sender_.object_id()==a.oid?[3,3]:(c=new o.RtpSender(this,a.oid,n.ProxyMode.Remote),d=this,[4,c.syncBarrier().catch(function(){return i.logger.log(g.user_friendly_id()+"sender.syncBarrier(): failed!"),null})]);case 2:d.sender_=_.sent(),_.label=3;case 3:return void 0==s||!1!==s.is_null||null!==this.receiver_&&this.receiver_.object_id()==s.oid?[3,5]:(l=new o.RtpReceiver(this,s.oid),u=this,[4,l.syncBarrier().catch(function(){return i.logger.log(g.user_friendly_id()+"receiver.syncBarrier(): failed!"),null})]);case 4:u.receiver_=_.sent(),_.label=5;case 5:return[2,this]}})})},Object.defineProperty(t.prototype,"mid",{get:function(){return this.mid_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sender",{get:function(){return this.sender_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"receiver",{get:function(){return this.receiver_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"direction",{get:function(){return this.direction_},set:function(e){var t=this;i.logger.log(this.user_friendly_id()+".se_direction() called."),this.waitUntilConnected("RtpTransceiver.set_direction").then(function(){return t.remoteInvoke(!0,r.method_id_RTCRtpTransceiver_t.direction,t.toRtpDirection(e))}).then(function(){t.direction_=e}).catch(function(){i.logger.log(t.user_friendly_id()+".set_direction: failed.")})},enumerable:!0,configurable:!0}),t.prototype.stop=function(){var e=this;i.logger.log(this.user_friendly_id()+".stop() called."),this.waitUntilConnected("RtpTransceiver.stop").then(function(){return e.remoteInvoke(!0,r.method_id_RTCRtpTransceiver_t.stop)}).then(function(){i.logger.log(e.user_friendly_id()+".stop: success.")}).catch(function(){i.logger.log(e.user_friendly_id()+".stop: failed.")})},t.prototype.setCodecPreferences=function(e){var t=this;i.logger.log(this.user_friendly_id()+".setCodecPreferences() called."),this.waitUntilConnected("RtpTransceiver.setCodecPreferences").then(function(){return t.remoteInvoke(!0,r.method_id_RTCRtpTransceiver_t.setCodecPreferences,e)}).then(function(){i.logger.log(t.user_friendly_id()+".setCodecPreferences: success.")}).catch(function(){i.logger.log(t.user_friendly_id()+".setCodecPreferences: failed.")})},t.prototype.toRTCRtpDirection=function(e){var t="inactive";return 0==e?t="sendrecv":1==e?t="sendonly":2==e?t="recvonly":3==e&&(t="inactive"),t},t.prototype.toRtpDirection=function(e){var t=3;return"sendrecv"==e?t=0:"sendonly"==e?t=1:"recvonly"==e?t=2:"inactive"==e&&(t=3),t},t}(n.ProxyObject),t.RtpTransceiver=e}),define("peerconnection","require exports hdxms remotemedia rtpsender proxyobject icecandidate rtptransceiver webrpcclassinfo logger stats telemetry".split(" "),function(e,t,n,r,i,o,a,s,c,d,l,u){Object.defineProperty(t,"__esModule",{value:!0});var g=function(e){function t(t,n,r){return t=e.call(this,t,c.class_id_t.RTCIceCandidateEvent,n,o.ProxyMode.Remote)||this,t.target=r,t.type="icecandidate",t}return __extends(t,e),Object.defineProperty(t.prototype,"candidate",{get:function(){return this.candidate_},enumerable:!0,configurable:!0}),t.prototype.syncBarrier=function(){var e=this;return d.logger.log(this.user_friendly_id()+".syncBarrier() called."),new Promise(function(t,n){e.waitUntilConnected(e.user_friendly_id()+".syncBarrier").then(function(){return e.remoteInvoke(!1,c.method_id_RTCIceCandidateEvent_t.candidate,{oid:0})}).then(function(t){return!1===(t=e.param0(t)).is_null?new a.IceCandidate(e,t.oid).syncBarrier():Promise.resolve(null)}).then(function(n){d.logger.log(e.user_friendly_id()+".onicecandidate: icecandidate available!"),e.candidate_=n,t(e)}).catch(function(){d.logger.log(e.user_friendly_id()+".onicecandidate() failed."),n()})})},t}(o.ProxyObject);t.IceCandidateEvent=g;var _=function(){function e(e){this.state_="new",this.candidates_=[],this.pc_=e}return e.prototype.pushState=function(e){d.logger.log(this.pc_.user_friendly_id()+".onicegatheringstatechange: new state is "+e),this.state_=e,"gathering"==this.state_?(this.candidates_=[],this.postUpdate()):this.processRemaining()},e.prototype.addIceCandidate=function(e){var t=this;this.candidates_.push(e),e.syncBarrier().then(function(e){return d.logger.log(t.pc_.user_friendly_id()+".onicecandidate: icecandidate available!"),Promise.all([t.pc_.updateLocalDescription(),Promise.resolve(e)])}).then(function(e){t.postIceCandidate(e[1])})},e.prototype.postIceCandidate=function(e){d.logger.log(this.pc_.user_friendly_id()+".onicecandidate: posting ice candidate now!"),null!=this.pc_.onicecandidate?this.pc_.onicecandidate(e):d.logger.log(this.pc_.user_friendly_id()+"onicecandidate is NULL!!!"),this.candidates_.shift(),this.processRemaining()},e.prototype.postUpdate=function(){d.logger.log(this.pc_.user_friendly_id()+".onicegatheringstatechange: posting event now!");var e=new m("onicegatheringstatechange",this.pc_);this.pc_.onicegatheringstatechange(e)},e.prototype.processRemaining=function(){0==this.candidates_.length&&"complete"==this.state_?(this.pc_.onicecandidate({candidate:null,target:this}),this.postUpdate()):d.logger.log(this.pc_.user_friendly_id()+".onicecandidate: candidates remaining=["+this.candidates_.map(function(e){return e.object_id()})+"], state="+this.state_)},e}(),h=function(e){function t(t,n,r){for(var i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return e.apply(this,[t,c.class_id_t.RTCSessionDescription,n,r,null].concat(i))||this}return __extends(t,e),t.prototype.toJSON=function(){return{type:this.type_,sdp:this.sdp_}},Object.defineProperty(t.prototype,"sdp",{get:function(){return this.sdp_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this.type_},enumerable:!0,configurable:!0}),t.prototype.syncBarrier=function(){var e=this;return d.logger.log(this.user_friendly_id()+".syncBarrier() called."),new Promise(function(t,n){e.waitUntilConnected(e.user_friendly_id()+".syncBarrier").then(function(){return Promise.all([e.remoteInvoke(!1,c.method_id_RTCSessionDescription_t.type,0),e.remoteInvoke(!1,c.method_id_RTCSessionDescription_t.sdp,"")])}).then(function(n){e.type_=e.convertType(e.param0(n[0])),e.sdp_=e.param0(n[1]),t(e)}).catch(function(){n()})})},t.prototype.convertType=function(e){return 0==e?"offer":1==e?"pranswer":"answer"},t.convertC2H=function(e){return"offer"==e?0:"pranswer"==e?1:2},t}(o.ProxyObject);t.SessionDescription=h;var m=function(e,t){this.type=e,this.target=t},f=function(){},p=function(){function e(e,t){this.local=e,this.remote=t}return Object.defineProperty(e.prototype,"active",{get:function(){var e=!1;return 1!=this.local&&1!=this.remote||(e=!0),e},enumerable:!0,configurable:!0}),e}();e=function(e){function t(t){return t=e.call(this,null,c.class_id_t.RTCPeerConnection,0,o.ProxyMode.Local,null,void 0!=t?t:{},{})||this,t.timeerstarted_=!1,t.firsttimeremoteoffer_=!1,t.firststable_=!1,t.firsttimelocaloffer_=!1,t.audiocall_=new p(!1,!1),t.videocall_=new p(!1,!1),t.screensharingcall_=new p(!1,!1),t.conferencecall_=!1,t.incomingcall_=!1,t.outgoingcall_=!1,d.logger.log(t.user_friendly_id()+".constructor"),t.localStreams=[],t.remoteStreams=[],t.onaddstream_=null,t.signalingState_="stable",t.iceConnectionState_="new",t.iceGatheringState_="new",t.iceQ_=new _(t),t.receivers_=[],t.senders_=[],t.registerStateChangeNotification(t.onStateChange),t}return __extends(t,e),t.prototype.onStateChange=function(){var e=new m("iceconnectionstatechange",this);this.oniceconnectionstatechange_&&this.oniceconnectionstatechange_(e)},t.prototype.addIceCandidate=function(){d.logger.log(this.user_friendly_id()+".addIceCandidate"),d.logger.log(arguments)},Object.defineProperty(t.prototype,"onicecandidate",{get:function(){return this.onicecandidate_},set:function(e){var t=this;d.logger.log(this.user_friendly_id()+".set_onicecandidate() called."),this.onicecandidate_=e,this.waitUntilConnected(this.user_friendly_id()+".onicecandidate").then(function(){var n=t.registerCallbacks(!1,t.isNullCallback(e),c.method_id_RTCPeerConnection_t.onicecandidate);return n.then(function(e){d.logger.log(t.user_friendly_id()+".onicecandidate callback received!!!"),e=new g(t,t.param0(e).oid,t),null!=t.iceQ_&&t.iceQ_.addIceCandidate(e)}),t.remoteInvoke(!0,c.method_id_RTCPeerConnection_t.onicecandidate,n.success)}).catch(function(){d.logger.log(t.user_friendly_id()+".set_onicecandidate() failed.")})},enumerable:!0,configurable:!0}),t.prototype.convertIceConnectionState=function(e){return 0==e?"new":1==e?"checking":2==e?"connected":3==e?"completed":4==e?"failed":5==e?"disconnected":"closed"},Object.defineProperty(t.prototype,"oniceconnectionstatechange",{get:function(){return this.oniceconnectionstatechange_},set:function(e){var t=this;d.logger.log(this.user_friendly_id()+".set_oniceconnectionstatechange() called."),this.oniceconnectionstatechange_=e,this.waitUntilConnected(this.user_friendly_id()+".oniceconnectionstatechange").then(function(){var n=t.registerCallbacks(!1,t.isNullCallback(e),c.method_id_RTCPeerConnection_t.oniceconnectionstatechange);return n.then(function(e){d.logger.log(t.user_friendly_id()+".oniceconnectionstatechange(): success callback received!!!"),t.iceConnectionState_=t.convertIceConnectionState(t.param0(e)),e=new m("iceconnectionstatechange",t),t.oniceconnectionstatechange_(e)}),t.remoteInvoke(!0,c.method_id_RTCPeerConnection_t.oniceconnectionstatechange,n.success)}).catch(function(){d.logger.log(t.user_friendly_id()+".set_oniceconnectionstatechange() failed.")})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"iceConnectionState",{get:function(){return d.logger.log(this.user_friendly_id()+".get_iceConnectionState() called, value = "+this.iceConnectionState_),this.isRedirected()?this.iceConnectionState_:"failed"},enumerable:!0,configurable:!0}),t.prototype.convertIceGatheringState=function(e){return 0==e?"new":1==e?"gathering":"complete"},Object.defineProperty(t.prototype,"onicegatheringstatechange",{get:function(){return this.onicegatheringstatechange_},set:function(e){var t=this;d.logger.log(this.user_friendly_id()+".set_onicegatheringstatechange() called."),this.onicegatheringstatechange_=e,this.waitUntilConnected(this.user_friendly_id()+".onicegatheringstatechange").then(function(){var n=t.registerCallbacks(!1,t.isNullCallback(e),c.method_id_RTCPeerConnection_t.onicegatheringstatechange);return n.then(function(e){d.logger.log(t.user_friendly_id()+".onicegatheringstatechange(): callback received!!!"),t.iceGatheringState_=t.convertIceGatheringState(t.param0(e)),null!=t.iceQ_&&t.iceQ_.pushState(t.iceGatheringState_)}),t.remoteInvoke(!0,c.method_id_RTCPeerConnection_t.onicegatheringstatechange,n.success)}).catch(function(){d.logger.log(t.user_friendly_id()+".set_onicegatheringstatechange() failed.")})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"iceGatheringState",{get:function(){return d.logger.log(this.user_friendly_id()+".get_iceGatheringState() called, value = "+this.iceGatheringState_),this.iceGatheringState_},enumerable:!0,configurable:!0}),t.prototype.convertSignalState=function(e){return 0==e?"stable":1==e?"have-local-offer":2==e?"have-local-pranswer":3==e?"have-remote-offer":4==e?"have-remote-pranswer":"closed"},t.prototype.TelemtryReadings_=function(){if("have-local-offer"==this.signalingState_&&0==this.firsttimelocaloffer_&&0==this.firsttimeremoteoffer_&&(this.outgoingcallstart_=(new Date).getTime(),0==this.outgoingcall_&&(this.SendTelemetryData(u.tel_key_PerfCallState,u.tel_CallState.active,1),this.SendTelemetryData(u.tel_key_PerfCallDirection,u.tel_CallDirection.outgoing,1),this.outgoingcall_=!0),this.firsttimelocaloffer_=!0),"have-remote-offer"==this.signalingState_&&0==this.firsttimeremoteoffer_&&0==this.firsttimelocaloffer_&&(this.incomingcallstart_=(new Date).getTime(),0==this.incomingcall_&&(this.SendTelemetryData(u.tel_key_PerfCallState,u.tel_CallState.active,1),this.SendTelemetryData(u.tel_key_PerfCallDirection,u.tel_CallDirection.incoming,1),this.incomingcall_=!0),this.firsttimeremoteoffer_=!0),"stable"==this.signalingState_&&0==this.firststable_&&(this.callstartTime_=(new Date).getTime(),this.firststable_=this.timeerstarted_=!0),"stable"==this.signalingState_){for(var e=0,t=this.localStreams;e<t.length;e++){var n=t[e];if(1<=n.getAudioTracks().length&&0==this.audiocall_.local&&(this.SendTelemetryData(u.tel_key_PerfCallType,u.tel_CallType.audio,1),this.audiocall_.local=!0),1<=(n=n.getVideoTracks()).length)for(var r=0,i=n;r<i.length;r++)1==(n=i[r]).getSettings().deviceId.includes("display")?0==this.screensharingcall_.local&&(this.SendTelemetryData(u.tel_key_PerfCallType,u.tel_CallType.dshare,1),this.screensharingcall_.local=!0):0==this.videocall_.local&&(this.SendTelemetryData(u.tel_key_PerfCallType,u.tel_CallType.video,1),this.videocall_.local=!0)}for(e=0,t=this.remoteStreams;e<t.length;e++)if(1<=(n=t[e]).getAudioTracks().length&&0==this.audiocall_.remote&&(this.SendTelemetryData(u.tel_key_PerfCallType,u.tel_CallType.audio,1),this.audiocall_.remote=!0),1<=(r=n.getVideoTracks()).length)for(n=0;n<r.length;n++)1==r[n].id.includes("applicationsharingVideo")?0==this.screensharingcall_.remote&&(this.SendTelemetryData(u.tel_key_PerfCallType,u.tel_CallType.dshare,1),this.screensharingcall_.remote=!0):0==this.videocall_.remote&&(this.SendTelemetryData(u.tel_key_PerfCallType,u.tel_CallType.video,1),this.videocall_.remote=!0);2<this.getReceivers().length&&0==this.conferencecall_&&(this.SendTelemetryData(u.tel_key_PerfCallType,u.tel_CallType.multi,1),this.conferencecall_=!0)}},Object.defineProperty(t.prototype,"onsignalingstatechange",{set:function(e){var t=this;d.logger.log(this.user_friendly_id()+".set_onsignalingstatechange() called."),this.onsignalingstatechange_=e,this.waitUntilConnected(this.user_friendly_id()+".onsignalingstatechanged").then(function(){var n=t.registerCallbacks(!1,t.isNullCallback(e),c.method_id_RTCPeerConnection_t.onsignalingstatechange);return n.then(function(e){d.logger.log(t.user_friendly_id()+".onsignalingstatechange(): callback received!!!"),t.signalingState_=t.convertSignalState(t.param0(e)),e=new m("onsignalingstatechange",t),t.onsignalingstatechange_(e),t.TelemtryReadings_()}),t.remoteInvoke(!0,c.method_id_RTCPeerConnection_t.onsignalingstatechange,n.success)}).catch(function(){d.logger.log(t.user_friendly_id()+".set_onsignalingstatechange(): failed.")})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onsignalingstatechanged",{get:function(){return this.onsignalingstatechange_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ontrack",{get:function(){return this.ontrack_},set:function(e){var t=this;d.logger.log(this.user_friendly_id()+".set_ontrack() called."),this.ontrack_=e,this.waitUntilConnected(this.user_friendly_id()+".ontrack").then(function(){var n=t.registerCallbacks(!1,t.isNullCallback(e),c.method_id_RTCPeerConnection_t.ontrack);return n.then(function(e){return __awaiter(t,void 0,void 0,function(){var t,n,o,a,c,l,u,g,_;return __generator(this,function(h){switch(h.label){case 0:return d.logger.log(this.user_friendly_id()+".ontrack(): callback received!!!"),t=this.param0(e),void 0!==(n=this.receivers_.find(function(e){return!1===t.receiver.is_null&&e.object_id()===t.receiver.oid}))?[3,2]:(n=new i.RtpReceiver(this,t.receiver.oid),[4,n.syncBarrier()]);case 1:h.sent(),this.receivers_.push(n),h.label=2;case 2:return!1!==t.transceiver.is_null||null!==this.transceiver_&&this.transceiver_.object_id()==t.transceiver.oid?[3,4]:(this.transceiver_=new s.RtpTransceiver(this,t.transceiver.oid),[4,this.transceiver_.syncBarrier()]);case 3:h.sent(),h.label=4;case 4:o=[],a=function(e){var t;return __generator(this,function(n){switch(n.label){case 0:return void 0!==(t=c.remoteStreams.find(function(t){return!1===e.is_null&&t.object_id()===e.oid}))?[3,2]:(t=new r.RemoteStream(c,e.oid),[4,t.syncBarrier()]);case 1:n.sent(),n.label=2;case 2:return o.push(t),[2]}})},c=this,l=0,u=t.streams,h.label=5;case 5:return l<u.length?(g=u[l],[5,a(g)]):[3,8];case 6:h.sent(),h.label=7;case 7:return l++,[3,5];case 8:return this.remoteStreams=o,_=new f,_.receiver=n,_.streams=this.remoteStreams,_.transceiver=this.transceiver_,_.track=n.track,d.logger.log(this.user_friendly_id()+".ontrack(): notified!!!"),this.ontrack_(_),[2]}})})}),t.remoteInvoke(!0,c.method_id_RTCPeerConnection_t.ontrack,n.success)}).catch(function(){d.logger.log(t.user_friendly_id()+".set_ontrack(): failed.")})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"signalingState",{get:function(){return d.logger.log(this.user_friendly_id()+".get_signalingState() called, value = "+this.signalingState_),this.signalingState_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onnegotiationneeded",{get:function(){return this.onnegotiationneeded_},set:function(e){var t=this;d.logger.log(this.user_friendly_id()+".set_onnegotiationneeded() called."),this.onnegotiationneeded_=e,this.waitUntilConnected(this.user_friendly_id()+".onnegotiationneeded").then(function(){var n=t.registerCallbacks(!1,t.isNullCallback(e),c.method_id_RTCPeerConnection_t.onnegotiationneeded);return n.then(function(){d.logger.log(t.user_friendly_id()+".onnegotiationneeded(): callback received!!!");var e=new m("negotiationneeded",t);t.onnegotiationneeded_(e)}),t.remoteInvoke(!0,c.method_id_RTCPeerConnection_t.onnegotiationneeded,n.success)}).catch(function(){d.logger.log(t.user_friendly_id()+".set_onnegotiationneeded(): failed.")})},enumerable:!0,configurable:!0}),t.prototype.fix_constraints=function(e){var t={audio:!0,video:!0};return e&&(t.video=e.offerToReceiveVideo,t.audio=e.offerToReceiveAudio),t},t.prototype.createOffer=function(e,t,n){var r=this;d.logger.log(this.user_friendly_id()+".createOffer() called.",JSON.stringify(n)),this.waitUntilConnected(this.user_friendly_id()+".createOffer").then(function(){var e=r.registerCallbacks(!0,!1,c.method_id_RTCPeerConnection_t.createOffer);return r.remoteInvoke(!1,c.method_id_RTCPeerConnection_t.createOffer,e.success,e.fail,r.fix_constraints(n)),e.prom()}).then(function(e){return d.logger.log(r.user_friendly_id()+".createOffer(): success callback received!!!"),new h(r,r.param0(e).oid,o.ProxyMode.Remote).syncBarrier()}).then(function(t){e&&e(t)}).catch(function(e){void 0!=e&&(d.logger.log(r.user_friendly_id()+".createOffer() failed, with error"+r.param0(e)),t&&t(new DOMException("PeerConnection.createOffer() failed with error"+r.param0(e),"PeerConnection")))})},t.prototype.createAnswer=function(e,t,n){var r=this;d.logger.log(this.user_friendly_id()+".createAnswer() called.",JSON.stringify(n)),this.waitUntilConnected(this.user_friendly_id()+".createAnswer").then(function(){var e=r.registerCallbacks(!0,!1,c.method_id_RTCPeerConnection_t.createAnswer);return r.remoteInvoke(!1,c.method_id_RTCPeerConnection_t.createAnswer,e.success,e.fail,r.fix_constraints(n),{}),e.prom()}).then(function(e){return d.logger.log(r.user_friendly_id()+".createAnswer(): success callback received!!!"),new h(r,r.param0(e).oid,o.ProxyMode.Remote).syncBarrier()}).then(function(t){e&&e(t)}).catch(function(){d.logger.log(r.user_friendly_id()+".createAnswer() failed."),t&&t("PeerConnection::createAnswer() failed.")})},t.prototype.updateLocalDescription=function(){return __awaiter(this,void 0,void 0,function(){var e,t,n,r=this;return __generator(this,function(i){switch(i.label){case 0:return d.logger.log(this.user_friendly_id()+".updateLocalDescription() called."),[4,this.remoteInvoke(!1,c.method_id_RTCPeerConnection_t.localDescription,{oid:this.object_id()})];case 1:return e=i.sent(),t=new h(this,this.param0(e).oid,o.ProxyMode.Remote),[4,t.syncBarrier().catch(function(){return d.logger.log(r.user_friendly_id()+"sdp.syncBarrier(): failed!"),null})];case 2:return this.localDescription=n=i.sent(),[2]}})})},t.prototype.setLocalDescription=function(e,t,n){var r=this;d.logger.log(this.user_friendly_id()+".setLocalDescription() called."),this.waitUntilConnected(this.user_friendly_id()+".setLocalDescription").then(function(){return new h(r,0,o.ProxyMode.Local,{type:h.convertC2H(e.type),sdp:e.sdp}).syncBarrier()}).then(function(e){var n=r.registerCallbacks(!0,!1,c.method_id_RTCPeerConnection_t.setLocalDescription);r.remoteInvoke(!1,c.method_id_RTCPeerConnection_t.setLocalDescription,{oid:e.object_id()},n.success,n.fail),n.prom().then(function(){d.logger.log(r.user_friendly_id()+".setLocalDescription(): success callback received!!!"),r.localDescription=e,t&&t()})}).catch(function(){d.logger.log(r.user_friendly_id()+".setLocalDescription() failed."),n&&n("PeerConnection::setLocalDescription() failed.")})},t.prototype.setRemoteDescription=function(e,t,n){var r=this;d.logger.log(this.user_friendly_id()+".setRemoteDescription() called."),this.waitUntilConnected(this.user_friendly_id()+".setRemoteDescription").then(function(){return new h(r,0,o.ProxyMode.Local,{type:h.convertC2H(e.type),sdp:e.sdp}).syncBarrier()}).then(function(e){var n=r.registerCallbacks(!0,!1,c.method_id_RTCPeerConnection_t.setRemoteDescription);r.remoteInvoke(!1,c.method_id_RTCPeerConnection_t.setRemoteDescription,{oid:e.object_id()},n.success,n.fail),n.prom().then(function(){d.logger.log(r.user_friendly_id()+".setRemoteDescription(): success callback received!!!"),r.remoteDescription=e,t&&t(),r.getSenders()})}).catch(function(){d.logger.log(r.user_friendly_id()+".setRemoteDescription() failed."),n&&n("PeerConnection::setRemoteDescription() failed.")})},t.prototype.getLocalStreams=function(){d.logger.log("PeerConnection.getLocalStreams() called. [oid="+this.object_id()+"]");for(var e=0,t=this.localStreams;e<t.length;e++)d.logger.log(JSON.stringify(t[e]));return this.localStreams},t.prototype.getRemoteStreams=function(){d.logger.log(this.user_friendly_id()+".getRemoteStreams() called.");for(var e=0,t=this.remoteStreams;e<t.length;e++)d.logger.log(JSON.stringify(t[e]));return this.remoteStreams},t.prototype.addTrack=function(e,t){var n=this;d.logger.log(this.user_friendly_id()+".addTrack() called: "+JSON.stringify(t));var a=[];if(t instanceof r.RemoteStream)a.push(t.id);else for(var s=0;s<t.length;s++)a.push(t[s].id);var l=new i.RtpSender(this,0,o.ProxyMode.Pseudo);return this.senders_.push(l),this.waitUntilConnected(this.user_friendly_id()+".addTrack").then(function(){return n.remoteInvoke(!1,c.method_id_RTCPeerConnection_t.addTrack,{oid:e.object_id()},a)}).then(function(e){d.logger.log(n.user_friendly_id()+".addTrack() success with oid: "+n.param0(e).oid),l.bind(n,n.param0(e).oid),l.syncBarrier().catch(function(){d.logger.log(n.user_friendly_id()+"sender.syncBarrier(): failed!")})}).catch(function(e){e=n.param0(e),d.logger.log(n.user_friendly_id()+".addTrack() failed with error: "+e)}),d.logger.log(this.user_friendly_id()+".addTrack() returning: "+l),l},t.prototype.removeTrack=function(e){var t=this;d.logger.log(this.user_friendly_id()+".removeTrack() called.");for(var n=0;n<this.senders_.length;n++)this.senders_[n]==e&&this.senders_.splice(n,1);this.waitUntilConnected(this.user_friendly_id()+".removeTrack").then(function(){return t.remoteInvoke(!1,c.method_id_RTCPeerConnection_t.removeTrack,{oid:e.object_id()})}).then(function(){d.logger.log(t.user_friendly_id()+".removeTrack() success.")}).catch(function(){d.logger.log(t.user_friendly_id()+".removeTrack() failed.")})},t.prototype.addStream=function(e){var t=this;d.logger.log(this.user_friendly_id()+".addStream() called: "+JSON.stringify(e)),e.dumpTrackInfo(),this.localStreams.push(e),this.waitUntilConnected(this.user_friendly_id()+".addStream").then(function(){return t.remoteInvoke(!1,c.method_id_RTCPeerConnection_t.addStream,{oid:e.object_id()},{})}).then(function(){d.logger.log(t.user_friendly_id()+".addStream() success.")}).catch(function(){d.logger.log(t.user_friendly_id()+".addStream() failed.")})},t.prototype.removeStream=function(e){var t=this;d.logger.log(this.user_friendly_id()+".removeStream() called: "+JSON.stringify(e));for(var n=0;n<this.localStreams.length;n++)this.localStreams[n]==e&&this.localStreams.splice(n,1);this.waitUntilConnected(this.user_friendly_id()+".removeStream").then(function(){return t.remoteInvoke(!1,c.method_id_RTCPeerConnection_t.removeStream,{oid:e.object_id()})}).then(function(){d.logger.log(t.user_friendly_id()+".removeStream() success.")}).catch(function(){d.logger.log(t.user_friendly_id()+".removeStream() failed.")})},Object.defineProperty(t.prototype,"onaddstream",{get:function(){return this.onaddstream_},set:function(e){var t=this;d.logger.log(this.user_friendly_id()+".set_onaddstream() called."),this.onaddstream_=e,this.waitUntilConnected(this.user_friendly_id()+".onaddstream").then(function(){var n=t.registerCallbacks(!1,t.isNullCallback(e),c.method_id_RTCPeerConnection_t.onaddstream);return n.then(function(e){new r.RemoteStreamEvent(t,t.param0(e).oid).syncBarrier().then(function(e){d.logger.log(t.user_friendly_id()+".onaddstream callback received!"),void 0===t.remoteStreams.find(function(t){return void 0!=e.stream&&t.object_id()===e.stream.object_id()})&&t.remoteStreams.push(e.stream),void 0!=t.onaddstream_&&t.onaddstream_(e)})}),t.remoteInvoke(!0,c.method_id_RTCPeerConnection_t.onaddstream,n.success)}).catch(function(){d.logger.log(t.user_friendly_id()+".set_onaddstream(): failed!")})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onremovestream",{get:function(){return this.onremovestream_},set:function(e){var t=this;d.logger.log(this.user_friendly_id()+".set_onremovestream() called."),this.onremovestream_=e,this.waitUntilConnected(this.user_friendly_id()+".onremovestream").then(function(){var n=t.registerCallbacks(!1,t.isNullCallback(e),c.method_id_RTCPeerConnection_t.onremovestream);return n.then(function(e){new r.RemoteStreamEvent(t,t.param0(e).oid).syncBarrier().then(function(e){d.logger.log(t.user_friendly_id()+".onremovestream callback received!");var n=t.remoteStreams.findIndex(function(t){return t.id==e.stream.id});0<=n&&t.remoteStreams.splice(n,1),t.onremovestream_(e)})}),t.remoteInvoke(!0,c.method_id_RTCPeerConnection_t.onremovestream,n.success)}).catch(function(){d.logger.log(t.user_friendly_id()+".set_onremovestream(): failed!")})},enumerable:!0,configurable:!0}),t.prototype.getStats=function(e){var t=this;return new Promise(function(n,r){t.isRedirected()?t.waitUntilConnected(t.user_friendly_id()+".getStats").then(function(){var r=t.registerCallbacks(!0,!1,c.method_id_RTCPeerConnection_t.getStats);return r.then(function(t){void 0!==t.params&&0!==t.params.length&&(e(l.StatsReport.fromJSON(JSON.parse(t.params[0]))),n())}),t.remoteInvoke(!1,c.method_id_RTCPeerConnection_t.getStats,r.success)}).catch(function(){d.logger.log(t.user_friendly_id()+".getStats(): failed!"),r()}):(d.logger.log(t.user_friendly_id()+".getStats(): not in active redirection!"),e({}),n())})},t.prototype.SendTelemetryData=function(e,t,r){n.getRedirector().telemetry.SendTelemetryData(u.tel_cmd.Data,e,t,r)},t.prototype.MillisecondstoDisplayformat_=function(e){var t,n;n=Math.floor(e/1e3),t=Math.floor(n/60),e=Math.floor(t/60),d.logger.log(Math.floor(e/24)+":"+e%24+":"+t%60+":"+n%60)},t.prototype.CalculateCallDurationandType_=function(){if(1==this.timeerstarted_){this.timeerstarted_=!1,this.callendTime_=(new Date).getTime();var e=this.callendTime_-this.callstartTime_;this.MillisecondstoDisplayformat_(e),e=Math.round(e/1e3),d.logger.log("Call Duration "+e),1==this.conferencecall_?this.SendTelemetryData(u.tel_key_ConferenceCallDuration,e,1):(1==this.audiocall_.active&&this.SendTelemetryData(u.tel_key_AudioCallDuration,e,1),1==this.videocall_.active&&this.SendTelemetryData(u.tel_key_VideoCallDuration,e,1),1==this.screensharingcall_.active&&this.SendTelemetryData(u.tel_key_ScreensharingCallDuration,e,1));var t;1==this.firsttimelocaloffer_&&(t=this.callstartTime_-this.outgoingcallstart_),1==this.firsttimeremoteoffer_&&(t=this.callstartTime_-this.incomingcallstart_),this.MillisecondstoDisplayformat_(t),t=Math.round(t/1e3),d.logger.log("Call Establish Time "+t),1==this.incomingcall_?this.SendTelemetryData(u.tel_key_CallEstIncoming,t,1):1==this.outgoingcall_&&this.SendTelemetryData(u.tel_key_CallEstOutgoing,t,1),this.SendTelemetryData(u.tel_key_PerfCallState,u.tel_CallState.idle,1)}},t.prototype.close=function(){var e=this;d.logger.log(this.user_friendly_id()+".close() called."),this.CalculateCallDurationandType_(),this.unregisterStateChangeNotification(this.onStateChange),this.onnegotiationneeded=this.onsignalingstatechange=this.onicegatheringstatechange=this.oniceconnectionstatechange=this.onicecandidate=this.onaddstream=null,this.waitUntilConnected(this.user_friendly_id()+".close").then(function(){return e.remoteInvoke(!1,c.method_id_RTCPeerConnection_t.close)}).then(function(){e.iceQ_=null,e.release(),d.logger.log(e.user_friendly_id()+".close() success.")}).catch(function(){e.iceQ_=null,e.release(),d.logger.log(e.user_friendly_id()+".close() failed.")})},t.prototype.createDTMFSender=function(e){d.logger.log(this.user_friendly_id()+".createDTMFSender() called.");var t,n=this.senders_;return void 0!==n&&0!==n.length||(n=this.getSenders()),void 0!=n&&void 0!=(n=n.find(function(t){return t.track.id===e.id}))&&(d.logger.log(this.user_friendly_id()+" returning RtpSender with oid:"+n.object_id()),t=n.dtmf),t},t.prototype.getSenders=function(){var e=this;return d.logger.log(this.user_friendly_id()+".getSenders() called."),this.waitUntilConnected(this.user_friendly_id()+".getSenders").then(function(){return e.remoteInvoke(!1,c.method_id_RTCPeerConnection_t.getSenders,[])}).then(function(t){var n=[];return t.params[0].forEach(function(t){var r=e.senders_.find(function(e){return e.object_id()===t.oid});void 0===r?(d.logger.log(e.user_friendly_id()+" adding a RtpSender with oid:"+t.oid),r=new i.RtpSender(e,t.oid,o.ProxyMode.Remote),n.push(r.syncBarrier())):n.push(r)}),Promise.all(n)}).then(function(t){d.logger.log(e.user_friendly_id()+".getSenders: returning senders with ids ["+t.map(function(e){return e.object_id()})+"]"),e.senders_=t}).catch(function(){d.logger.log(e.user_friendly_id()+".getSenders() didnt get response."),e.senders_=[]}),this.senders_},t.prototype.getReceivers=function(){var e=this;return d.logger.log(this.user_friendly_id()+".getReceivers() called."),this.waitUntilConnected(this.user_friendly_id()+".getReceivers").then(function(){return e.remoteInvoke(!1,c.method_id_RTCPeerConnection_t.getReceivers,[])}).then(function(t){var n=[];return t.params[0].forEach(function(t){var r=e.receivers_.find(function(e){return e.object_id()===t.oid});void 0===r?(d.logger.log(e.user_friendly_id()+" adding a RtpReceiver with oid:"+t.oid),r=new i.RtpReceiver(e,t.oid),n.push(r.syncBarrier())):n.push(r)}),Promise.all(n)}).then(function(t){d.logger.log(e.user_friendly_id()+".getReceivers: returning receiver with ids ["+t.map(function(e){return e.object_id()})+"]"),e.receivers_=t}).catch(function(){d.logger.log(e.user_friendly_id()+".getReceivers() didnt get response."),e.receivers_=[]}),this.receivers_},t}(o.ProxyObject),t.PeerConnection=e}),define("videoelement","require exports proxyobject webrpcclassinfo logger hdxms webrpcclassinfo".split(" "),function(e,t,n,r,i,o,a){Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){this.x=Math.round(e.x)*window.devicePixelRatio,this.y=Math.round(e.y)*window.devicePixelRatio,this.width=Math.round(e.width)*window.devicePixelRatio,this.height=Math.round(e.height)*window.devicePixelRatio};t.VideoRect=s,e=function(e){function t(){var t=e.call(this,null,r.class_id_t.VideoElement,0,n.ProxyMode.Local)||this;return t.srcObject_=null,t.sinkId_="",t.videoWidth=0,t.videoHeight=0,t.isLoaded=!1,t.connectionState="disconnected",t.dispose_=!1,t.disposeTimer=null,t}return __extends(t,e),Object.defineProperty(t.prototype,"sinkId",{get:function(){return this.sinkId_},set:function(e){var t=this;this.waitUntilConnected("VideoElement.sinkId").then(function(){return t.remoteInvoke(!0,r.method_id_VideoElement_t.sinkId,e)}).then(function(){t.sinkId_=e}).catch(function(){i.logger.log(t.user_friendly_id()+".sinkId setter: failed to connect!")})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"srcObject",{get:function(){return this.srcObject_},set:function(e){if(i.logger.log(this.user_friendly_id()+".srcObject: set srcObject... this.srcObject:"+this.srcObject+" obj:"+e),this.srcObject_!==e){!0===this.dispose_&&null!==this.disposeTimer&&(clearTimeout(this.disposeTimer),this.disposeTimer=null,this.dispose_=!1);var t=o.getRedirector().getFeatureValue(a.FEATURE_ms_teams_1911);null!==this.srcObject_&&(null===e&&(this.dispose_=!0,t&&this.disconnect()),t||this.disconnect(),this.isLoaded=!1),this.srcObject_=e,null!==this.srcObject_&&this.connectTo(this.srcObject_)}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onconnectionstatechange",{get:function(){return this.onconnectionstatechange_},set:function(e){i.logger.log(this.user_friendly_id()+".set_onconnectionstatechange() called."),this.onconnectionstatechange_=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onloadedmetadata",{set:function(e){i.logger.log(this.user_friendly_id()+".set_onloadedmetadata() called."),this.onloadedmetadata_=e},enumerable:!0,configurable:!0}),t.prototype.setupOnVideoFrameChanged=function(){var e=this,t=this.registerCallbacks(!1,!1,r.method_id_VideoElement_t.onvideoframechanged);t.then(function(t){i.logger.log(e.user_friendly_id()+".onvideoframechanged",t.params),e.videoWidth=t.params[0]||0,e.videoHeight=t.params[1]||0,e.isLoaded||(e.isLoaded=!0,e.onloadedmetadata_&&e.onloadedmetadata_())}),this.remoteInvoke(!0,r.method_id_VideoElement_t.onvideoframechanged,t.success)},t.prototype.connectTo=function(e){var t=this;console.log(this.user_friendly_id()+".connectTo: connect media stream with id = "+e.object_id()+", clone_id = "+e.clone_state.clone_id),this.waitUntilConnected("VideoElement.connectTo").then(function(){return t.setupOnVideoFrameChanged(),e.clone_state.synchronize(e)}).then(function(e){var n=t.registerCallbacks(!0,!1,r.method_id_VideoElement_t.connectTo);return Promise.all([t.remoteInvoke(!1,r.method_id_VideoElement_t.connectTo,{oid:e.object_id()},n.success,n.fail),n.prom()])}).then(function(e){i.logger.log(t.user_friendly_id()+".connectTo: remote media stream is connected!"),t.connectionState="connected",t.onconnectionstatechange_&&t.onconnectionstatechange_(),t.updateTimer=setInterval(function(){t.ontimeupdate&&t.ontimeupdate()},250)}).catch(function(e){i.logger.log(t.user_friendly_id()+".connectTo: failed to connect! msg = ",e)})},t.prototype.disconnect=function(){var e=this;i.logger.log(this.user_friendly_id()+".disconnect: disconnect from current media stream"),!0===this.dispose_&&(this.disposeTimer=setTimeout(function(){e.release()},5e3)),this.waitUntilConnected("VideoElement.disconnect").then(function(){e.updateTimer&&clearInterval(e.updateTimer);var t=e.registerCallbacks(!1,!0,r.method_id_VideoElement_t.onvideoframechanged);return e.remoteInvoke(!0,r.method_id_VideoElement_t.onvideoframechanged,t.success),e.remoteInvoke(!1,r.method_id_VideoElement_t.disconnect)}).then(function(){i.logger.log(e.user_friendly_id()+".disconnect: remote media stream is disconnected!"),e.connectionState="disconnected",e.onconnectionstatechange_&&e.onconnectionstatechange_()}).catch(function(){i.logger.log(e.user_friendly_id()+".disconnect: failed to connect!")})},t.prototype.setFrame=function(e){var t=this;i.logger.log(this.user_friendly_id()+".setFrame: set video frame to",e.x,e.y,e.width,e.height),this.waitUntilConnected("VideoElement.setFrame").then(function(){var n=new s(e);return t.remoteInvoke(!1,r.method_id_VideoElement_t.setFrame,n)}).then(function(){i.logger.log(t.user_friendly_id()+".setFrame: success!")}).catch(function(){i.logger.log(t.user_friendly_id()+".setFrame: failed to connect!")})},t.prototype.addClipRect=function(e){var t=this;i.logger.log(this.user_friendly_id()+".addClipRect: ",JSON.stringify(e)),this.waitUntilConnected("VideoElement.addClipRect").then(function(){var n=new s(e);return t.remoteInvoke(!1,r.method_id_VideoElement_t.addClipRect,n)}).catch(function(){i.logger.log(t.user_friendly_id()+".addClipRect failed!")})},t.prototype.removeClipRect=function(e){var t=this;i.logger.log(this.user_friendly_id()+".removeClipRect: ",JSON.stringify(e)),this.waitUntilConnected("VideoElement.removeClipRect").then(function(){var n=new s(e);return t.remoteInvoke(!1,r.method_id_VideoElement_t.removeClipRect,n)}).catch(function(){i.logger.log(t.user_friendly_id()+".removeClipRect failed!")})},t}(n.ProxyObject),t.VideoElement=e}),define("audioelement","require exports proxyobject webrpcclassinfo logger hdxms".split(" "),function(e,t,n,r,i,o){Object.defineProperty(t,"__esModule",{value:!0}),e=function(e){function t(){var t=e.call(this,null,r.class_id_t.AudioElement,0,n.ProxyMode.Local)||this;return t.sinkId_="",t.srcObject_=null,t}return __extends(t,e),t.prototype.setSinkId=function(e){var t=this;return i.logger.log(this.user_friendly_id()+".setSinkId: set sinkId to "+e),new Promise(function(n,a){t.waitUntilConnected("AudioElement.sinkId").then(function(){var i=t.remoteInvoke(!0,r.method_id_AudioElement_t.sinkId,e);return o.getRedirector().getFeatureValue(r.FEATURE_ms_teams_pstn)||(t.sinkId_=e,n()),i}).then(function(){t.sinkId_=e,n()}).catch(function(){i.logger.log(t.user_friendly_id()+".sinkId setter: failed to connect!"),a()})})},t.prototype.sinkId=function(){return this.sinkId_},Object.defineProperty(t.prototype,"srcObject",{get:function(){return this.srcObject_},set:function(e){var t=this;if(i.logger.log(this.user_friendly_id()+".srcObject: set srcObject to "+JSON.stringify(e)),e!==this.srcObject_){var n=null!==e&&void 0!==e?e.object_id():"null";this.waitUntilConnected("AudioElement.srcObject").then(function(){return t.remoteInvoke(!0,r.method_id_AudioElement_t.srcObject,n)}).then(function(){t.srcObject_=e,null===e&&t.release()}).catch(function(){i.logger.log(t.user_friendly_id()+".srcObject setter: failed to connect!"),null===e&&t.release()})}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"src",{get:function(){return this.src_},set:function(e){var t=this;i.logger.log(this.user_friendly_id()+".src: set src to "+e),this.src_=e,this.waitUntilConnected("AudioElement.src").then(function(){t.remoteInvoke(!0,r.method_id_AudioElement_t.src,e)}).catch(function(){i.logger.log(t.user_friendly_id()+".src setter: failed to connect!")})},enumerable:!0,configurable:!0}),t.prototype.play=function(){var e=this;i.logger.log(this.user_friendly_id()+".play() called."),this.waitUntilConnected("AudioElement.play").then(function(){e.remoteInvoke(!1,r.method_id_AudioElement_t.play,[])}).catch(function(){i.logger.log(e.user_friendly_id()+".play: failed to connect!")})},t.prototype.pause=function(){var e=this;i.logger.log(this.user_friendly_id()+".pause() called."),this.waitUntilConnected("AudioElement.pause").then(function(){e.remoteInvoke(!1,r.method_id_AudioElement_t.pause,[])}).catch(function(){i.logger.log(e.user_friendly_id()+".pause: failed to connect!")})},t}(n.ProxyObject),t.AudioElement=e}),define("frametracker",["require","exports","logger","hdxms"],function(e,t,n,r){Object.defineProperty(t,"__esModule",{value:!0}),e=function(){function e(){var t=this;this.running_=!1,this.elements_=[],this.clipRects=new Set,this.wheelEventHandler=function(e){setTimeout(function(){t.updateAll()},10)},this.keyupEventHandler=function(e){"Tab"!=e.code&&"ArrowUp"!=e.code&&"ArrowDown"!=e.code&&"ArrowLeft"!=e.code&&"ArrowRight"!=e.code&&"PageUp"!=e.code&&"PageDown"!=e.code&&"Home"!=e.code&&"End"!=e.code||t.updateAll()},e.sendOverlayInfo(),this.observer_=new MutationObserver(function(e){t.updateAll()})}return e.sendOverlayInfo=function(){var e=window.getWindowHandleAsHex;if(void 0===e||null===e)n.logger.log("FrameTracker.sendOverlayInfo: getWindowHandle method is undefined or null");else{var t=r.getRedirector();Promise.all([e(),t.startRedirection(!1,"sendOverlayInfo")]).then(function(e){n.logger.log("FrameTracker.sendOverlayInfo: set window handle: "+e[0]),t.WSSendObject({v:"overlay",command:"window",windowHandle:e[0]})})}},e.prototype.rectanglesIntersect=function(e,t){return e.x<t.x+t.width&&e.x+e.width>t.x&&e.y<t.y+t.height&&e.y+e.height>t.y},e.prototype.intersectingRect=function(e,t){var n=Math.max(e.left,t.left),r=Math.max(e.top,t.top);return new DOMRect(n,r,Math.min(e.right,t.right)-n,Math.min(e.bottom,t.bottom)-r)},e.prototype.pedigreeCount=function(e,t){for(var n=0,r=e.parentElement;null!=r&&r!=t;)n++,r=r.parentElement;return{isAncestor:null!=r,pedigree:n}},e.prototype.selectTopmost=function(e,t){var n=e.getBoundingClientRect(),r=t.getBoundingClientRect(),n=this.intersectingRect(n,r);if((r=document.elementFromPoint(n.left+n.width/2,n.top+n.height/2))==e)return e;if(r==t)return t;if(n=this.pedigreeCount(e,r),r=this.pedigreeCount(t,r),n.isAncestor&&r.isAncestor){if(n.pedigree<r.pedigree)return e;if(r.pedigree<n.pedigree)return t}else{if(n.isAncestor)return e;if(r.isAncestor)return t}},e.prototype.checkOverlappingVideos=function(e){var t=this,n=e.target.getBoundingClientRect();e.overlaps.forEach(function(t){e.target.remoteVideoElement.removeClipRect(t.rect)}),e.overlaps=[],this.elements_.forEach(function(r){if(r!=e){var i=r.overlaps.map(function(e){return e.element}).indexOf(e.target);if(-1!=i&&(i=r.overlaps.splice(i,1)[0],r.target.remoteVideoElement.removeClipRect(i.rect)),i=r.target.getBoundingClientRect(),t.rectanglesIntersect(n,i)){var o=t.selectTopmost(e.target,r.target);o==e.target?(r.overlaps.push({element:e.target,rect:n}),r.target.remoteVideoElement.addClipRect(n)):o==r.target&&(e.overlaps.push({element:r.target,rect:i}),e.target.remoteVideoElement.addClipRect(i))}}})},e.prototype.updateAll=function(){var e=this;this.elements_.forEach(function(t){var n=t.target.getBoundingClientRect();if(void 0!==n){var r=t.clientRect;void 0!==r&&r.x===n.x&&r.y===n.y&&r.width===n.width&&r.height===n.height||(t.clientRect=n,t.callback(n),e.checkOverlappingVideos(t))}})},e.prototype.track=function(e,t){var r=this,i=e.getBoundingClientRect();n.logger.log("Track element frame",e,JSON.stringify(i)),console.log(e),this.elements_.push({target:e,clientRect:void 0,callback:t,overlaps:[]});try{n.logger.log("[HdxWebRTC.js] Initializing occlusion for new videoElement"),this.clipRects.forEach(function(t){r.applyOcclusion(e,JSON.parse(t))})}catch(e){n.logger.log("[HdxWebRTC.js] addOcclusionInit failed! "+e)}this.running_||(n.logger.log("Start FrameTracker observer..."),this.observer_.observe(document.body,{attributes:!0,childList:!0,subtree:!0}),window.addEventListener("wheel",this.wheelEventHandler),window.addEventListener("keyup",this.keyupEventHandler),this.running_=!0),this.updateAll()},e.prototype.untrack=function(e){n.logger.log("Untrack element frame",e);var t=-1;this.elements_.forEach(function(n,r){n.target===e&&(t=r)}),0<=t&&(this.elements_.splice(t,1),0===this.elements_.length&&(n.logger.log("Stop FrameTracker observer..."),this.observer_.disconnect(),window.removeEventListener("wheel",this.wheelEventHandler),window.removeEventListener("keyup",this.keyupEventHandler),this.running_=!1))},e.prototype.applyOcclusion=function(e,t){var n=e.getBoundingClientRect();this.rectanglesIntersect(t,n)&&void 0!==e.remoteVideoElement&&e.remoteVideoElement.addClipRect(t)},e.prototype.addOcclusion=function(e){var t=this;n.logger.log("[HdxWebRTC.js] Adding occlusion "+JSON.stringify(e)),n.logger.log("[HdxWebRTC.js] Tracking '"+this.elements_.length+"' elements."),this.clipRects.add(JSON.stringify(e)),this.elements_.forEach(function(n){t.applyOcclusion(n.target,e)})},e.prototype.removeOcclusion=function(e){n.logger.log("[HdxWebRTC.js] Removing occlusion "+JSON.stringify(e)),n.logger.log("[HdxWebRTC.js] Tracking '"+this.elements_.length+"' elements."),this.clipRects.delete(JSON.stringify(e)),this.elements_.forEach(function(t){void 0!==t.target.remoteVideoElement&&t.target.remoteVideoElement.removeClipRect(e)})},e}(),t.FrameTracker=e});var vdishim=require("./peerconnection"),rmshim=require("./remotemedia"),videoelem=require("./videoelement"),audioelem=require("./audioelement"),frametracker=require("./frametracker"),logger=require("./logger").logger,remotesession=require("./remotesession"),garbagecollector=require("./garbagecollector").gc,HdxMediaStream=require("./hdxms");!function(e,t){"object"==typeof module&&module.exports?module.exports=t():e.vdiPeerConnection=t()}("undefined"!=typeof self?self:this,function(){function e(e){HdxMediaStream.getRedirector().SendTelemetryData_Speaker(e)}function t(){window.getCitrixMSTeamsRedir().then(function(e){logger.log("sucesss on connect, CitrixMSTeamsRedir reg value:"+e),"1"===e&&null===h&&(logger.log("supported client"),h=new remotesession.RemoteSession)}).catch(function(){logger.log("Failure to Read MS Teams redir Reg Key"),r()})}function n(e){if("1"===e)logger.log("Supported client"),HdxMediaStream.getRedirector().pingConnectionBegin(!0);else if("0"===e){logger.log("VDI Event: Unsupported client reported");try{g({event:"vdiClientDisconnected",reason:"endpointUnsupported",msg:"Unsupported endpoint connected"})}catch(e){logger.log("onVMEvent(): exception: "+e.message)}}else logger.log("MS Teams Redir Reg Key value not correct")}function r(){!1===m&&(logger.log("starting MS Reg retry..."),m=!0,i(10))}function i(e){if(0>=e){m=!1,logger.log("VDI Event: Reg Key not Updated after timer reported, Fallback");try{g({event:"vdiClientDisconnected",reason:"failure",msg:"Citrix MS Teams Reg Key not Present"})}catch(e){logger.log("onVMEvent(): exception: "+e.message)}}else window.getCitrixMSTeamsRedir().then(function(t){logger.log("CitrixMSTeamsRedir reg value:"+t),"0"===t||"1"===t?(n(t),m=!1):(logger.log("MS Teams Redir Reg key not updated - Start timer"),setTimeout(function(){logger.log("Timer waiting for registry to be updated count :"+e),i(--e)},1e3))}).catch(function(){logger.log("Failure to Read MS Teams redir Reg Key - Start timer"),setTimeout(function(){logger.log("Timer waiting for registry to be updated count :"+e),i(--e)},1e3)})}function o(){logger.log("VDI: sendSessionInfo"),h&&h.getSessionInfo().then(function(e){logger.log("getSessionInfo success! info:"+JSON.stringify(e));try{g({event:"vdiClientConnected",version:e})}catch(e){logger.log("onVMEvent(): exception: "+e.message)}}).catch(function(){logger.log("getSessionInfo failure! session is not fully connected yet...")})}var a=vdishim.PeerConnection,s=new rmshim.NavigatorUserMedia,c=s.webkitGetUserMedia,d=new rmshim.RemoteDevices,l=new frametracker.FrameTracker,u=[],g=void 0,_=!1;window.onVdiClientDisconnected=function(e){if(logger.log("VDI Event: vdiClientDisconnected"),logger.log("VDI : cleanup"),HdxMediaStream.getRedirector().clearReqs(),l=d=s=null,u=[],h&&h.release(),h=null,garbagecollector.reset(),logger.log("VDI : cleanup done"),1==e&&!1===_){logger.log("VDI Event: vdiClientDisconnected with failure reported"),_=!0;try{g({event:"vdiClientDisconnected",reason:"failure",msg:"Websocket Connection Failure"})}catch(e){logger.log("onVMEvent(): exception: "+e.message)}}else{_=!1;try{g({event:"vdiClientDisconnected",reason:"endpointDisconnected"})}catch(e){logger.log("onVMEvent(): exception: "+e.message)}}};var h=new remotesession.RemoteSession;window.onVdiClientDisconnectedTimer=function(){logger.log("VDI Event: onVdiClientDisconnectedTimer"),null===h&&(h=new remotesession.RemoteSession)},window.onVdiClientConnected=function(){logger.log("VDI Event: vdiClientConnected"),frametracker.FrameTracker.sendOverlayInfo(),o(),null!==d&&d.isValid()||(d=new rmshim.RemoteDevices)};var m=!1;return{createPeerConnection:function(e,n){t();var r=new a(e,n),i=r.createOffer;r.createOffer=function(){return logger.log("VDI Shim createOffer"),i.apply(r,arguments)};var o=r.createAnswer;r.createAnswer=function(){return logger.log("VDI Shim createAnswer"),o.apply(r,arguments)};var s=r.setRemoteDescription;r.setRemoteDescription=function(){return logger.log("VDI Shim setRemoteDescription"),s.apply(r,arguments)};var c=r.setLocalDescription;r.setLocalDescription=function(){return logger.log("VDI Shim setLocalDescription"),c.apply(r,arguments)};var d=r.getLocalStreams;r.getLocalStreams=function(){return logger.log("VDI Shim getLocalStreams"),d.apply(r,arguments)};var l=r.getRemoteStreams;r.getRemoteStreams=function(){return logger.log("VDI Shim getRemoteStreams"),l.apply(r,arguments)};var u=r.getStats;if(r.getStats=function(){return u.apply(r,arguments)},null!==h&&remotesession.RemoteSession.isFeaturePstnSupported()){var g=r.addTrack;r.addTrack=function(){return logger.log("VDI Shim addTrack"),g.apply(r,arguments)};var _=r.removeTrack;r.removeTrack=function(){return logger.log("VDI Shim removeTrack"),_.apply(r,arguments)}}else r.addTrack=void 0,r.removeTrack=void 0;var m=r.addStream;r.addStream=function(){return logger.log("VDI Shim addStream"),m.apply(r,arguments)};var f=r.removeStream;r.removeStream=function(){return logger.log("VDI Shim removeStream"),f.apply(r,arguments)};var p=r.getReceivers;if(r.getReceivers=function(){return logger.log("VDI Shim getReceivers"),p.apply(r,arguments)},null!==h&&remotesession.RemoteSession.isFeaturePstnSupported()){var y=r.getSenders;r.getSenders=function(){return logger.log("VDI Shim getSenders"),y.apply(r,arguments)}}else r.getSenders=void 0;var v=r.close;return r.close=function(){return logger.log("VDI Shim close"),v.apply(r,arguments)},r},getUserMediaShim:function(e,n,r){return t(),logger.log("VDI Shim getUserMedia"),null!==s&&s.isValid()||(s=new rmshim.NavigatorUserMedia,c=s.webkitGetUserMedia),c.apply(s,arguments)},getDisplayMediaShim:function(e){return t(),logger.log("VDI Shim getDisplayMedia"),null!==d&&d.isValid()||(d=new rmshim.RemoteDevices),d.getDisplayMedia.apply(d,arguments)},enumerateDevicesShim:function(){return t(),logger.log("VDI Shim enumerateDevices"),null!==d&&d.isValid()||(d=new rmshim.RemoteDevices),d.enumerateDevices.apply(d,arguments)},newAudioElement:function(n){logger.log("VDI New Audio Element Created, Creating Mapping to Thin Client DOM "),void 0!==n.remoteAudioElement?logger.log("Audio element is already configured!!!"):(t(),Object.defineProperty(n,"remoteAudioElement",{writable:!0,value:null}),n.remoteAudioElement=new audioelem.AudioElement,Object.defineProperty(n,"sinkId",{writable:!0}),n.setSinkId=function(t){logger.log("VDI Shim set audio element SinkId value = "+t);var r,i=n.remoteAudioElement.setSinkId(t);return rmshim.enumerateddecices.forEach(function(e){t==e.deviceId&&(r=e.label)}),e(r),i},Object.defineProperty(n,"srcObject",{get:function(){return n.remoteAudioElement.srcObject},set:function(e){if(logger.log("VDI Shim set audio element srcObject "+JSON.stringify(e)),null===e||void 0===e){if(null!==n.remoteAudioElement.srcObject){e=n.remoteAudioElement.srcObject.getTracks();var t=$jscomp.makeIterator(e);for(e=t.next();!e.done;e=t.next())e.value.enabled=!1}n.remoteAudioElement.release()}else for(n.remoteAudioElement.srcObject=e,e=e.getTracks(),t=$jscomp.makeIterator(e),e=t.next();!e.done;e=t.next())e.value.enabled=!0}}))},newVideoElement:function(e){logger.log("VDI New Video Element Created, Creating Mapping to Thin Client DOM"),null===l&&(l=new frametracker.FrameTracker),void 0!==e.remoteVideoElement?logger.log("Video element is already configured!!!"):(t(),Object.defineProperty(e,"remoteVideoElement",{writable:!0,value:null}),e.remoteVideoElement=new videoelem.VideoElement,e.remoteVideoElement.onloadedmetadata=function(){var t=new Event("loadedmetadata");e.dispatchEvent(t)},e.remoteVideoElement.ontimeupdate=function(){var t=new Event("timeupdate");e.dispatchEvent(t)},e.remoteVideoElement.onconnectionstatechange=function(){"connected"==e.remoteVideoElement.connectionState?l.track(e,function(t){e.remoteVideoElement.setFrame(t)}):l.untrack(e)},Object.defineProperty(e,"sinkId",{get:function(){return e.remoteVideoElement.sinkId},set:function(t){logger.log("VDI Shim set video element SinkId value = "+t),e.remoteVideoElement.sinkId=t}}),Object.defineProperty(e,"srcObject",{get:function(){return e.remoteVideoElement.srcObject},set:function(t){logger.log("VDI Shim set video element srcObject "+t),e.remoteVideoElement.srcObject=t}}),Object.defineProperty(e,"videoWidth",{get:function(){return e.remoteVideoElement.videoWidth}}),Object.defineProperty(e,"videoHeight",{get:function(){return e.remoteVideoElement.videoHeight}}))},setVMEventCallback:function(e){g=e,logger.log("VDI Event Callback Set")},playNotifyAudio:function(e,t){if(0==t.lastIndexOf("file",0)){var n=t.search("/audio");t="https://teams.microsoft.com/assets"+t.slice(n)}logger.log("VDI Shim Audio Notification Playing, Remote to Thin Client "+t),void 0===(n=u.find(function(t){return t.Id===e}))?(n=new audioelem.AudioElement,n.Id=e,n.src=t,u.push(n)):n.src=t,n.play()},pauseNotifyAudio:function(e,t){if(""!==t){var n=u.find(function(t){return t.Id===e});void 0!==n&&(t=n.src,n.pause()),logger.log("VDI Shim Audio Notification Paused, Remote to Thin Client "+t)}},setSinkId:function(e,t){logger.log("VDI Shim Audio setSinkId audioId:"+e+" sinkId:"+t);var n=u.find(function(t){return t.Id==e});void 0===n?(n=new audioelem.AudioElement,n.Id=e,n.sinkId=t,u.push(n)):n.sinkId=t},setDefaultSinkId:function(e){logger.log("VDI Shim Audio setSinkId sinkId:"+e)},addClipRect:function(e){logger.log("VDI Adding Occlusion "+JSON.stringify(e)),null===l&&(l=new frametracker.FrameTracker),l.addOcclusion(e)},removeClipRect:function(e){logger.log("VDI Removing Occlusion "+JSON.stringify(e)),null===l&&(l=new frametracker.FrameTracker),l.removeOcclusion(e)},init:function(e){logger.setMSLogger(e),logger.log("VDI init logger")},isFeatureSupported:function(e){return null!==h&&h.isFeatureSupported(e)},connectedStateChanged:function(e){logger.log("VDI : connectedStateChanged to "+e),0==e?logger.log("Disconnecting from the VDA"):(logger.log("Connecting to the VDA"),window.getCitrixMSTeamsRedir().then(function(e){logger.log("Sucesss on connect, CitrixMSTeamsRedir reg value:"+e),"0"===e||"1"===e?n(e):(logger.log("MS Teams Redir Reg key not updated yet"),r())}).catch(function(){logger.log("Failure to Read MS Teams redir Reg Key"),r()}))},setLoop:function(e,t){logger.log("VDI : setloop")}}});