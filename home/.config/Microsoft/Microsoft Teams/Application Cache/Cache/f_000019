(window.webPackBridgeJsonp=window.webPackBridgeJsonp||[]).push([[53],{cf694d8109b055738d55:function(e,t,n){"use strict";var i=n("64328bb588b46459132d"),a=n("56e93fab5efcffbf24fb"),r=n("e88a8106e72c3f2e7fd4"),o=n("2cb027059b5fbe2cc8a6"),l=n("640a68d4e52093ac8444"),s=n("6871d1ea20c032a12e30"),g=n("06c58f420a0677aad466"),c=n("d3bb8f02f954659262db"),d=n("604f694397cd1f47d3c5"),p={allowBroadcastSchedulingPolicy:"allowBroadcastSchedulingPolicy",allowChannelMeetingSchedulingPolicy:"allowChannelMeetingSchedulingPolicy",allowEngagementReportPolicy:"allowEngagementReportPolicy",allowFluidCollaboratePolicy:"allowFluidCollaboratePolicy",allowMeetingRegistrationPolicy:"allowMeetingRegistrationPolicy",allowPrivateMeetingSchedulingPolicy:"allowPrivateMeetingSchedulingPolicy",calendarEventsPollIntervalInMs:"calendarEventsPollIntervalInMs",calendarRESTEnabledAPIs:"calendarRESTEnabledAPIs",debounceSchedulingFormPeoplePickerGuestSearchinMillis:"debounceSchedulingFormPeoplePickerGuestSearchinMillis",disableCalendarFeaturesInMultiwindow:"disableCalendarFeaturesInMultiwindow",disableFormOptimization:"disableFormOptimization",enableAllowFluidCollaboratePolicyBypass:"enableAllowFluidCollaboratePolicyBypass",enableAppsGalleryinMeetingChat:"enableAppsGalleryinMeetingChat",enableBIMCalendarSurface:"enableBIMCalendarSurface",enableCalendarAttachments:"enableCalendarAttachments",enableCalendarCategories:"enableCalendarCategories",enableCalendarCopyLink:"enableCalendarCopyLink",enableCalendarDialogBridge:"enableCalendarDialogBridge",enableCalendarEventGroupChiclet:"enableCalendarEventGroupChiclet",enableCalendarEventsBackgroundSync:"enableCalendarEventsBackgroundSync",enableCalendarEventsPrefetchPrevNextWeek:"enableCalendarEventsPrefetchPrevNextWeek",enableCalendarJoinButtonWithIcon:"enableCalendarJoinButtonWithIcon",enableCalendarNstarExtensibilityTabs:"enableCalendarNstarExtensibilityTabs",enableCalendarSchedulingFormNewPeoplePill:"enableCalendarSchedulingFormNewPeoplePill",enableCalendarSchedulingFormPreReleaseFeatures:"enableCalendarSchedulingFormPreReleaseFeatures",enableCalendarShareLinkDialog:"enableCalendarShareLinkDialog",enableCalendarShareLinkDialogPostMeetingCreation:"enableCalendarShareLinkDialogPostMeetingCreation",enableCalendarTenantCheckForPeopleSearch:"enableCalendarTenantCheckForPeopleSearch",enableCalendarV2ApiService:"enableCalendarV2ApiService",enableCalendarV2ApiServiceEnterprise:"enableCalendarV2ApiServiceEnterprise",enableCalendarV2EventForwarding:"enableCalendarV2EventForwarding",enableCalendarV2MeetingPrep:"enableCalendarV2MeetingPrep",enableCalendarV2PreReleaseFeatures:"enableCalendarV2PreReleaseFeatures",enableCalendarV2ShowAs:"enableCalendarV2ShowAs",enableCallTranscriptPostMeetingSpeakerAttribution:"enableCallTranscriptPostMeetingSpeakerAttribution",enableCallTranscriptPostMeetingSpeakerAttributionEdit:"enableCallTranscriptPostMeetingSpeakerAttributionEdit",enableEngagementReportPolicyCheck:"enableEngagementReportPolicyCheck",enableEngagementReportPolicyTestHook:"enableEngagementReportPolicyTestHook",enableFreemiumAgendaView:"enableFreemiumAgendaView",enableThirdPartyCalendar:"enableThirdPartyCalendar",enableFreemiumCalendarShareViaGoogle:"enableFreemiumCalendarShareViaGoogle",enableFreemiumCalendarShareViaOutlook:"enableFreemiumCalendarShareViaOutlook",enableFreemiumMeetingInviteWithDate:"enableFreemiumMeetingInviteWithDate",enableGetCalendarEventsFromRest:"enableGetCalendarEventsFromRest",enableGroupEventsInGeneralChannelCalendar:"enableGroupEventsInGeneralChannelCalendar",enableInlineMeetingOptions:"enableInlineMeetingOptions",enableMeetingArtifacts:"enableMeetingArtifacts",enableMeetingInfoDropdown:"enableMeetingInfoDropdown",enableMeetingOptionsButton:"enableMeetingOptionsButton",enableMeetNowSharePanelInCalendar:"enableMeetNowSharePanelInCalendar",enableMultiWindowCalendarSchedulingForm:"enableMultiWindowCalendarSchedulingForm",enableMultiWindowCalendarSchedulingFormViewAndEdit:"enableMultiWindowCalendarSchedulingFormViewAndEdit",enableMultiWindowWebinarRegistration:"enableMultiWindowWebinarRegistration",enableMultiWindowUseProjectStyles:"enableMultiWindowUseProjectStyles",enableOnlineAppointment:"enableOnlineAppointment",enableQuickCreateForFreemiumCalendar:"enableQuickCreateForFreemiumCalendar",enableRecordingPostMeeting:"enableRecordingPostMeeting",enableRequireRegistrationInMeetingSchedulingForm:"enableRequireRegistrationInMeetingSchedulingForm",enableRockfallCalendarMeetingSchedulingEnhancements:"enableRockfallCalendarMeetingSchedulingEnhancements",enableSchedulingFormTrackingViewSummary:"enableSchedulingFormTrackingViewSummary",enableSchedulingWebinars:"enableSchedulingWebinars",enableSpeedyMeetings:"enableSpeedyMeetings",enableWebinarPolicyCheck:"enableWebinarPolicyCheck",engagementReportPolicyTestHookOverride:"engagementReportPolicyTestHookOverride",freemiumCalendarShareViaGoogleAllowedDomains:"freemiumCalendarShareViaGoogleAllowedDomains",freemiumCalendarShareViaOutlookAllowedDomains:"freemiumCalendarShareViaOutlookAllowedDomains",isConsumerWindow:"isConsumerWindow",isMeetingOnenoteAgendaEnabled:"isMeetingOnenoteAgendaEnabled",meetingOptionsUrl:"meetingOptionsUrl",noOfAttendeesForShowingTrackingViewSummary:"noOfAttendeesForShowingTrackingViewSummary",useWebviewForFluid:"useWebviewForFluid",whoCanRegisterPolicy:"whoCanRegisterPolicy"},u=n("94a755535d135f12850c");n.d(t,"a",function(){return h});var h=function(){function e(e,t){var n;this.settingsService=e,this.policySettingsStoreService=t,this.settingsCache={},this.itProSettings={isBroadcastSchedulingAllowed:!1,isPrivateMeetingSchedulingAllowed:!0,isChannelMeetingSchedulingAllowed:!0,allowEngagementReport:a.b.AllowEngagementReport.Disabled,allowMeetingRegistration:!1,whoCanRegister:a.b.WebinarRegisterPolicy.EveryoneInCompany,allowFluidCollaborate:!0},this.userPropertiesSettings={},this.settingsByCategoryMap=new Map([[a.a.Metadata,{getSettings:this.getMetadataSettings.bind(this),namespace:r.b}],[a.a.Test,{getSettings:this.getTestSettings.bind(this),namespace:r.b}],[a.a.Auth,{getSettings:this.getAuthSettings.bind(this),namespace:r.b}],[a.a.Telemetry,{getSettings:this.getTelemetrySettings.bind(this),namespace:r.b}],[a.a.Host,{getSettings:this.getHostSettings.bind(this),namespace:r.b}],[a.a.Localization,{getSettings:this.getLocalizationSettings.bind(this),namespace:r.b}],[a.a.Calendar,{getSettings:this.getCalendarSettings.bind(this),namespace:r.b}],[a.a.Platform,{getSettings:this.getPlatformSettings.bind(this),namespace:r.b}],[a.a.ChatList,{getSettings:this.getChatListSettings.bind(this),namespace:r.b}],[a.a.Shortcuts,{getSettings:this.getShortcutsSettings.bind(this),namespace:r.b}],[a.a.WebinarRegistration,{getSettings:this.getWebinarRegistrationSettings.bind(this),namespace:r.b}]]),this.userPropertiesSettings=null!==(n=null==t?void 0:t.getUserPropertiesSettings())&&void 0!==n?n:{}}return e.prototype.get=function(e){return this.getSubject(e).value},e.prototype.getObservable=function(e){return this.getSubject(e).asObservable()},e.prototype.getSubject=function(e){var t=this;if(this.settingsCache[e])return this.settingsCache[e];var n=this.getSettingsForCategory(e),i=n.subscriptionNamespace,r=n.settings,o=new g.a(r||{});this.settingsCache[e]=o;e===a.a.Calendar&&this.policySettingsStoreService&&this.getCalendarPolicySettings(o);var l=new s.a("adapter-"+e+"-"+i,function(){var n=t.getSettingsForCategory(e).settings;o.next(n)},i);return this.settingsService.addListener(l),o},e.prototype.getSettingsForCategory=function(e){var t=this.settingsByCategoryMap.get(e),n=e.toString().toLowerCase(),i=t?t.getSettings():this.settingsService.getSettingsForNamespace(n)||{};return{subscriptionNamespace:t?t.namespace:n,settings:i}},e.prototype.getMetadataSettings=function(){var e,t=new c.a(this.settingsService).ring,n=this.settingsService.get(d.a.EnvironmentType,d.a.EnvironmentKey);return t&&(e={id:t.id||"general",friendlyName:t.friendlyName,shortName:t.shortName}),{ring:e,eTag:null==t?void 0:t.eTag,environment:n}},e.prototype.getTestSettings=function(){return{isRunningGlassjar:this.settingsService.getBoolean("isRunningGlassjar"),mtAuthResourceOverride:this.settingsService.getString("skypeAuthEndpointAddressV2"),mtOverrideBaseUrl:this.settingsService.getString("mtOverrideBaseURL")}},e.prototype.getAuthSettings=function(){var e=this.settingsService.get("authConstants");if(e){var t=e.skypeAuthEndpointAddressV2,n=Object(u.isArray)(e.resources)&&e.resources.length>0&&e.resources[0];return{authzEndpointUrl:t,mtResource:n,authzResource:this.settingsService.get("isConsumerWindow")?e.consumerAuthzResource:n}}return{}},e.prototype.getTelemetrySettings=function(){var e,t,n,i,a,r,l=this.settingsService.get("loggingConstants"),s=this.isScenarioMemorySnapshotEnabled();l&&(n=l.telemetryserver,i=null===(e=l.appTokens)||void 0===e?void 0:e.default,a=null===(t=l.appTokens)||void 0===t?void 0:t.userBi,r=!!l.silent&&l.silent,this.settingsService.get(d.a.EnvironmentType,d.a.EnvironmentKey)!==o.a.Prod&&l.appTokens&&l.appTokens.test&&(i=l.appTokens.test,a=l.appTokens.test));return{defaultToken:i,isSilent:r,telemetryServer:n,userBiToken:a,isScenarioMemorySnapshotEnabled:s}},e.prototype.getHostSettings=function(){return{keyboardLayoutLanguage:this.settingsService.getString("keyboardLayoutLanguage")}},e.prototype.getLocalizationSettings=function(){return{enableLocalizedKeyboardShortcuts:this.settingsService.getBoolean("enableLocalizedKeyboardShortcuts")}},e.prototype.getCalendarSettings=function(){var e=this,t=Object(u.mapValues)(p,function(t){return e.settingsService.get(t)}),n=this.itProSettings,a={allowChannelMeetingSchedulingPolicy:n.isChannelMeetingSchedulingAllowed,allowPrivateMeetingSchedulingPolicy:n.isPrivateMeetingSchedulingAllowed,allowBroadcastSchedulingPolicy:n.isBroadcastSchedulingAllowed,allowEngagementReportPolicy:n.allowEngagementReport,allowMeetingRegistrationPolicy:n.allowMeetingRegistration,whoCanRegisterPolicy:n.whoCanRegister,allowFluidCollaboratePolicy:n.allowFluidCollaborate};return Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},t),a),this.userPropertiesSettings)},e.prototype.getCalendarPolicySettings=function(e){var t=this,n=this.initializeCalendarPolicySettings(),i=n.isChannelMeetingSchedulingAllowedPromise,r=n.isPrivateMeetingSchedulingAllowedPromise,o=n.broadcastPolicySettingsPromise,l=n.allowMeetingRegistrationPromise,s=n.allowEngagementReportPromise,g=n.whoCanRegisterPromise,c=n.allowFluidCollaboratePromise;this.initializeBroadcastPolicySettingsPromise(o,e),Promise.all([i,r,s,l,g,c]).then(function(n){var i=n[0],a=n[1],r=n[2],o=n[3],l=n[4],s=n[5];t.itProSettings.isChannelMeetingSchedulingAllowed=i,t.itProSettings.isPrivateMeetingSchedulingAllowed=a,t.itProSettings.allowEngagementReport=r,t.itProSettings.allowMeetingRegistration=o,t.itProSettings.whoCanRegister=l,t.itProSettings.allowFluidCollaborate=null==s||s;var g=t.getCalendarSettings();e.next(g)}).catch(function(){t.itProSettings.isChannelMeetingSchedulingAllowed=!1,t.itProSettings.isPrivateMeetingSchedulingAllowed=!1,t.itProSettings.allowEngagementReport=a.b.AllowEngagementReport.Disabled,t.itProSettings.allowMeetingRegistration=!1,t.itProSettings.whoCanRegister=a.b.WebinarRegisterPolicy.EveryoneInCompany,t.itProSettings.allowFluidCollaborate=!0;var n=t.getCalendarSettings();e.next(n)}),this.updateUserPropertiesSettings(e)},e.prototype.initializeCalendarPolicySettings=function(){return{isChannelMeetingSchedulingAllowedPromise:this.policySettingsStoreService.isChannelMeetingSchedulingAllowed(),isPrivateMeetingSchedulingAllowedPromise:this.policySettingsStoreService.isPrivateMeetingSchedulingAllowed(),broadcastPolicySettingsPromise:this.policySettingsStoreService.getBroadcastPolicySettings(),allowEngagementReportPromise:this.policySettingsStoreService.allowEngagementReport(),allowMeetingRegistrationPromise:this.policySettingsStoreService.allowMeetingRegistration(),whoCanRegisterPromise:this.policySettingsStoreService.whoCanRegister(),allowFluidCollaboratePromise:this.policySettingsStoreService.allowFluidCollaborate()}},e.prototype.initializeBroadcastPolicySettingsPromise=function(e,t){var n=this;e.then(function(e){n.itProSettings.isBroadcastSchedulingAllowed=e.allowBroadcastScheduling;var i=n.getCalendarSettings();t.next(i)}).catch(function(){})},e.prototype.getPlatformSettings=function(){return{sessionId:this.settingsService.getString(d.a.SessionIdKey,d.a.PlatformKey)||this.settingsService.getString(d.a.SessionIdKey,d.a.CookiesKey)}},e.prototype.getChatListSettings=function(){return{enableBuddyList:this.settingsService.getBoolean(d.a.EnableBuddyList),hideSelectedChatLeftRailTypingIndicator:this.settingsService.getBoolean(d.a.HideSelectedChatLeftRailTypingIndicator)}},e.prototype.getShortcutsSettings=function(){var e=this.settingsService.get(d.a.ClientType,d.a.PlatformKey)===l.b.Desktop,t=this.settingsService.get(d.a.RingKey);return{applyDesktopKeymappingStrategy:e,enableDevShortcuts:!(!t||t.isPublic)}},e.prototype.isScenarioMemorySnapshotEnabled=function(){return this.settingsService.get(d.a.ClientType,d.a.PlatformKey)===l.b.Desktop&&this.settingsService.getBoolean(d.a.EnableMemoryDumpApi,d.a.DesktopSettingsKey)},e.prototype.getWebinarRegistrationSettings=function(){var e=this.settingsService.get("webinarSettings");return{webinarServiceEndpoint:e.serviceEndpoint,webinarServiceResource:e.serviceResource}},e.prototype.updateUserPropertiesSettings=function(e){var t,n=this;null===(t=this.policySettingsStoreService)||void 0===t||t.waitAndGetUserPropertiesSettings().then(function(t){var a=t.autodiscoverSettings,r=t.isOnCloud,o=n.getCalendarSettings();Object(u.isEqual)(a,o.autodiscoverSettings)&&r===o.isOnCloud||(n.userPropertiesSettings={autodiscoverSettings:a,isOnCloud:r},e.next(Object(i.__assign)(Object(i.__assign)({},o),n.userPropertiesSettings)))}).catch(function(){})},e}()},d509ad4ece297ab5a0d1:function(e,t,n){"use strict";n.r(t);var i,a=n("275976081ce1abf67779"),r=n("298834ef555136219449"),o=n("2fb8223a0230e17c2ea9"),l=n("3a3917c057079b816e70"),s=n("4240efd871ae15138fcf"),g=n("68ad756829a3e387be42"),c=n("c4e5d556b9dfef6082b0"),d=n("66ed9b0e2e19f957591e"),p=n("56e93fab5efcffbf24fb"),u=n("d3bb8f02f954659262db"),h=n("cf694d8109b055738d55"),b=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),S=function(e){function t(t){var n,i=e.call(this,t)||this;i.enableMountPointRenderOption=!1,i.changeTheme=function(e){i.setState({currentTheme:e})},i.changeUserPref=function(e){i.setState({currentUserPref:e})};var a=l.a.getAppState().currentTheme;if(i.state={currentTheme:a,currentUserPref:t.getUserFileOpenPreference&&t.getUserFileOpenPreference()||d.d.Teams},i.scenario=s.a.findScenario(d.I.getPersonalFilesV2),i.analyticsService=t.analyticsService||new g.a,i.props.settingsService){var r=new u.a(i.props.settingsService);i.userRing=null===(n=r.ring)||void 0===n?void 0:n.id,i.clientType=r.clientType;var o=new h.a(i.props.settingsService).get(p.a.Telemetry).telemetryServer;i.ariaCollectorUrl=o,i.enableMountPointRenderOption=r.enableMountPointRenderOption||!1}return i}return b(t,e),t.prototype.render=function(){return a.createElement(r.b,{currentTheme:Object(o.b)(this.state.currentTheme),analyticsService:this.analyticsService},a.createElement(r.a,{compileIntoAngular:this.props.compileIntoAngular},a.createElement(c.b,{analyticsService:this.analyticsService},a.createElement(r.e,{onCopyLink:this.props.onCopyLink,siteInfo:this.props.siteInfo,acquireToken:this.props.acquireToken,downloadFiles:this.props.downloadFiles,changeDefaultAppAction:this.props.changeDefaultAppAction,moveFiles:this.props.moveFiles,copyFiles:this.props.copyFiles,scenario:this.scenario,loggingPrefix:d.I.personalFilesPrefix,currentTheme:Object(o.b)(this.state.currentTheme),rootBreadcrumbDisplayName:d.i,isODB:!0,isFreemium:this.props.isFreemium,enableFilesCopyShareLink:this.props.enableFilesCopyShareLink,enableNStarViewerExpInMainWindow:this.props.enableNStarViewerExpInMainWindow,showStorageExceededMessage:this.props.showStorageExceededMessage,serviceName:d.J.personal,renderedWindowsAhead:this.props.renderedWindowsAhead,renderedWindowsBehind:this.props.renderedWindowsBehind,createFolderAndRefreshSiteUrl:this.props.createFolderAndRefreshSiteUrl,userRing:this.userRing,clientVersion:this.props.clientVersion,isDownloadBlocked:this.props.isDownloadBlocked,isEditMetadataEnabled:this.props.isEditMetadataEnabled,enableDesktopUsePluginess:this.props.enableDesktopUsePluginess,enableWindowOpenForProtocolHandlerInvocation:this.props.enableWindowOpenForProtocolHandlerInvocation,handleFileOpenPreferenceUpdate:this.props.handleFileOpenPreferenceUpdate,currentUserPref:this.state.currentUserPref,isFileOpenExperimentEnabled:this.props.isFileOpenExperimentEnabled||!1,enableWebAsDefaultFileOpenPreference:this.props.enableWebAsDefaultFileOpenPreference,clientType:this.clientType,isGeneralChannel:!1,enableChannelFilesTabDocLibBreadcrumb:!1,ariaCollectorUrl:this.ariaCollectorUrl,enableMountPointRenderOption:this.enableMountPointRenderOption}))))},t}(a.Component);n.d(t,"PersonalFilesRoot",function(){return S})}}]);