webpackJsonp([26],{136:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,s,n,i,a,o,r,c,l,d,g,m,p,u){this.$q=e,this.$timeout=t,this.$translate=s,this.analyticsService=n,this.ariaLiveService=i,this.chatServiceClient=a,this.constants=o,this.conversationsService=r,this.conversationsStore=c,this.exceptionUtilityService=l,this.loggingService=d,this.resources=g,this.settingsService=m,this.tenantSettingsStore=p,this.teamSettingsService=u,this.memberIdPrefix="member",this.memberPermissionsSettings=[],this.propertiesUpdatePromises={},this.giphyTypes=[],this.enableFunControlSetting=!1,this.enableAddToTeamMemeSettings=!1,this.isUnthreadedChannelsEnabled=m.valueAsBoolean(o.settings.names.enableUnthreadedChannels),this.enableFunControlSetting=m.valueAsBoolean(o.settings.names.enableGiphySetting),this.enableAddToTeamMemeSettings=m.valueAsBoolean(o.settings.names.enableAddToTeamMemeSettings),this.tenantSettings=p.getSettings(),this.errorMessage=null,this.featureTitle=s.instant(g.strings.team_dashboard_feature_settings_title),this.memberTitle=s.instant(g.strings.team_dashboard_permissions_title),this.funTitle=s.instant(g.strings.team_dashboard_funcontrol_actions_title),this.funTitle_desc=s.instant(g.strings.team_dashboard_funcontrol_actions_desc),this.funTitle_disabled_info=s.instant(g.strings.team_dashboard_giphy_disabled_info_title),this.giphyTitle_action=s.instant(g.strings.team_dashboard_fun_control_giphy_actions_title),this.giphyTitle_rating=s.instant(g.strings.team_dashboard_fun_control_giphy_actions_team_rating),this.stickerTitle_action=s.instant(g.strings.team_dashboard_fun_control_stickers_actions_title),this.stickerTitle_action_permission=s.instant(g.strings.team_dashboard_fun_control_stickers_actions_team_permission),this.memeTitle_action=s.instant(g.strings.team_dashboard_fun_control_memes_actions_title),this.memeTitle_action_permission=s.instant(g.strings.team_dashboard_fun_control_memes_actions_team_permission)}return e.$inject=["$q","$timeout","$translate","analyticsService","ariaLiveService","chatServiceClient","constants","conversationsService","conversationsStore","exceptionUtilityService","loggingService","resources","settingsService","tenantSettingsStore","teamSettingsService"],e.prototype.initGiphySettings=function(){var e=this;this.tenantSettingsStore.waitForSettingAndGetValue(SkypeX.Services.TenantSettingsStorageKey.funControl_giphyRatingType).then(function(t){var s=0;t&&(s=SkypeX.Services.GiphyRatingMapping[t]),[{value:0,text:e.$translate.instant(e.resources.strings.team_dashboard_fun_control_giphy_rating_strict),info:e.$translate.instant(e.resources.strings.team_dashboard_fun_control_giphy_rating_strict_info)},{value:1,text:e.$translate.instant(e.resources.strings.team_dashboard_fun_control_giphy_rating_moderate),info:e.$translate.instant(e.resources.strings.team_dashboard_fun_control_giphy_rating_moderate_info)},{value:2,text:e.$translate.instant(e.resources.strings.team_dashboard_fun_control_giphy_rating_no_restriction),info:e.$translate.instant(e.resources.strings.team_dashboard_fun_control_giphy_rating_no_restriction_info)}].forEach(function(t){s>=t.value&&e.giphyTypes.push(t)}),e.setSelectedGiphyInfo()})},e.prototype.getMessagePermissionSettings=function(e){var t=[];return this.tenantAdminDeleteSettingEnabled&&t.push({settingName:this.constants.teams.settings.adminDeleteEnabled,inputId:e+"enable_admin_delete",labelText:this.resources.strings.team_dashboard_enable_admin_delete,labelId:e+"admin_delete_label"}),this.tenantDeleteSettingEnabled&&t.push({settingName:this.constants.teams.settings.deleteEnabled,inputId:e+"enable_delete",labelText:this.resources.strings.team_dashboard_enable_delete,labelId:e+"enable_delete_label"}),this.tenantEditSettingEnabled&&t.push({settingName:this.constants.teams.settings.editEnabled,inputId:e+"enable_edit",labelText:this.resources.strings.team_dashboard_enable_edit,labelId:e+"enable_edit_label"}),this.isUnthreadedChannelsEnabled&&t.push({settingName:this.constants.teams.settings.messageThreading,inputId:e+"enable_message_threading",labelText:this.resources.strings.team_dashboard_message_threading,labelId:e+"enable_message_threading"}),t},e.prototype.narrateSettingsLabel=function(e,t,s){var n="";t&&(n+=this.$translate.instant(t)),!0===s?n+=" "+this.$translate.instant(this.resources.strings.checkbox_state_checked):!1===s&&(n+=" "+this.$translate.instant(this.resources.strings.checkbox_state_unchecked)),this.isSourceArchived&&(n+=" "+this.$translate.instant(this.resources.strings.team_dashboard_checkbox_state_disabled)),this.ariaLiveService.update(n,!0)},e.prototype.handleUpdateChannelSettingsClick=function(e,t,s,n,i,a){void 0===i&&(i=this.userSettings),this.updateChannelSettings(n,i,a),this.narrateSettingsLabel(e,t,s)},e.prototype.updateChannelSettings=function(e,t,s){var n,i=this;void 0===t&&(t=this.userSettings);var a=t[e];if(!this.isAdmin())return this.logger.error("User id not authorized to change permissions. Only an admin can do it"),this.errorMessage=this.$translate.instant(this.resources.strings.team_dashboard_settings_not_admin_error),this.setAndGetSpaceAdminSettingsLocal((n={},n[e]=!a,n),t,s),this.$q.reject(this.errorMessage);if(this.propertiesUpdatePromises[e])return this.propertiesUpdatePromises[e];this.teamSettingsService.logSettingUpdateBITelemetry(e,a),this.errorMessage=null;var o=this.$q.defer();this.propertiesUpdatePromises[e]=o.promise;var r={};return r[e]=a,e===this.constants.teams.settings.stickersEnabled&&!a&&this.userSettings.customMemesEnabled&&(r.customMemesEnabled=!1),this.setAndGetSpaceAdminSettingsLocal(r,t,s).then(function(n){n||(i.logger.error("No admin settings present on team thread"),i.errorMessage=i.$translate.instant(i.resources.strings.team_dashboard_update_permission_generic_error),o.reject());var c=i.loggingService.newScenario(i.constants.scenarios.teamAndChannel.updateChannelPermission),l=i.getScenarioData(n);i.chatServiceClient.setThreadProperty(i.objectId,SkypeX.Services.ChatServiceUtils.ThreadProp_TeamAdminSettings,n,i.threadUpdateCounterName).toNgPromise(i.$q).then(function(){i.logger.info("Updated the thread setting property for propertyName "+e+" with value "+a),i.logger.info("Serialized value saved is "+n),c.stop(l),o.resolve()},function(n){i.logger.error("An error occured while updating the thread property "+e+" to value "+a+". Error: "+n),i.errorMessage=i.$translate.instant(i.resources.strings.team_dashboard_update_permission_generic_error),l[i.constants.scenarioDataPropNames.error]=JSON.stringify(n),i.exceptionUtilityService.failScenarioSelectively(c,n,l,[]);for(var d in r)r[d]=!r[d];i.setAndGetSpaceAdminSettingsLocal(r,t,s).finally(function(){o.reject(n)})}).finally(function(){i.propertiesUpdatePromises[e]=void 0})}),this.propertiesUpdatePromises[e]},e.prototype.setAndGetSpaceAdminSettingsLocalHelper=function(e,t){var s=this,n=this.conversationsService.getConversation(this.objectId);if(n&&n.threadProperties){var i=n.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_TeamAdminSettings];this.groupId=n.groupId,i||(i="{}");var a=JSON.parse(i);return a.userSettings||(a.userSettings={}),this.displayGuestSettings&&(a.guestSettings||(a.guestSettings={}),angular.copy(this.guestSettings,a.guestSettings)),this.displayGuardianNotificationSettings&&(a.classSettings||(a.classSettings={}),angular.copy(this.classSettings,a.classSettings)),angular.copy(this.userSettings,a.userSettings),i=JSON.stringify(a),this.conversationsStore.patchConversation(n.id,function(e){e.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_TeamAdminSettings]=i}).then(function(){return i},function(e){return s.$q.when(i)})}return this.$q.when(null)},e.prototype.updateGiphyRating=function(){this.isSourceArchived||(this.userSettings[this.constants.teams.settings.giphyRating]=this.userSettings.giphyRating,this.setSelectedGiphyInfo(),this.updateChannelSettings(this.constants.teams.settings.giphyRating))},e.prototype.setSelectedGiphyInfo=function(){this.userSettings.giphyRating&&this.giphyTypes[this.userSettings.giphyRating]?this.selectedGiphyInfo=this.giphyTypes[this.userSettings.giphyRating].info:(this.userSettings.giphyRating=0,this.selectedGiphyInfo=this.giphyTypes[0].info)},e.prototype.waitForEditDeleteTenantSettings=function(){var e=this;return this.tenantSettingsStore.waitForSettingAndGetValue(SkypeX.Services.TenantSettingsStorageKey.messaging_enableOwnersDeleteAllMessages).then(function(t){e.tenantAdminDeleteSettingEnabled=t,e.tenantDeleteSettingEnabled=e.tenantSettingsStore.getSettingValue(SkypeX.Services.TenantSettingsStorageKey.messaging_enableUserDeleteOwnMessages),e.tenantEditSettingEnabled=e.tenantSettingsStore.getSettingValue(SkypeX.Services.TenantSettingsStorageKey.messaging_enableUserEditOwnMessages)})},e}();t.BasePermissionSectionController=n,angular.module("teamspace.basePermissionSection",["skypeX.chatServiceClient","skypeX.tenantSettingsStore","teamspace.ariaLiveService","teamspace.conversationsService","teamspace.constants","teamspace.exceptionUtilityService","teamspace.settingsService"])},2210:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s(2211),s(2212),s(136),s(2214)},2211:function(e,t,s){"use strict";var n=this&&this.__extends||function(){var e=function(t,s){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s])})(t,s)};return function(t,s){function n(){this.constructor=t}e(t,s),t.prototype=null===s?Object.create(s):(n.prototype=s.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=s(308),a=function(e){function t(t,s,n,i,a,o,r,c,l,d,g,m,p,u,h,b,v,S){var _=e.call(this,p,t,s,u,n,i,a,o,r,c,l,d,g,m,S)||this;return _.analyticsService=u,_.channelMembershipPropertiesService=h,_.logger=l.newLogger("ChannelPermission"),_.channel=b.getChannelByObjectId(_.objectId),_.channel?(_.featureTitle_desc=s.instant(d.strings.channel_settings_feature_settings_desc),_.memberTitle_desc=s.instant(d.strings.channel_settings_permissions_desc),_.giphyTitle_action_permission=s.instant(d.strings.team_dashboard_fun_control_giphy_actions_channel_permission),_.threadUpdateCounterName=a.counters.editChannelSetting,_.displayGuardianNotificationSettings=!1,_.displayGuestSettings=!1,_.userSettings=v.getAllMemberSettings(_.objectId),_.initGiphySettings(),_.waitForEditDeleteTenantSettings().then(function(){_.initFeatureSettings(),_.memberPermissionsSettings=_.initUserPermissionSettings(_.memberIdPrefix)}),_):(_.logger.error("Invalid objectId passed. Channel not present for the id "+_.objectId),_)}return n(t,e),t.$inject=["$timeout","$translate","ariaLiveService","chatServiceClient","constants","conversationsService","conversationsStore","exceptionUtilityService","loggingService","resources","settingsService","tenantSettingsStore","$q","analyticsService","channelMembershipPropertiesService","channelService","channelSettingsService","teamSettingsService"],Object.defineProperty(t.prototype,"isSourceArchived",{get:function(){return this.channel.isArchived},enumerable:!0,configurable:!0}),t.prototype.isAdmin=function(){return this.channelMembershipPropertiesService.isAdmin(this.objectId)},t.prototype.getScenarioData=function(e){var t;return t={},t[this.constants.scenarioDataPropNames.threadId]=this.objectId,t[this.constants.scenarioDataPropNames.data]=JSON.stringify({serializedAdminSettings:e,groupId:this.groupId||""}),t},t.prototype.setAndGetSpaceAdminSettingsLocal=function(e,t){for(var s in e)this.setChannelSettings(t,s,e[s]);return this.setAndGetSpaceAdminSettingsLocalHelper(e,t)},t.prototype.setChannelSettings=function(e,t,s){switch(e||(e={}),t){case this.constants.teams.settings.createTab:e.createTab=s,e.deleteTab=s;break;case this.constants.teams.settings.createIntegration:e.createIntegration=s,e.updateIntegration=s,e.deleteIntegration=s;break;case this.constants.teams.settings.teamMention:case this.constants.teams.settings.customMemesEnabled:case this.constants.teams.settings.stickersEnabled:case this.constants.teams.settings.giphyRating:case this.constants.teams.settings.giphyEnabled:case this.constants.teams.settings.adminDeleteEnabled:case this.constants.teams.settings.deleteEnabled:case this.constants.teams.settings.editEnabled:case this.constants.teams.settings.messageThreading:e[t]=s;break;default:this.logger.error("Trying to set invalid property value "+t)}},t.prototype.initFeatureSettings=function(){this.featureSettings=[];var e=this.settingsService.valueAsBoolean(this.constants.settings.names.enableNewTerminologyForTeamChannelFavorites)?this.resources.strings.team_dashboard_atMentions_channel_permission:this.resources.strings.team_dashboard_atMentions_channel_permission_fav_state;this.featureSettings.push({settingName:this.constants.teams.settings.teamMention,inputId:"mentions_channel",labelText:e,labelId:"mentions_channel_label"})},t.prototype.isSharedChannel=function(){return this.channel&&this.channel.channelType===teamspace.services.ChannelType.Shared},t.prototype.getAppPermissionSettings=function(e){var t=[];return this.settingsService.valueAsBoolean(this.constants.settings.names.hideAppEntryPointsOnSharedChannel)&&this.isSharedChannel()||t.push({settingName:this.constants.teams.settings.createTab,inputId:e+"cud_apps_tabs",labelText:this.resources.strings.team_dashboard_apps_tabs_cud_permission,labelId:e+"cud_apps_tabs_label",isSubSetting:!0}),t},t.prototype.initUserPermissionSettings=function(e){var t=[];return t=t.concat(this.getAppPermissionSettings(e),this.getMessagePermissionSettings(e))},t}(s(136).BasePermissionSectionController);t.ChannelPermissionSectionController=a,angular.module("teamspace.channelPermissionSection",["teamspace.ariaLiveService","teamspace.dialogService","teamspace.channelMembershipPropertiesService","teamspace.channelService","teamspace.channelSettingsService","teamspace.conversationsService","skypeX.chatServiceClient","teamspace.exceptionUtilityService","skypeX.tenantSettingsStore","teamspace.settingsService","teamspace.constants"]).directive("channelPermissionSection",[function(){return{restrict:"E",scope:{},bindToController:{objectId:"=?"},template:i,controller:a,controllerAs:"tsp"}}])},2212:function(e,t,s){"use strict";var n=this&&this.__extends||function(){var e=function(t,s){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s])})(t,s)};return function(t,s){function n(){this.constructor=t}e(t,s),t.prototype=null===s?Object.create(s):(n.prototype=s.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=s(308),a=s(2213),o=function(e){function t(t,s,n,i,a,o,r,c,l,d,g,m,p,u,h,b,v,S,_,f,y,T,k,w,x,C,P,E,$){var N=e.call(this,u,t,s,b,n,i,a,o,r,c,l,d,g,m,C)||this;if(N.$scope=h,N.analyticsService=b,N.channelService=S,N.dialogService=_,N.notesEntityService=T,N.peopleTargetingService=k,N.teamMembershipPropertiesService=x,N.tooltipService=P,N.tooltipCssApplicators=E,N.utilityService=$,N.guestIdPrefix="guest",N.guestPermissionSettings=[],N.sectionErrors={},N.teamTagSettingsStatus=teamspace.components.TagSettingsLoadingStatus,N.ownersCanOverwriteTagSettings=!0,N.tenantDisallowedSources=[],N.tagSources=[],N.teamCodeGenerateButtonId="generate-team-code-button",N.teamCodeSpanId="team-code-value-span",N.logger=l.newLogger("TeamPermission"),N.team=S.getTeamByObjectId(N.objectId),!N.team)return N.logger.error("Invalid objectId passed. Team not present for the id "+N.objectId),N;if(g.valueAsBoolean(a.settings.names.disableTeamChannelMentionForLargeTeamSize)){var A=o.getConversation(N.objectId),I=g.valueFor(a.settings.names.teamSizeToDisableMention);A&&A.totalUserCount()>=I&&(N.disableMentionSettings=!0,N.atMentionWarningMessage=s.instant(d.strings.team_dashboard_feature_settings_at_mention_warning_message,{teamSizeLimit:I}))}N.useTeamLockedState=g.valueAsBoolean(a.settings.names.enablePendingMembers)&&N.team.isTeamLocked,N.isWindowsOS=w.getOS()===a.os.windows,N.isTeamCodeShown=f.areTeamCodesEnabled()&&!N.team.dynamicMembership,N.isTeamCodeEnabled=N.isTeamCodeShown&&!N.useTeamLockedState,N.guardianEmailAdminPolicy=p.getSettingValue(SkypeX.Services.EducationAssignmentsAppPolicyStorageKey.parentDigestEnabledType),N.isGuardianNotificationSettingsEnabled=g.valueAsBoolean(a.settings.names.enableGuardianNotificationSettings),N.enableNotebookSettings=g.valueAsBoolean(a.settings.names.enableNotebookSettings),N.enableNotebookSettingsMigrated=g.valueAsBoolean(a.settings.names.enableNotebookSettingsMigrated),N.isPrivateChannelsEnabled=g.valueAsBoolean(a.settings.names.enableNiji),N.enableDiscoverySettings=g.valueAsBoolean(a.settings.names.enableTeamDiscoverabilitySetting)&&N.team.visibility===a.teams.visibility.private&&2!==N.team.teamType,N.enableTeamMemberTags=g.valueAsBoolean(a.settings.names.enableTeamMemberTags),N.enableScheduledTags=g.valueAsBoolean(a.settings.names.enableScheduledTags),N.featureTitle_desc=s.instant(d.strings.team_dashboard_feature_settings_desc),N.memberTitle_desc=s.instant(d.strings.team_dashboard_permissions_desc),N.giphyTitle_action_permission=s.instant(d.strings.team_dashboard_fun_control_giphy_actions_team_permission),N.threadUpdateCounterName=a.counters.editTeamSetting,N.guestTitle=s.instant(d.strings.team_dashboard_guest_permissions_title),N.guestTitle_desc=s.instant(d.strings.team_dashboard_permissions_desc_guest),N.teamcodeTitle=s.instant(d.strings.team_code_section_title),N.teamcodeTitle_desc=s.instant(d.strings.team_code_section_description);var M=N.useTeamLockedState?d.strings.team_code_section_locked_notice:d.strings.team_code_section_guest_disclaimer;return N.teamcodeNotice=s.instant(M),N.guardiannotificationTitle=s.instant(d.strings.team_dashboard_guardian_notification_settings_title),N.guardiannotificationTitle_desc=s.instant(d.strings.team_dashboard_guardian_notification_settings_desc),N.discoveryTitle=s.instant(d.strings.team_dashboard_discovery_actions_title),N.discoveryTitle_desc=s.instant(d.strings.team_dashboard_discovery_actions_desc),N.discoveryTitle_action_teams=s.instant(d.strings.team_dashboard_discovery_actions_teams),N.displayGuardianNotificationSettings=!1,N.displayGuestSettings=!0,N.isAppsDiscoveryEnabled=v.isAppsDiscoveryEnabled(),N.isDigitalSignageFeatureEnabled=g.valueAsBoolean(a.settings.names.enableDigitalSignageManagement),N.isGuardianNotificationSettingsEnabled&&N.team&&2===N.team.teamType&&"Enabled"===N.guardianEmailAdminPolicy&&v.getInstalledAppForTeam(N.team.objectId,a.appId.assignments,"team-permission-section").then(function(e){e&&(N.displayGuardianNotificationSettings=!0,N.classSettings=C.getClassSettings(N.team.objectId),N.initGuardianNotificationSettings())}),N.userSettings=C.getAllMemberSettings(N.team.objectId),N.guestSettings=C.getAllGuestSettings(N.team.objectId),N.initGiphySettings(),N.initGeneralChannelSettings(),N.showGeneralChannelOnly?N:(N.initNotebookSettings(),N.enableTeamMemberTags&&N.initTagsSettings(),N.isTeamCodeEnabled&&N.initTeamCodeSettings(),N.waitForEditDeleteTenantSettings().then(function(){N.initFeatureSettings(),N.memberPermissionsSettings=N.initUserPermissionSettings(N.memberIdPrefix),y.isGuestAccessEnabled().then(function(e){N.isGuestAccessEnabled=e,e&&(N.guestPermissionSettings=N.initGuestUserPermissionSettings(N.guestIdPrefix))})}),N.team.dynamicMembership&&N.teamCode&&S.deleteTeamJoinCode(N.objectId).then(function(){N.teamCode=void 0,N.clearTeamCodeError()}),N.enableDiscoverySettings&&(N.groupId=o.getConversation(N.objectId).groupId,S.getTeamIsDiscoverable(N.groupId).then(function(e){N.isTeamDiscoveryEnabled=e,N.discoverySettingsLoaded=!0}).catch(function(e){N.discoverySettingsLoaded=!1;var t=s.instant(d.strings.team_dashboard_discovery_actions_error_load);n.update(t,!0)})),N)}return n(t,e),t.$inject=["$timeout","$translate","ariaLiveService","chatServiceClient","constants","conversationsService","conversationsStore","exceptionUtilityService","loggingService","resources","settingsService","tenantSettingsStore","educationAssignmentsAppPolicyStore","$q","$scope","analyticsService","appsService","channelService","dialogService","discoverService","guestAccessService","notesEntityService","peopleTargetingService","platformDetectService","teamMembershipPropertiesService","teamSettingsService","tooltipService","tooltipCssApplicators","utilityService"],Object.defineProperty(t.prototype,"isSourceArchived",{get:function(){return this.team.isArchived},enumerable:!0,configurable:!0}),t.prototype.isAdmin=function(){return this.team&&this.teamMembershipPropertiesService.isAdmin(this.team.objectId)},t.prototype.getScenarioData=function(e){var t;return t={},t[this.constants.scenarioDataPropNames.teamId]=this.objectId,t[this.constants.scenarioDataPropNames.data]=JSON.stringify({serializedAdminSettings:e,groupId:this.groupId||""}),t},t.prototype.clearTeamCodeError=function(){this.teamCodeError=null},t.prototype.conveyTeamCodeError=function(e){this.teamCodeError=this.$translate.instant(e),this.ariaLiveService.update(this.teamCodeError,!0)},t.prototype.narrateTeamCode=function(){var e;e=this.teamCode?this.$translate.instant(this.resources.strings.team_code_value_message,{code:this.teamCode}):this.$translate.instant(this.resources.strings.team_has_no_code_message),this.ariaLiveService.update(e,!0)},t.prototype.focusOnNextDigest=function(e,t){t===document.activeElement&&this.$timeout(function(){return angular.element("#"+e).focus()},0,!1)},t.prototype.initGuardianNotificationSettings=function(){this.displayGuardianNotificationSettings&&(this.guardianNotificationSettings=[{settingName:this.constants.teams.settings.guardianAssignmentEmail,inputId:"guardian_assignment_email",labelText:this.resources.strings.team_dashboard_guardian_assignment_email,labelId:"guardian_assignment_email_label"}])},t.prototype.initTeamCodeSettings=function(){this.copyTeamCodePopoverId=this.utilityService.generateUUID(),this.teamCodeControlButtons=[{onClick:this.presentTeamCode.bind(this),classes:{"icons-expand":!0},trackOutcome:teamspace.components.PanelActionOutcome.show,trackScenario:teamspace.components.PanelActionScenario.presentTeamCode,trackSummary:"Present Team Code",svgSrc:"svg/icons-expand.html",text:this.$translate.instant(this.resources.strings.present_team_code_button_text),dataTid:"present-team-code-button"},{onClick:this.resetTeamCode.bind(this),classes:{"icons-refresh":!0},trackOutcome:teamspace.components.PanelActionOutcome.submit,trackScenario:teamspace.components.PanelActionScenario.resetTeamCode,trackSummary:"Reset Team Code",svgSrc:"svg/icons-refresh.html",text:this.$translate.instant(this.resources.strings.reset_team_code_button_text),dataTid:"reset-team-code-button"},{onClick:this.removeTeamCode.bind(this),classes:{"icons-delete":!0},trackOutcome:teamspace.components.PanelActionOutcome.submit,trackScenario:teamspace.components.PanelActionScenario.removeTeamCode,trackSummary:"Remove Team Code",svgSrc:"svg/icons-delete.html",text:this.$translate.instant(this.resources.strings.remove_team_code_button_text),dataTid:"remove-team-code-button"},{id:t.TEAM_CODE_COPY_BUTTON_ID,onClick:this.copyTeamCode.bind(this),classes:{"icons-copy":!0},trackOutcome:teamspace.components.PanelActionOutcome.submit,trackScenario:teamspace.components.PanelActionScenario.copyTeamCode,trackSummary:"Copy Team Code",svgSrc:"svg/icons-copy.html",text:this.$translate.instant(this.resources.strings.copy_team_code_button_text),dataTid:"copy-team-code-button"}],this.loadTeamCode(!0)},t.prototype.loadTeamCode=function(e){var t=this;this.isUpdatingTeamCode||(this.isUpdatingTeamCode=!0,this.channelService.getTeamJoinCode(this.objectId).then(function(s){t.teamCode=s,t.teamCodeLoaded=!0,e||t.narrateTeamCode()}).catch(function(e){t.teamCodeLoaded=!1;var s=t.$translate.instant(t.resources.strings.failed_to_load_team_code)+" "+t.$translate.instant(t.resources.strings.load_again_team_code_button_text);t.ariaLiveService.update(s,!0)}).finally(function(){t.isUpdatingTeamCode=!1}))},t.prototype.generateTeamCode=function(e){var t=this;this.isUpdatingTeamCode||(this.isUpdatingTeamCode=!0,this.channelService.createTeamJoinCode(this.objectId).then(function(s){t.teamCode=s,t.narrateTeamCode(),t.clearTeamCodeError(),t.focusOnNextDigest(t.teamCodeSpanId,e.currentTarget)}).catch(function(e){t.conveyTeamCodeError(t.resources.strings.failed_to_generate_team_code)}).finally(function(){t.isUpdatingTeamCode=!1}))},t.prototype.presentTeamCode=function(){this.clearTeamCodeError(),this.dialogService.open(this.constants.dialogs.presentTeamJoinCode,{team:this.team,teamJoinCode:this.teamCode})},t.prototype.resetTeamCode=function(){var e=this;this.isUpdatingTeamCode||(this.isUpdatingTeamCode=!0,this.channelService.createTeamJoinCode(this.objectId).then(function(t){e.teamCode=t,e.narrateTeamCode(),e.clearTeamCodeError()}).catch(function(t){e.conveyTeamCodeError(e.resources.strings.failed_to_reset_team_code)}).finally(function(){e.isUpdatingTeamCode=!1}))},t.prototype.removeTeamCode=function(e){var t=this;this.isUpdatingTeamCode||(this.isUpdatingTeamCode=!0,this.channelService.deleteTeamJoinCode(this.objectId).then(function(){t.teamCode=void 0,t.narrateTeamCode(),t.clearTeamCodeError(),t.focusOnNextDigest(t.teamCodeGenerateButtonId,e.currentTarget)}).catch(function(e){t.conveyTeamCodeError(t.resources.strings.failed_to_remove_team_code)}).finally(function(){t.isUpdatingTeamCode=!1}))},t.prototype.copyTeamCode=function(e){var s=this;this.clearTeamCodeError(),this.utilityService.copyToClipboard(this.teamCode),this.showTeamCodeCopiedTooltip(e,this.$scope,angular.element("#"+t.TEAM_CODE_COPY_BUTTON_ID));var n=this.$translate.instant(this.resources.strings.team_code_copied_popup_message);this.ariaLiveService.update(n,!0),this.$timeout(function(){s.tooltipService.clearTooltip(teamspace.services.TooltipType.Popover,s.copyTeamCodePopoverId)},t.TEAM_CODE_COPIED_POPOVER_TIMEOUT,!1)},t.prototype.showTeamCodeCopiedTooltip=function(e,t,s){var n=this,i={templateUrl:"message-team-code-copied",trigger:"manual",container:"body",placement:"auto",target:s,scope:this.$scope,autoClose:!0,onHide:function(){s.focus()}},a={sourceElement:s,tooltipType:teamspace.services.TooltipType.Popover,options:i,tooltipId:this.copyTeamCodePopoverId,cssApplicator:function(){n.tooltipCssApplicators.contextMenu(e,"#messageTeamCodeCopied",null,s)}};e.preventDefault(),e.stopPropagation(),this.tooltipService.showTooltip(a)},t.prototype.handleGeneralChannelSettingsClick=function(e,t,s){!this.isSourceArchived&&this.isAdmin()&&this.updateGeneralChannelSetting(t)},t.prototype.initGeneralChannelSettings=function(){this.generalChannelSettings=[{inputId:"general-setting-anyonePost",inputValue:teamspace.components.GeneralChannelSettings.AnyonePost,labelText:this.resources.strings.team_dashboard_general_channel_anyone_posts},{inputId:"general-setting-anyoneWarn",inputValue:teamspace.components.GeneralChannelSettings.AnyoneWithWarning,labelText:this.resources.strings.team_dashboard_general_channel_warn_many_recipients},{inputId:"general-setting-OwnerPost",inputValue:teamspace.components.GeneralChannelSettings.OwnersPost,labelText:this.resources.strings.team_dashboard_general_channel_owner_posts_only}]},t.prototype.initNotebookSettings=function(){var e=this;if(2==this.team.teamType?(this.notebookSettingsTitle=this.$translate.instant(this.resources.strings.team_dashboard_class_notebook_title),this.notebookNotSetupLabel=this.$translate.instant(this.resources.strings.team_dashboard_class_notebook_not_setup),this.notebookSectionsTitle=this.$translate.instant(this.resources.strings.team_dashboard_class_nb_sections),this.createOwnerOnlyButtonTitle=this.$translate.instant(this.resources.strings.team_dashboard_class_nb_owner_section)):4==this.team.teamType&&(this.notebookSettingsTitle=this.$translate.instant(this.resources.strings.team_dashboard_staff_notebook_title),this.notebookNotSetupLabel=this.$translate.instant(this.resources.strings.team_dashboard_staff_notebook_not_setup),this.notebookSectionsTitle=this.$translate.instant(this.resources.strings.team_dashboard_staff_nb_sections),this.createOwnerOnlyButtonTitle=this.$translate.instant(this.resources.strings.team_dashboard_staff_nb_owner_section)),!this.enableNotebookSettingsMigrated||this.enableNotebookSettings||2!=this.team.teamType&&4!=this.team.teamType||(2==this.team.teamType?this.notebookSettingsMigratedLabel=this.$translate.instant(this.resources.strings.team_dashboard_edu_class_notebook_settings_migrated):4==this.team.teamType&&(this.notebookSettingsMigratedLabel=this.$translate.instant(this.resources.strings.team_dashboard_edu_staff_notebook_settings_migrated)),this.showNotebookSettingsMigrated=!0),(2==this.team.teamType||4==this.team.teamType)&&this.enableNotebookSettings&&(this.sectionsDirty=!1,this.savedSections=!1,this.savingSections=!1,this.showNotebookError=!1,this.noSectionNameErrors=!0,this.showNotebookSettings=!0,1==this.team.teamStatus.teamClassNotebookCreationStatus)){var t=this.loggingService.newScenario(this.constants.scenarios.edu.notebookSettings.getSettings);this.notesEntityService.getEduNotebookSettings(this.team.objectId).then(function(s){t.stop(),e.eduNotebookSettings=s,e.notebookSectionsSaved=angular.copy(s.memberSections),e.ownerSectionStatus=s.hasOwnerOnlySectionGroup?teamspace.components.OwnerSectionStatus.Locked:teamspace.components.OwnerSectionStatus.Unlocked}).catch(function(e){t.fail()})}},t.prototype.copyLink=function(){var e=this;this.copied=!0,this.utilityService.copyToClipboard(this.eduNotebookSettings.links.oneNoteWebUrl.href),this.$timeout(function(){e.copied=!1},2e3,!1)},t.prototype.addSection=function(){var e=this;this.sectionsDirty=!0;for(var t=1,s=this.$translate.instant(this.resources.strings.team_dashboard_edu_nb_new_section),n=this.eduNotebookSettings.memberSections;n.find(function(n){return n.toLowerCase()===e.utilityService.format(s,t).toLowerCase()});)t++;this.eduNotebookSettings.memberSections.push(this.utilityService.format(s,t)),this.$timeout(function(){var t=e.eduNotebookSettings.memberSections.length-1;angular.element("#"+e.constants.teams.settings.section+t).focus()},250,!1)},t.prototype.editSection=function(e){angular.element("#"+this.constants.teams.settings.section+e).focus()},t.prototype.resetSections=function(){this.eduNotebookSettings.memberSections=angular.copy(this.notebookSectionsSaved);for(var e=0;e<this.notebookSectionsSaved.length;e++)angular.element("#"+this.constants.teams.settings.section+e).val(this.notebookSectionsSaved[e]),delete this.sectionErrors[e];this.sectionsDirty=!1,this.noSectionNameErrors=!0},t.prototype.keyUpHandler=function(e,t){var s=e.currentTarget.value,n=this.eduNotebookSettings.memberSections[t],i=/[#%&*:"\\|<>\/?]/g,a=this.eduNotebookSettings.memberSections;this.eduNotebookSettings.memberSections[t]=s,this.sectionsDirty=!0,0===s.length?this.sectionErrors[t]=this.$translate.instant(this.resources.strings.team_dashboard_edu_nb_empty_section_error):" "===s[0]?this.sectionErrors[t]=this.$translate.instant(this.resources.strings.team_dashboard_edu_nb_space_start_section_error):i.test(s)?this.sectionErrors[t]=this.$translate.instant(this.resources.strings.team_dashboard_edu_nb_splchar_section_error):a.indexOf(s)!==t||a.lastIndexOf(s)!==t?this.sectionErrors[t]=this.$translate.instant(this.resources.strings.team_dashboard_edu_nb_duplicate_section_error):delete this.sectionErrors[t];var o=a.indexOf(n);o===a.lastIndexOf(n)&&this.sectionErrors[o]===this.$translate.instant(this.resources.strings.team_dashboard_edu_nb_duplicate_section_error)&&delete this.sectionErrors[o],this.noSectionNameErrors=angular.equals(this.sectionErrors,{})},t.prototype.updateSections=function(){var e=this;if(!this.propertiesUpdatePromises[this.constants.teams.settings.section]){var t=this.loggingService.newScenario(this.constants.scenarios.edu.notebookSettings.patchAndGetSections);this.sectionsDirty=!1,this.savingSections=!0,this.propertiesUpdatePromises[this.constants.teams.settings.section]=this.notesEntityService.setEduNotebookSettings(this.team.objectId,this.eduNotebookSettings).then(function(){t.mark("patch_sections_resolved"),e.notesEntityService.getEduNotebookSettings(e.team.objectId).then(function(s){t.stop(),e.notebookSectionsSaved=angular.copy(s.memberSections),e.resetSections(),e.savingSections=!1,e.savedSections=!0,e.$timeout(function(){e.savedSections=!1},2e3,!1)}).catch(function(s){t.fail({error:s}),e.savingSections=!1,e.showNotebookError=!0})}).catch(function(s){t.fail({error:s}),e.sectionsDirty=!0,e.savingSections=!1,e.showErrorDialog()}).finally(function(){delete e.propertiesUpdatePromises[e.constants.teams.settings.section]})}},t.prototype.addOwnerOnlySection=function(){var e=this;if(!this.eduNotebookSettings.hasOwnerOnlySectionGroup&&!this.propertiesUpdatePromises[this.constants.teams.settings.ownerSection]){var t=this.loggingService.newScenario(this.constants.scenarios.edu.notebookSettings.addOwnerSection);this.ownerSectionStatus=teamspace.components.OwnerSectionStatus.Enabling,this.eduNotebookSettings.hasOwnerOnlySectionGroup=!0,this.propertiesUpdatePromises[this.constants.teams.settings.ownerSection]=this.notesEntityService.setEduNotebookSettings(this.team.objectId,this.eduNotebookSettings).then(function(s){t.stop(),e.ownerSectionStatus=teamspace.components.OwnerSectionStatus.Locked},function(s){t.fail({error:s}),e.ownerSectionStatus=teamspace.components.OwnerSectionStatus.Failure,e.eduNotebookSettings.hasOwnerOnlySectionGroup=!1}).finally(function(){delete e.propertiesUpdatePromises[e.constants.teams.settings.ownerSection]})}},t.prototype.showErrorDialog=function(){this.dialogService.open(this.constants.dialogs.errorDialog,{errorTitle:this.$translate.instant(this.resources.strings.team_dashboard_edu_nb_update_error_title),doneButtonMessage:this.$translate.instant(this.resources.strings.team_dashboard_edu_nb_update_error_ok)})},t.prototype.toggleCollaborationLock=function(){var e=this;if(!this.propertiesUpdatePromises[this.constants.teams.settings.collabLock]){var t=this.loggingService.newScenario(this.constants.scenarios.edu.notebookSettings.toggleCollabLock);this.eduNotebookSettings.isCollaborationSpaceLocked=!this.eduNotebookSettings.isCollaborationSpaceLocked,this.propertiesUpdatePromises[this.constants.teams.settings.collabLock]=this.notesEntityService.setEduNotebookSettings(this.team.objectId,this.eduNotebookSettings).then(function(){t.stop()}).catch(function(s){t.fail({error:s}),e.eduNotebookSettings.isCollaborationSpaceLocked=!e.eduNotebookSettings.isCollaborationSpaceLocked}).finally(function(){delete e.propertiesUpdatePromises[e.constants.teams.settings.collabLock]})}},t.prototype.updateGeneralChannelSetting=function(e){this.userSettings.generalChannelSetting=e,this.userSettings[this.constants.teams.settings.generalChannelSetting]=e,this.updateChannelSettings(this.constants.teams.settings.generalChannelSetting)},t.prototype.setAndGetSpaceAdminSettingsLocal=function(e,t,s){if(t===this.classSettings)for(var n in e)this.teamSettingsService.setClassSettings(t,n,e[n]);else for(var n in e)this.teamSettingsService.setTeamSettings(t,n,e[n]),s&&this.setDisabledStateChildSetting(e[n],s);return this.setAndGetSpaceAdminSettingsLocalHelper(e,t)},t.prototype.setDisabledStateChildSetting=function(e,t){var s=this.memberPermissionsSettings.filter(function(e){return e.parentInputId===t}),n=this.guestPermissionSettings.filter(function(e){return e.parentInputId===t});if((s=s.concat(n))&&s.length)for(var i=0,a=s;i<a.length;i++)a[i].isDisabledbyParent=!e},t.prototype.handleTeamDiscoverySettingToggle=function(e,t){var s=this;this.sendDiscoverabilityChangedTelemetry(t),this.channelService.setTeamIsDiscoverable(this.groupId,t).then(function(e){s.isTeamDiscoveryEnabled=e,s.discoverySettingsError=!1}).catch(function(e){s.isTeamDiscoveryEnabled=!t,s.discoverySettingsError=!0;var n=s.$translate.instant(s.resources.strings.team_dashboard_discovery_actions_error_update);s.ariaLiveService.update(n,!0)})},t.prototype.sendDiscoverabilityChangedTelemetry=function(e){var t=this;_.defer(function(){var s={action:{gesture:teamspace.components.PanelActionGesture.click,outcome:teamspace.shared.AttributeHelper.tryGetEnum(teamspace.components.PanelActionOutcome.select.toString(),teamspace.components.PanelActionOutcome,t.logger),scenario:teamspace.shared.AttributeHelper.tryGetEnum(teamspace.components.PanelActionScenario.selectDiscoverability.toString(),teamspace.components.PanelActionScenario,t.logger),scenarioType:teamspace.shared.AttributeHelper.tryGetEnum(teamspace.components.PanelActionScenarioType.manageTeamDiscoverySetting.toString(),teamspace.components.PanelActionScenarioType,t.logger)},module:{name:teamspace.shared.AttributeHelper.tryGetEnum(teamspace.components.PanelModuleName.discoverabilityCheckbox.toString(),teamspace.components.PanelModuleName,t.logger),state:e?t.constants.teams.discoverability.discoverable:t.constants.teams.discoverability.notDiscoverable,type:teamspace.shared.AttributeHelper.tryGetEnum(teamspace.components.PanelModuleType.other.toString(),teamspace.components.PanelModuleType,t.logger),summary:"Discoverability checkbox"}};t.analyticsService.onPanelAction(t.$scope,s)})},t.prototype.initFeatureSettings=function(){var e=this;this.featureSettings=[],this.featureSettings.push({settingName:this.constants.teams.settings.teamMention,inputId:"mentions_team",labelText:this.resources.strings.team_dashboard_atMentions_team_permission,labelId:"mentions_team_label"});var t=this.settingsService.valueAsBoolean(this.constants.settings.names.enableNewTerminologyForTeamChannelFavorites)?this.resources.strings.team_dashboard_atMentions_channel_permission:this.resources.strings.team_dashboard_atMentions_channel_permission_fav_state;if(this.featureSettings.push({settingName:this.constants.teams.settings.channelMention,inputId:"mentions_channel",labelText:t,labelId:"mentions_channel_label"}),this.disableMentionSettings){var s=this.$q.resolve(void 0);this.userSettings[this.constants.teams.settings.teamMention]&&(this.userSettings[this.constants.teams.settings.teamMention]=!1,s=this.updateChannelSettings(this.constants.teams.settings.teamMention)),s.then(function(){e.userSettings[e.constants.teams.settings.channelMention]&&(e.userSettings[e.constants.teams.settings.channelMention]=!1,e.updateChannelSettings(e.constants.teams.settings.channelMention))}).finally(function(){e.logger.info("teamMentionSetting: "+e.userSettings[e.constants.teams.settings.teamMention]+", channelMentionSetting: "+e.userSettings[e.constants.teams.settings.channelMention])})}},t.prototype.getDisabledSettingText=function(e,t){var s=null;return e===this.constants.teams.settings.createPrivateSpace?s=this.$translate.instant(this.resources.strings.team_dashboard_permissions_create_private_channel_blocked_by_parent_setting):e===this.constants.teams.settings.createTopic&&t?s=this.$translate.instant(this.resources.strings.team_dashboard_permissions_guest_create_channel_blocked_by_parent_setting):e===this.constants.teams.settings.deleteTopic&&t&&(s=this.$translate.instant(this.resources.strings.team_dashboard_permissions_guest_delete_channel_blocked_by_parent_setting)),s},t.prototype.getChannelPermissionSettings=function(e,t){var s=this;void 0===t&&(t=!1);var n=[],i=null;t&&(i=this.memberPermissionsSettings.find(function(e){return e.settingName===s.constants.teams.settings.createTopic})),n.push({settingName:this.constants.teams.settings.createTopic,inputId:e+"cud_channels",labelText:t?this.resources.strings.team_dashboard_channel_cud_permission_guest:this.isPrivateChannelsEnabled?this.resources.strings.team_dashboard_channel_cud_permission_niji:this.resources.strings.team_dashboard_channel_cud_permission,labelId:e+"cud_channels_label",parentInputId:i?i.inputId:null,isDisabledbyParent:i?!this.userSettings[this.constants.teams.settings.createTopic]:null}),!t&&this.isDigitalSignageFeatureEnabled&&n.push({settingName:this.constants.teams.settings.addDisplayContent,inputId:e+"addremove_content_to_display",labelText:this.resources.strings.team_dashboard_channel_addremove_content_to_display,labelId:e+"addremove_content_to_display_label",parentInputId:null,isDisabledbyParent:null}),this.isPrivateChannelsEnabled&&!t&&n.push({settingName:this.constants.teams.settings.createPrivateSpace,inputId:e+"create_private_channel",labelText:this.resources.strings.team_dashboard_channel_private_permission,labelId:e+"create_private_channel_label",parentInputId:e+"cud_channels",isDisabledbyParent:!this.userSettings[this.constants.teams.settings.createTopic]});var a=null;return t&&(a=this.memberPermissionsSettings.find(function(e){return e.settingName===s.constants.teams.settings.deleteTopic})),n.push({settingName:this.constants.teams.settings.deleteTopic,inputId:e+"delete_channels",labelText:t?this.resources.strings.team_dashboard_channel_delete_permission_guest:this.isPrivateChannelsEnabled?this.resources.strings.team_dashboard_channel_delete_permission_niji:this.resources.strings.team_dashboard_channel_delete_permission,labelId:e+"delete_channels_label",parentInputId:a?a.inputId:null,isDisabledbyParent:a?!this.userSettings[this.constants.teams.settings.deleteTopic]:null}),n},t.prototype.getAppPermissionSettings=function(e){var t=[];return t.push({settingName:this.constants.teams.settings.installApp,inputId:e+"cud_apps",labelText:this.resources.strings.team_dashboard_apps_install_permission,labelId:e+"cud_apps_label"}),this.settingsService.valueAsBoolean(this.constants.settings.names.enableSideloadingEnforcement)&&t.push({settingName:this.constants.teams.settings.uploadCustomApp,inputId:e+"cud_apps_custom",labelText:this.resources.strings.team_dashboard_apps_custom_upload_permission,labelId:e+"cud_apps_custom_label"}),t.push({settingName:this.constants.teams.settings.createTab,inputId:e+"cud_apps_tabs",labelText:this.resources.strings.team_dashboard_apps_tabs_cud_permission,labelId:e+"cud_apps_tabs_label",isSubSetting:!0}),this.isAppsDiscoveryEnabled&&t.push({settingName:this.constants.teams.settings.createIntegration,inputId:e+"cud_apps_connectors",labelText:this.resources.strings.team_dashboard_apps_connectors_cud_permission,labelId:e+"cud_apps_connectors_label",isSubSetting:!0}),t},t.prototype.initUserPermissionSettings=function(e){var t=[];return t=t.concat(this.getChannelPermissionSettings(e),this.getAppPermissionSettings(e),this.getMessagePermissionSettings(e))},t.prototype.initGuestUserPermissionSettings=function(e){return this.getChannelPermissionSettings(e,!0)},t.prototype.initTagsSettings=function(){return this.addTagsSettingOptions=[{value:teamspace.components.TagSettings.OwnersOnly,text:this.$translate.instant(this.resources.strings.team_dashboard_tags_settings_manage_tags_control_owners_only_option)},{value:teamspace.components.TagSettings.AllMembers,text:this.$translate.instant(this.resources.strings.team_dashboard_tags_settings_manage_tags_control_owners_and_members_option)}],this.tagSources=[{key:Teams.Models.TagSource.Shifts,name:this.$translate.instant(this.resources.strings.extensioncatalog_appShiftsName),enabled:!0}],this.loadTagSettings()},t.prototype.loadTagSettings=function(){var e=this;return this.teamTagSettingsLoadingStatus=this.teamTagSettingsStatus.Loading,this.loadTenantTagSettings().then(function(){return e.teamTagSettingsLoadingStatus===e.teamTagSettingsStatus.Disabled?e.$q.resolve():e.loadTeamTagSettings()}).finally(function(){e.teamTagSettingsLoadingStatus===e.teamTagSettingsStatus.Loading&&(e.teamTagSettingsLoadingStatus=e.teamTagSettingsStatus.Succeeded)})},t.prototype.loadTenantTagSettings=function(){var e=this;return this.peopleTargetingService.getTenantTagSettings("team-permission-section").then(function(t){if(t.tagPermissions===Teams.Models.TenantTagPermissions.Disabled)return e.teamTagSettingsLoadingStatus=e.teamTagSettingsStatus.Disabled,e.$q.resolve();e.ownersCanOverwriteTagSettings=t.ownersCanOverwriteTagSettings,e.ownersCanOverwriteTagSettings||(e.addTagsSetting=t.tagPermissions===Teams.Models.TenantTagPermissions.TeamOwners?teamspace.components.TagSettings.OwnersOnly:teamspace.components.TagSettings.AllMembers),e.tenantDisallowedSources=t.disallowedSources||[],e.updateTagSourcesFromDisallowedSources(e.tenantDisallowedSources)}).catch(function(){e.peopleTargetingService.tagsEnabled()||(e.teamTagSettingsLoadingStatus=e.teamTagSettingsStatus.Disabled)})},t.prototype.loadTeamTagSettings=function(){var e=this;return this.peopleTargetingService.getTeamTagSettings(this.objectId,"team-permission-section",!0).then(function(t){e.addTagsSetting=t.onlyOwnersCanUpdate?teamspace.components.TagSettings.OwnersOnly:teamspace.components.TagSettings.AllMembers,e.updateTagSourcesFromDisallowedSources(t.disallowedSources)}).catch(function(){e.teamTagSettingsLoadingStatus=e.peopleTargetingService.tagsEnabled()?e.teamTagSettingsStatus.Failed:e.teamTagSettingsStatus.Disabled})},t.prototype.updateTagSourcesFromDisallowedSources=function(e){var t=this;this.enableScheduledTags&&e&&0!=e.length&&_.each(e,function(e){var s=t.tenantDisallowedSources.indexOf(e)>-1,n=_.find(t.tagSources,function(t){return t.key===e});s?n&&(t.tagSources=_.filter(t.tagSources,function(t){return t.key!==e})):n?n.enabled=!1:t.tagSources.push({key:e,name:e,enabled:!1})})},t.prototype.updateAddTagsSetting=function(){var e=this;if(!this.peopleTargetingService.tagsEnabled())return this.teamTagSettingsLoadingStatus=teamspace.components.TagSettingsLoadingStatus.Disabled,this.$q.resolve();var t=this.addTagsSetting===teamspace.components.TagSettings.OwnersOnly,s=this.getDisallowedTagSources();return this.peopleTargetingService.updateTeamTagSettings(this.objectId,t,s,"team-permission-section").then(function(){var s=t?teamspace.components.PanelActionScenario.changedTagPermissionToOwnersOnly.toString():teamspace.components.PanelActionScenario.changedTagPermissionToAll.toString();e.sendTagSettingsTelemetry(s)}).catch(function(){return e.onUpdateTeamTagSettingsFailed()})},t.prototype.updateTagSettingsSource=function(e,t){var s=this;if(!this.peopleTargetingService.tagsEnabled())return this.teamTagSettingsLoadingStatus=teamspace.components.TagSettingsLoadingStatus.Disabled,this.$q.resolve();e.enabled=t;var n=this.addTagsSetting===teamspace.components.TagSettings.OwnersOnly,i=this.getDisallowedTagSources();return this.peopleTargetingService.updateTeamTagSettings(this.objectId,n,i,"team-permission-section").then(function(){s.peopleTargetingService.removeAllTeamCache(s.objectId);var n=t?teamspace.components.PanelActionScenario.enabledTagSettingsSource.toString():teamspace.components.PanelActionScenario.disabledTagSettingsSource.toString(),i={tagSettingsSource:e.key};s.sendTagSettingsTelemetry(n,i)}).catch(function(){return s.onUpdateTeamTagSettingsFailed()})},t.prototype.getDisallowedTagSources=function(){return _.filter(this.tagSources,function(e){return!e.enabled}).map(function(e){return e.key})},t.prototype.onUpdateTeamTagSettingsFailed=function(){this.peopleTargetingService.tagsEnabled()?(this.errorMessage=this.$translate.instant(this.resources.strings.team_dashboard_update_permission_generic_error),this.loadTagSettings()):this.teamTagSettingsLoadingStatus=this.teamTagSettingsStatus.Disabled},t.prototype.sendTagSettingsTelemetry=function(e,t){void 0===t&&(t={});var s={action:{gesture:teamspace.components.PanelActionGesture.auto,scenario:teamspace.shared.AttributeHelper.tryGetEnum(e,teamspace.components.PanelActionScenario,this.loggingService),scenarioType:teamspace.shared.AttributeHelper.tryGetEnum(teamspace.components.PanelActionScenarioType.manageTags.toString(),teamspace.components.PanelActionScenarioType,this.logger)},module:{type:teamspace.shared.AttributeHelper.tryGetEnum(teamspace.components.PanelModuleType.other.toString(),teamspace.components.PanelModuleType,this.loggingService),name:teamspace.shared.AttributeHelper.tryGetEnum(teamspace.components.PanelModuleName.settingOption.toString(),teamspace.components.PanelModuleName,this.loggingService),summary:"Update manage tag settings"},dataBag:t};this.analyticsService.onPanelAction(this.$scope,s)},t.TEAM_CODE_COPY_BUTTON_ID="copy-team-code-button",t.TEAM_CODE_COPIED_POPOVER_TIMEOUT=2e3,t}(s(136).BasePermissionSectionController);t.TeamPermissionSectionController=o,angular.module("teamspace.teamPermissionSection",["teamspace.ariaLiveService","teamspace.dialogService","teamspace.channelService","teamspace.conversationsService","skypeX.chatServiceClient","teamspace.exceptionUtilityService","teamspace.platformDetectService","teamspace.guestAccessService","teamspace.discoverService","teamspace.notesEntityService","skypeX.tenantSettingsStore","skypeX.educationAssignmentsAppPolicyStore","teamspace.settingsService","teamspace.utilityService","teamspace.tooltipService","teamspace.tooltipCssApplicators","teamspace.constants","teamspace.appsService","teamspace.peopleTargetingService"]).run(["$templateCache",function(e){e.put("components/team-dashboard/td-settings-tab/team-permission-section/general-channel-settings.html",a)}]).directive("teamPermissionSection",[function(){return{restrict:"E",scope:{},bindToController:{showGeneralChannelOnly:"<",objectId:"=?"},template:i,controller:o,controllerAs:"tsp"}}])},2213:function(e,t){e.exports='<div class="gray-text" id="generalchanneltitle" translate-once="{{::$root.resources.strings.team_dashboard_general_channel_title}}"></div>\n<div class="td-ts-per-ss">\n  <div class="td-ts-per-item channel-moderator-setting-item" ng-repeat="genChannelSetting in tsp.generalChannelSettings track by $index" data-tid="{{::genChannelSetting.inputId}}" ng-click="tsp.handleGeneralChannelSettingsClick($event, genChannelSetting.inputValue, genChannelSetting.labelText)">\n    <input class="channel-moderator-setting-radio" name="generalChannelSetting" type="radio" ng-checked="tsp.userSettings.generalChannelSetting === genChannelSetting.inputValue" id="genChannelSetting{{$index}}" ng-disabled="!tsp.isAdmin() || tsp.isSourceArchived()"/>\n    <ng-include class="unselected-icon icon" src="\'svg/icons-radiobox-unselected.html\'"></ng-include>\n    <ng-include class="selected-icon icon" src="\'svg/icons-radiobox-selected.html\'"></ng-include>\n    <label class="channel-moderator-setting-name" translate-once="{{::genChannelSetting.labelText}}" for="genChannelSetting{{$index}}"></label>\n    </div>\n</div>'},2214:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(2215),i=function(){function e(e,t,s,n,i,a,o,r,c,l,d,g,m){this.$translate=e,this.channelMembershipPropertiesService=s,this.channelService=n,this.constants=i,this.conversationsService=a,this.dialogService=o,this.resources=r,this.routeUtilityService=c,this.settingsService=l,this.teamActionDialogUtilityService=d,this.teamMembershipPropertiesService=g,this.teamService=m,this.showNorthstarTeamSettings=this.isNorthstarTeamSettingsEnabled(),this.showNorthstarTeamSettings||(this.enableClassSetUp=l.valueAsBoolean(i.settings.names.enableClassSetUp),this.scenarioName=i.scenarios.teamDashboard.settingsTabLoad,this.isGuestUser=t.isGuestUserType(),this.teamErrors=[],this.initializeTeam())}return e.$inject=["$translate","identityService","channelMembershipPropertiesService","channelService","constants","conversationsService","dialogService","resources","routeUtilityService","settingsService","teamActionDialogUtilityService","teamMembershipPropertiesService","teamService"],Object.defineProperty(e.prototype,"isAdmin",{get:function(){return this.isChannelView?!(!this.channel||!this.channelMembershipPropertiesService.isAdmin(this.channel.objectId)):!(!this.team||!this.teamMembershipPropertiesService.isAdmin(this.team.objectId))},enumerable:!0,configurable:!0}),e.prototype.initializeTeam=function(){var e=this,t=this.routeUtilityService.getRootRouteParams();this.channelService.resolveTeamAndChannel(t.threadId).then(function(s){t.threadId===s.team.objectId?(e.team=s.team,e.enablePersonalization=2===e.team.teamType&&e.settingsService.valueAsBoolean(e.constants.settings.names.enableTeamPersonalization),e.isChannelView=!1,e.teamPictureUrl=e.getTeamPictureUrl(e.team.objectId),e.renewTeamEnabled=!0,e.checkForErrors(e.team.objectId)):t.threadId===s.channel.objectId&&(e.isChannelView=!0,e.channel=s.channel)})},Object.defineProperty(e.prototype,"showTeamSection",{get:function(){return!this.enablePersonalization&&!this.isChannelView},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showGroupRenewel",{get:function(){return this.teamExpiryDate&&!this.isChannelView},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isTeamEligibleForRenewal",{get:function(){return this.teamService.isTeamEligibleForRenewal(this.team)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"teamExpiryDate",{get:function(){return this.teamService.getTeamExpiryDate(this.team)},enumerable:!0,configurable:!0}),e.prototype.changeTeamPictureOrEditDialog=function(){!this.enableClassSetUp||2!==this.team.teamType&&3!==this.team.teamType&&4!==this.team.teamType&&1!==this.team.teamType?this.changeTeamPicture():this.openEditTeamDialog()},e.prototype.setPersonalizeTeamOrEditDialog=function(){!this.enableClassSetUp||2!==this.team.teamType&&3!==this.team.teamType&&4!==this.team.teamType&&1!==this.team.teamType?this.personalizeTeam():this.openEditTeamDialog()},e.prototype.changeTeamPicture=function(){this.team.isArchived||this.dialogService.open(this.constants.dialogs.changeTeamPicture,{team:this.team})},e.prototype.openEditTeamDialog=function(){var e=this;if(!this.team.isArchived){var t;switch(this.team.teamType){case 2:t=this.constants.dialogs.createClassTeam;break;case 3:t=this.constants.dialogs.createPLCTeam;break;case 4:t=this.constants.dialogs.createStaffTeam;break;default:t=this.constants.dialogs.createStandardTeam}this.teamService.isTeamNamePrefixSuffixRequired().then(function(t){if(t)return e.teamService.getTeamNameProperties()}).then(function(){e.dialogService.open(t,{team:e.team})})}},e.prototype.personalizeTeam=function(){this.dialogService.open(this.constants.dialogs.personalizeTeam,{team:this.team})},e.prototype.renewTeam=function(){var e=this;this.renewTeamEnabled=!1,this.teamActionDialogUtilityService.renewTeamAndOpenStateDialog(this.team,["team-renew-btn"]).finally(function(){e.renewTeamEnabled=!0})},e.prototype.getTeamPictureUrl=function(e){var t=this.conversationsService.getConversation(e),s=t&&t.threadProperties[SkypeX.Services.ChatServiceUtils.ThreadProp_Picture];return s?"url("+s+this.constants.amsImageTemplate.fullsize+")":null},e.prototype.checkForErrors=function(e){this.teamErrors=[],!this.isGuestUser&&this.teamMembershipPropertiesService.getGuestCount(e)>0&&this.teamErrors.push({text:this.$translate.instant(this.resources.strings.team_dashboard_guest_present)})},e.prototype.getTeam=function(){var e=this.routeUtilityService.getRootRouteParams();return this.channelService.getTeamByObjectId(e.threadId)},e.prototype.isNorthstarTeamSettingsEnabled=function(){return this.settingsService.valueAsBoolean(this.constants.settings.names.enableNorthstarTeamSettings)&&this.settingsService.valueAsBoolean(this.constants.settings.names.enableHybridArchitectureOnDesktop)&&this.isTeam()},e.prototype.isTeam=function(){return!!this.getTeam()},e}();t.TdSettingsTabController=i,angular.module("teamspace.tdSettingsTab",["teamspace.channelMembershipPropertiesService","teamspace.teamActionDialogUtilityService","teamspace.routeUtilityService","teamspace.identityService","teamspace.channelService","teamspace.teamService"]).directive("tdSettingsTab",[function(){return{restrict:"E",scope:{},bindToController:{},template:n,controller:i,controllerAs:"tdst"}}])},2215:function(e,t){e.exports='<div ng-if="!tdst.showNorthstarTeamSettings" class="td-settings-tab flex-fill" scenario-end="{{tdst.scenarioName}}">\n  <div ng-if="!tdst.isAdmin" class="permission-error" translate-once="{{::$root.resources.strings.team_dashboard_settings_not_admin_error}}">\n  </div>\n  <td-error-banner ng-if="tdst.teamErrors && tdst.teamErrors.length > 0" error-messages="tdst.teamErrors"></td-error-banner>\n  <div ng-if="tdst.isAdmin" simple-scrollbar class="td-settings-tab-content-wrapper">\n    <div>\n      <div class="td-team-section first-section" ng-if="::tdst.showTeamSection">\n      <div class="flex-row">\n        <a tabindex="0" class="title-col pointer" aria-labelledby="teampictitle teampicavatardesc" role="button" aria-expanded="{{!!showPicSettings}}" ng-click="showPicSettings = !showPicSettings">\n          <div class="ts-sym expand-collapse expand-collapse-button icons-gray-06-triangle-fill triangle-container" tabindex="-1" aria-hidden="true">\n            <ng-include ng-show="showPicSettings" src="\'svg/icons-triangle-down-small.html\'"></ng-include>\n            <ng-include ng-show="!showPicSettings" src="\'svg/icons-triangle-right-small.html\'"></ng-include>\n          </div>\n          <div class="title" id="teampictitle" translate-once="{{::$root.resources.strings.team_dashboard_settings_avatar}}" tabindex="-1" aria-hidden="true"></div>\n        </a>\n        <div class="detail-col">\n          <div class="caption gray-text desc" id="teampicavatardesc" translate-once="{{::$root.resources.strings.team_dashboard_settings_avatar_desc}}"></div>\n        </div>\n      </div>\n      <div ng-show="showPicSettings">\n        <div class="flex-row">\n          <div class="title-col"></div>\n          <div class="detail-col">\n          <profile-picture css-class="image-mask" display-name="tdst.team.displayName" team-id="tdst.team.siteInfo.groupId" etag="tdst.team.pictureETag" source="td-settings-tab"></profile-picture>\n          </div>\n        </div>\n        <div class="flex-row">\n          <div class="title-col"></div>\n          <div class="detail-col">\n            <button ng-click="tdst.changeTeamPictureOrEditDialog()" ng-disabled="tdst.team.isArchived" class="button-command focus-round-border change-picture-button" track-scenario="{{::$root.trackConstants.trackScenario.changeSetting}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.admin}}" track-name="{{::$root.trackConstants.trackModuleName.changeTeamPicture}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="Settings tab">\n                    <ng-include src="\'svg/icons-files-upload.html\'"></ng-include>\n              <span class="button-command--text-with-icon" translate-once="{{::$root.resources.strings.team_dashboard_settings_change_picture}}"></span>\n            </button>\n          </div>\n        </div>\n      </div>\n      </div>\n      \x3c!-- Class Themes --\x3e\n      <div class="td-team-section first-section class-theme" ng-if="tdst.enablePersonalization">\n      <div class="flex-row">\n        <a tabindex="0" class="title-col pointer" aria-labelledby="teamthemetitle teamthemeAction" role="button" aria-expanded="{{!!showThemeSettings}}" ng-click="showThemeSettings = !showThemeSettings" data-tid="theme-settings">\n          <div class="ts-sym expand-collapse expand-collapse-button icons-gray-06-triangle-fill" tabindex="-1" aria-hidden="true">\n            <ng-include ng-show="showThemeSettings" src="\'svg/icons-triangle-down-small.html\'"></ng-include>\n            <ng-include ng-show="!showThemeSettings" src="\'svg/icons-triangle-right-small.html\'"></ng-include>\n          </div>\n          <div class="title" id="teamthemetitle" translate-once="{{::$root.resources.strings.team_dashboard_settings_class_theme}}" tabindex="-1" aria-hidden="true"></div>\n        </a>\n        <div class="detail-col">\n          <div class="caption gray-text desc" id="teamthemeAction" translate-once="{{::$root.resources.strings.team_dashboard_settings_class_theme_desc}}"></div>\n        </div>\n      </div>\n      <div ng-show="showThemeSettings">\n        <div class="flex-row">\n          <div class="title-col"></div>\n          <div class="detail-col">\n          <profile-picture css-class="image-mask" display-name="tdst.team.displayName" team-id="tdst.team.siteInfo.groupId" etag="tdst.team.pictureETag" source="td-settings-tab"></profile-picture>\n          </div>\n        </div>\n        <div class="flex-row">\n          <div class="title-col"></div>\n          <div class="detail-col">\n            <button ng-click="tdst.setPersonalizeTeamOrEditDialog()" class="button-command focus-round-border change-picture-button" data-tid="personalization-button">\n              <ng-include src="\'svg/icons-image.html\'"></ng-include>\n              <span class="button-command--text" translate-once="{{::$root.resources.strings.team_dashboard_settings_change_theme}}"></span>\n            </button>\n          </div>\n        </div>\n      </div>\n      </div>\n      <div ng-if="::tdst.team.objectId && !tdst.isChannelView">\n        <team-permission-section object-id="tdst.team.objectId"></team-permission-section>\n      </div>\n      <div ng-if="::tdst.channel.objectId && tdst.isChannelView">\n        <channel-permission-section object-id="tdst.channel.objectId"></channel-permission-section>\n      </div>\n\n      \x3c!-- groups renewal--\x3e\n      <div ng-if="::tdst.showGroupRenewel" class="td-team-section">\n        <div class="flex-row">\n          <a tabindex="0" class="title-col pointer" data-tid="team-renwal-container" aria-labelledby="team-renewal-title team-renewal-desc" role="button" aria-expanded="{{!!showTeamRenewalSettings}}" ng-click="showTeamRenewalSettings = !showTeamRenewalSettings">\n            <div class="ts-sym expand-collapse expand-collapse-button icons-gray-06-triangle-fill triangle-container" tabindex="-1" aria-hidden="true">\n              <ng-include ng-show="showTeamRenewalSettings" src="\'svg/icons-triangle-down-small.html\'"></ng-include>\n              <ng-include ng-show="!showTeamRenewalSettings" src="\'svg/icons-triangle-right-small.html\'"></ng-include>\n            </div>\n            <div class="title" id="team-renewal-title" translate-once="{{::$root.resources.strings.team_dashboard_team_renewal_title}}" tabindex="-1" aria-hidden="true"></div>\n          </a>\n          <div class="caption desc gray-text" id="team-renewal-desc" translate-once="{{::$root.resources.strings.team_dashboard_permissions_desc_team_renewal}}"></div>\n        </div>\n        <div class="flex-row" ng-show="showTeamRenewalSettings">\n          <div class="title-col"></div>\n          <div class="detail-col team-renewal-detail-col">\n            <div ng-if="tdst.isTeamEligibleForRenewal" class="caption desc gray-text team-renew-msg" id="team-renewal-desc" translate="{{::$root.resources.strings.team_renewal_team_settings}}" translate-values="{expirationDate: tdst.teamExpiryDate}"></div>\n            <div ng-if="!tdst.isTeamEligibleForRenewal" class="caption desc gray-text team-renew-msg" id="team-renewal-desc" translate="{{::$root.resources.strings.team_settings_renew_success}}" translate-values="{expiryDate: tdst.teamExpiryDate}"></div>\n            <button class="ts-btn ts-btn-fluent ts-btn-fluent-primary" id="team-renew-btn" ng-if="tdst.isTeamEligibleForRenewal" translate-once="{{::$root.resources.strings.team_renewal_btn_text}}" aria-label="{{::$root.resources.strings.team_renewal_btn_text|translate}}" data-tid="ts-team-renewal-btn" ng-disabled="!tdst.renewTeamEnabled" ng-click="tdst.renewTeam();" track-name="{{::$root.trackConstants.trackModuleName.teamExpirySetting}}" track-type="{{::$root.trackConstants.trackType.teamSettingsAccordian}}" aria-labelledby="{{::$root.resources.strings.team_renewal_btn_text|translate}}"></button>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n<hybrid-content-viewport ng-if="tdst.showNorthstarTeamSettings" class="ts-middle-pane flex-fill ng-scope"/>\n'},308:function(e,t){e.exports='<div class="team-permission-section" ng-class="{\'archived\': tsp.isSourceArchived}" data-tid="team-permissions">\n\n  <div ng-if="tsp.enableDiscoverySettings && !tsp.showGeneralChannelOnly">\n    <div class="td-team-section">\n      <div class="flex-row">\n        <a tabindex="0" data-tid="discovery_permission_cont" class="title-col pointer" aria-labelledby="disc_ctrl_title disc_ctrl_action" role="button" aria-expanded="{{!!showDiscoverySettings}}" ng-click="showDiscoverySettings = !showDiscoverySettings">\n          <div class="ts-sym expand-collapse expand-collapse-button icons-gray-06-triangle-fill triangle-container" tabindex="-1" aria-hidden="true">\n            <ng-include ng-show="showDiscoverySettings" src="\'svg/icons-triangle-down-small.html\'"></ng-include>\n            <ng-include ng-show="!showDiscoverySettings" src="\'svg/icons-triangle-right-small.html\'"></ng-include>\n          </div>\n          <div class="title" id="disc_ctrl_title" ng-bind="::tsp.discoveryTitle" tabindex="-1" aria-hidden="true"></div>\n        </a>\n        <div class="detail-col">\n          <div class="caption desc gray-text" id="disc_ctrl_action" ng-bind="::tsp.discoveryTitle_desc"></div>\n        </div>\n      </div>\n      <div class="flex-row" ng-show="showDiscoverySettings">\n        <div class="title-col"></div>\n        <div class="detail-col">\n          <div>\n            <div class="discovery-settings-error-message" ng-if="!tsp.discoverySettingsLoaded || tsp.discoverySettingsError">\n                <span ng-if="tsp.discoverySettingsLoaded === false" translate-once="{{::$root.resources.strings.team_dashboard_discovery_actions_error_load}}"></span>\n                <span ng-if="tsp.discoverySettingsError === true" translate-once="{{::$root.resources.strings.team_dashboard_discovery_actions_error_update}}"></span>\n            </div>\n            <ul ng-show="tsp.discoverySettingsLoaded === true" class="td-ts-per-ss" acc-role="list" role="list">\n              \x3c!-- Enable team discovery --\x3e\n              <li class="td-ts-per-item" id="li-discovery_team" data-tid="discovery_team" ng-focus="tsp.narrateSettingsLabel($event,\'\',tsp.isTeamDiscoveryEnabled)" role="listitem" acc-role="list-item checkbox">\n                <teams-checkbox input-id="discovery_team" ng-model="tsp.isTeamDiscoveryEnabled" on-click="tsp.handleUpdateChannelSettingsClick($event,$root.resources.strings.team_dashboard_discovery_actions_teams,tsp.isTeamDiscoveryEnabled,tsp.constants.teams.settings.isTeamDiscoveryEnabled)" prefix-data-tid="discovery_team" is-disabled="tsp.isSourceArchived" label-text="{{::$root.resources.strings.team_dashboard_discovery_actions_teams|translate}}" narrator-text="{{::$root.resources.strings.team_dashboard_discovery_actions_teams|translate}}" swap-order="true">\n                </teams-checkbox>\n              </li>\n            </ul>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <div class="td-ts-per-sec" ng-if="!tsp.showGeneralChannelOnly">\n    \x3c!-- Member permissions --\x3e\n    <div class="td-team-section">\n      <div class="flex-row">\n        <a tabindex="0" class="title-col pointer" data-tid="member_permission_cont" aria-labelledby="membertitle membertitledesc" role="button" aria-expanded="{{!!showPermissionSettings}}" ng-click="showPermissionSettings = !showPermissionSettings">\n          <div class="ts-sym expand-collapse expand-collapse-button icons-gray-06-triangle-fill triangle-container" tabindex="-1" aria-hidden="true">\n            <ng-include ng-show="showPermissionSettings" src="\'svg/icons-triangle-down-small.html\'"></ng-include>\n            <ng-include ng-show="!showPermissionSettings" src="\'svg/icons-triangle-right-small.html\'"></ng-include>\n          </div>\n          <div class="title" id="membertitle" ng-bind="::tsp.memberTitle" tabindex="-1" aria-hidden="true"></div>\n        </a>\n        <div class="caption desc gray-text" id="membertitledesc" ng-bind="::tsp.memberTitle_desc"></div>\n      </div>\n      \x3c!--TODO(KuGarg): Enabled after channel permissions are supported--\x3e\n      \x3c!--<div>\n        <div class="td-ts-per-ss-list">\n          <div class="td-ts-ss-list-title" translate-once="{{::$root.resources.strings.team_dashboard_user_actions_title}}"></div>\n          <ul class="td-ts-per-ss" aria-labelledby="membertitle usertitle" acc-role="list">\n            <li class="td-ts-per-item" acc-role="list-item checkbox">\n              <div class="setting-item">\n                <input type="checkbox" id="add_other_member">\n                <label class="setting-item-label" for="add_other_member">\n                  <span class="setting-text" translate-once="{{::$root.resources.strings.team_dashboard_add_other_member_permission}}"></span>\n                  <ng-include class="icons-checkbox-unselected icon" src="\'svg/icons-checkbox-unselected.html\'"></ng-include>\n                  <ng-include class="icons-checkbox-selected icon" src="\'svg/icons-checkbox-selected.html\'"></ng-include>\n                </label>\n              </div>\n            </li>\n            <li class="td-ts-per-item" acc-role="list-item checkbox">\n              <div class="setting-item">\n                <input type="checkbox" id="remove_other_member">\n                <label class="setting-item-label" for="remove_other_member">\n                  <span class="setting-text" translate-once="{{::$root.resources.strings.team_dashboard_remove_other_member_permission}}"></span>\n                  <ng-include class="icons-checkbox-unselected icon" src="\'svg/icons-checkbox-unselected.html\'"></ng-include>\n                  <ng-include class="icons-checkbox-selected icon" src="\'svg/icons-checkbox-selected.html\'"></ng-include>\n                </label>\n              </div>\n            </li>\n          </ul>\n        </div>\n      </div>--\x3e\n      <div class="flex-row" ng-show="showPermissionSettings">\n        <div class="title-col"></div>\n        <div class="detail-col">\n          \x3c!-- Channel Actions --\x3e\n          <ul class="td-ts-per-ss" acc-role="list" role="list">\n            \x3c!-- Member Permission Settings --\x3e\n            <li ng-repeat="memberPermission in tsp.memberPermissionsSettings track by $index" class="td-ts-per-item" id="li-{{::memberPermission.inputId}}" acc-role="list-item checkbox" role="listitem" handle-kb-item-on-disable="true" ng-focus="tsp.narrateSettingsLabel($event,\'\',tsp.userSettings[memberPermission.settingName])">\n              <teams-checkbox input-id="{{::memberPermission.inputId}}" prefix-data-tid="{{::memberPermission.labelId}}" ng-model="tsp.userSettings[memberPermission.settingName]" on-click="tsp.handleUpdateChannelSettingsClick($event,memberPermission.labelText,tsp.userSettings[memberPermission.settingName],memberPermission.settingName, tsp.userSettings, memberPermission.inputId)" is-disabled="tsp.propertiesUpdatePromises[memberPermission.settingName] || tsp.isSourceArchived || memberPermission.isDisabledbyParent" label-text="{{::memberPermission.labelText|translate}}" narrator-text="{{::memberPermission.labelText|translate}}" swap-order="true">\n              </teams-checkbox>\n              <span class="disabled" ng-if="memberPermission.isDisabledbyParent">{{::tsp.getDisabledSettingText(memberPermission.settingName, false)}}</span>\n            </li>\n          </ul>\n      </div>\n    </div>\n    </div>\n\n    <div class="td-team-section" ng-if="tsp.isGuestAccessEnabled">\n      <div class="flex-row">\n        <a tabindex="0" class="title-col pointer" data-tid="guest_permission_cont" aria-labelledby="guesttitle guesttitledesc" role="button" aria-expanded="{{!!showGuestPermissionSettings}}" ng-click="showGuestPermissionSettings = !showGuestPermissionSettings">\n          <div class="ts-sym expand-collapse expand-collapse-button icons-gray-06-triangle-fill triangle-container" tabindex="-1" aria-hidden="true">\n            <ng-include ng-show="showGuestPermissionSettings" src="\'svg/icons-triangle-down-small.html\'"></ng-include>\n            <ng-include ng-show="!showGuestPermissionSettings" src="\'svg/icons-triangle-right-small.html\'"></ng-include>\n          </div>\n          <div class="title" id="guesttitle" ng-bind="::tsp.guestTitle" tabindex="-1" aria-hidden="true"></div>\n        </a>\n        <div class="caption desc gray-text" id="guesttitledesc" ng-bind="::tsp.guestTitle_desc"></div>\n      </div>\n      <div class="flex-row" ng-show="showGuestPermissionSettings">\n        <div class="title-col"></div>\n        <div class="detail-col">\n          \x3c!-- Channel Actions --\x3e\n          <ul class="td-ts-per-ss" acc-role="list" role="list">\n            \x3c!-- Guest Permission Settings --\x3e\n            <li ng-repeat="guestPermission in tsp.guestPermissionSettings track by $index" class="td-ts-per-item" id="li-{{::guestPermission.inputId}}" ng-focus="tsp.narrateSettingsLabel($event,\'\',tsp.guestSettings[guestPermission.settingName])" role="listitem" acc-role="list-item checkbox">\n              <teams-checkbox input-id="{{::guestPermission.inputId}}" ng-model="tsp.guestSettings[guestPermission.settingName]" on-click="tsp.handleUpdateChannelSettingsClick($event,guestPermission.labelText,tsp.guestSettings[guestPermission.settingName],guestPermission.settingName,tsp.guestSettings, guestPermission.inputId)" prefix-data-tid="{{::guestPermission.inputId}}" is-disabled="tsp.propertiesUpdatePromises[guestPermission.settingName] || tsp.isSourceArchived || guestPermission.isDisabledbyParent" label-text="{{::guestPermission.labelText|translate}}" narrator-text="{{::guestPermission.labelText|translate}}" swap-order="true">\n              </teams-checkbox>\n              <span class="disabled" ng-if="guestPermission.isDisabledbyParent">{{::tsp.getDisabledSettingText(guestPermission.settingName, true)}}</span>\n            </li>\n          </ul>\n        </div>\n      </div>\n    </div>\n\n    \x3c!-- Feature Settings --\x3e\n    <div class="td-team-section">\n      <div class="flex-row">\n        <a tabindex="0" class="title-col pointer" aria-labelledby="featuretitle featuretitledesc" role="button" aria-expanded="{{!!showFeatureSettings}}" ng-click="showFeatureSettings = !showFeatureSettings">\n          <div class="ts-sym expand-collapse expand-collapse-button icons-gray-06-triangle-fill triangle-container" tabindex="-1" aria-hidden="true">\n            <ng-include ng-show="showFeatureSettings" src="\'svg/icons-triangle-down-small.html\'"></ng-include>\n            <ng-include ng-show="!showFeatureSettings" src="\'svg/icons-triangle-right-small.html\'"></ng-include>\n          </div>\n          <div class="title" id="featuretitle" ng-bind="::tsp.featureTitle" tabindex="-1" aria-hidden="true"></div>\n        </a>\n        <div class="detail-col">\n          <div class="caption desc gray-text" id="featuretitledesc" ng-bind="::tsp.featureTitle_desc"></div>\n        </div>\n      </div>\n    <div class="flex-row warning-message-row" ng-show="showFeatureSettings && tsp.disableMentionSettings">\n      <div class="title-col"></div>\n      <div class="detail-col warning-message">\n        <span class="ts-sym icons-giphy-info ng-scope"><ng-include src="\'svg/icons-info.html\'"></ng-include></span>\n        <span class="warning-message-text" ng-bind="::tsp.atMentionWarningMessage"></span>\n      </div>\n    </div>\n    <div class="flex-row" ng-show="showFeatureSettings">\n      <div class="title-col"></div>\n      <div class="detail-col">\n        <ul class="td-ts-per-ss" acc-role="list" role="list">\n          \x3c!-- Feature Settings --\x3e\n          <li ng-repeat="featureSetting in tsp.featureSettings track by $index" class="td-ts-per-item" id="li-{{::featureSetting.inputId}}" ng-focus="tsp.narrateSettingsLabel($event,\'\',tsp.userSettings[featureSetting.settingName])" acc-role="list-item checkbox" role="listitem" ng-disabled="tsp.isSourceArchived || tsp.disableMentionSettings">\n            <teams-checkbox input-id="{{::featureSetting.inputId}}" ng-model="tsp.userSettings[featureSetting.settingName]" on-click="tsp.handleUpdateChannelSettingsClick($event,featureSetting.labelText,tsp.userSettings[featureSetting.settingName],featureSetting.settingName)" prefix-data-tid="{{::featureSetting.inputId}}" is-disabled="tsp.propertiesUpdatePromises[featureSetting.settingName] || tsp.isSourceArchived ||  tsp.disableMentionSettings" label-text="{{::featureSetting.labelText|translate}}" narrator-text="{{::featureSetting.labelText|translate}}" swap-order="true">\n            </teams-checkbox>\n            </li>\n          </ul>\n        </div>\n      </div>\n    </div>\n  </div>\n\n    \x3c!-- Team Code Settings --\x3e\n    <div class="td-team-section team-code-section" ng-if="tsp.isTeamCodeShown">\n      <div class="flex-row">\n        <a tabindex="0" class="title-col pointer" aria-labelledby="team_code_section_title team_code_section_description" role="button" aria-expanded="{{!!showTeamCodeSettings}}" ng-click="showTeamCodeSettings = !showTeamCodeSettings" data-tid="team-join-code-container">\n          <div class="ts-sym expand-collapse expand-collapse-button icons-gray-06-triangle-fill triangle-container" tabindex="-1" aria-hidden="true">\n            <ng-include ng-show="showTeamCodeSettings" src="\'svg/icons-triangle-down-small.html\'"></ng-include>\n            <ng-include ng-show="!showTeamCodeSettings" src="\'svg/icons-triangle-right-small.html\'"></ng-include>\n          </div>\n          <div class="title" id="team_code_section_title" ng-bind="::tsp.teamcodeTitle" tabindex="-1" aria-hidden="true"></div>\n        </a>\n        <div class="caption desc gray-text" id="team_code_section_description" ng-bind="::tsp.teamcodeTitle_desc"></div>\n      </div>\n      <div class="flex-row" ng-show="showTeamCodeSettings">\n        <div class="title-col"></div>\n        <div class="detail-col">\n          <div class="setting-item team-code-settings">\n            <div class="team-code-view-and-get-block">\n              <span id="{{::tsp.teamCodeSpanId}}" ng-show="tsp.teamCodeLoaded && tsp.teamCode" class="team-code-value" tabindex="0">{{tsp.teamCode}}</span>\n              <div ng-show="tsp.teamCodeLoaded === false" class="team-code-error-message">\n                <span id="team-code-load-error" translate-once="{{::$root.resources.strings.failed_to_load_team_code}}"></span>\n                <button type="button" class="ts-sym try-again-button" ng-click="tsp.loadTeamCode()" track-outcome="{{::$root.trackConstants.trackOutcome.submit}}" track-scenario="{{::$root.trackConstants.trackScenario.loadTeamCode}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.manageTeamCode}}" track-name="{{::$root.trackConstants.trackModuleName.teamCode}}" track-type="{{::$root.trackConstants.trackType.button}}" track-summary="Load Team Code" aria-labelledby="team-code-load-error team-code-load-again-text">\n                  <span id="team-code-load-again-text" translate-once="{{::$root.resources.strings.load_again_team_code_button_text}}"></span>\n                </button>\n              </div>\n              <button id="{{::tsp.teamCodeGenerateButtonId}}" ng-show="(tsp.teamCodeLoaded && !tsp.teamCode) || !tsp.isTeamCodeEnabled" ng-disabled="!tsp.isTeamCodeEnabled" type="button" class="ts-btn ts-btn-fluent ts-btn-fluent-primary get-team-code" ng-click="tsp.generateTeamCode($event)" track-outcome="{{::$root.trackConstants.trackOutcome.submit}}" track-scenario="{{::$root.trackConstants.trackScenario.generateTeamCode}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.manageTeamCode}}" track-name="{{::$root.trackConstants.trackModuleName.teamCode}}" track-type="{{::$root.trackConstants.trackType.button}}" track-summary="Generate Team Code" title="{{::$root.resources.strings.generate_team_code_button_aria_label | translate}}" aria-label="{{::$root.resources.strings.generate_team_code_button_aria_label | translate}}">\n                <span translate-once="{{::$root.resources.strings.generate_team_code_button_text}}"></span>\n              </button>\n            </div>\n            <div ng-show="tsp.teamCodeLoaded && tsp.teamCode" class="team-code-control-block">\n              <button ng-repeat="button in tsp.teamCodeControlButtons" class="ts-btn app-icons-fill-hover app-icons-fill-focus" ng-class="button.classes" ng-click="button.onClick($event)" track-outcome="{{::button.trackOutcome}}" track-scenario="{{::button.trackScenario}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.manageTeamCode}}" track-name="{{::$root.trackConstants.trackModuleName.teamCode}}" track-type="{{::$root.trackConstants.trackType.button}}" track-summary="{{::button.trackSummary}}" ng-attr-id="{{button.id}}" data-tid="{{::button.dataTid}}">\n                <ng-include class="icon" src="button.svgSrc"></ng-include>\n                <span ng-bind="button.text"></span>\n              </button>\n              <script type="text/ng-template" id="message-team-code-copied">\n                    <div class="popover message-action-tooltip" id="messageTeamCodeCopied">\n                        <ng-include src="\'svg/icons-copy.html\'"></ng-include>\n                        <div class="tooltip-inner" translate-once={{::$root.resources.strings.team_code_copied_popup_message}}></div>\n                        <div class="tooltip-arrow"></div>\n                    </div>\n                  <\/script>\n            </div>\n            <div ng-show="tsp.teamCodeError" class="team-code-error-message" ng-bind="tsp.teamCodeError"></div>\n            <div class="caption desc gray-text" id="team_code_section_description" ng-bind="::tsp.teamcodeNotice"></div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    \x3c!-- Guardian Notification Settings --\x3e\n    <div ng-if="tsp.displayGuardianNotificationSettings">\n      <div class="td-team-section">\n        <div class="flex-row">\n          <a tabindex="0" class="title-col pointer" data-tid="guardian_notification_menu" aria-labelledby="guardiannotificationtitle guardiannotificationtitledesc" role="button" aria-expanded="{{!!showGuardianNotificationSettings}}" ng-click="showGuardianNotificationSettings = !showGuardianNotificationSettings">\n            <div class="ts-sym expand-collapse expand-collapse-button icons-gray-06-triangle-fill triangle-container" tabindex="-1" aria-hidden="true">\n              <ng-include ng-show="showGuardianNotificationSettings" src="\'svg/icons-triangle-down-small.html\'"></ng-include>\n              <ng-include ng-show="!showGuardianNotificationSettings" src="\'svg/icons-triangle-right-small.html\'"></ng-include>\n            </div>\n            <div class="title" id="guardiannotificationtitle" ng-bind="::tsp.guardiannotificationTitle" tabindex="-1" aria-hidden="true"></div>\n          </a>\n          <div class="detail-col">\n            <div class="caption desc gray-text" id="guardiannotificationtitledesc" ng-bind="::tsp.guardiannotificationTitle_desc"></div>\n          </div>\n        </div>\n        <div class="flex-row" ng-show="showGuardianNotificationSettings" data-tid="guardian_send_notification_checkbox">\n          <div class="title-col"></div>\n          <div class="detail-col">\n            <ul class="td-ts-per-ss" acc-role="listgrid-vertical">\n              <li ng-repeat="guardianNotificationButton in tsp.guardianNotificationSettings track by $index" class="td-ts-per-item" id="li-{{::guardianNotificationButton.inputId}}" role="listitem" acc-role="listgrid-item checkbox" ng-focus="tsp.narrateSettingsLabel($event,\'\',tsp.classSettings[guardianNotificationButton.settingName])" ng-disabled="tsp.isSourceArchived">\n                <teams-checkbox input-id="{{::guardianNotificationButton.inputId}}" prefix-data-tid="{{::guardianNotificationButton.labelId}}" ng-model="tsp.classSettings[guardianNotificationButton.settingName]" on-click="tsp.handleUpdateChannelSettingsClick($event,guardianNotificationButton.labelText,tsp.classSettings[guardianNotificationButton.settingName],guardianNotificationButton.settingName, tsp.classSettings)" is-disabled="tsp.propertiesUpdatePromises[guardianNotificationButton.settingName] || tsp.isSourceArchived" label-text="{{::guardianNotificationButton.labelText|translate}}" narrator-text="{{::guardianNotificationButton.labelText|translate}}" swap-order="true">\n                </teams-checkbox>\n              </li>\n            </ul>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    \x3c!-- Giphy, Stickers, and Memes --\x3e\n    <div ng-if="tsp.enableFunControlSetting">\n      <div class="td-team-section">\n        <div class="flex-row">\n          <a tabindex="0" data-tid="fun_stuff_permission_cont" class="title-col pointer" aria-labelledby="functrltitle functrlaction" role="button" aria-expanded="{{!!showGifSettings}}" ng-click="showGifSettings = !showGifSettings">\n            <div class="ts-sym expand-collapse expand-collapse-button icons-gray-06-triangle-fill triangle-container" tabindex="-1" aria-hidden="true">\n              <ng-include ng-show="showGifSettings" src="\'svg/icons-triangle-down-small.html\'"></ng-include>\n              <ng-include ng-show="!showGifSettings" src="\'svg/icons-triangle-right-small.html\'"></ng-include>\n            </div>\n            <div class="title" id="functrltitle" ng-bind="::tsp.funTitle" tabindex="-1" aria-hidden="true"></div>\n          </a>\n          <div class="detail-col">\n            <div class="caption desc gray-text" id="functrlaction" ng-bind="::tsp.funTitle_desc"></div>\n          </div>\n        </div>\n        <div class="flex-row" ng-show="showGifSettings">\n          <div class="title-col"></div>\n          <div class="detail-col">\n            <div ng-show="tsp.tenantSettings.funControl.isGiphyEnabled">\n              <div class="settings-option-header app-font-weight-semibold" id="giphytitle" ng-bind="::tsp.giphyTitle_action"></div>\n              <ul acc-role="list" role="list">\n                \x3c!-- Enable Giphy for This Team --\x3e\n                <li class="td-ts-per-item" acc-role="list-item checkbox" id="li-funcontrol_giphy_team" data-tid="funcontrol_giphy_team" ng-focus="tsp.narrateSettingsLabel($event,tsp.giphyTitle_action_permission,tsp.userSettings.giphyEnabled)">\n                  <label class="app-checkbox--label order-label-first" acc-role="clickable" aria-labelledby="giphytitleaction">\n                    <input class="app-checkbox--input" type="checkbox" id="funcontrol_giphy_team" ng-change="tsp.handleUpdateChannelSettingsClick($event,tsp.giphyTitle_action_permission,tsp.userSettings.giphyEnabled,tsp.constants.teams.settings.giphyEnabled)" space-action ng-model="tsp.userSettings.giphyEnabled" ng-checked="tsp.userSettings.giphyEnabled" ng-disabled="tsp.propertiesUpdatePromises[tsp.constants.teams.settings.giphyEnabled] || tsp.isSourceArchived" data-tid="funcontrol_giphy_team"/>\n                    <ng-include class="icons-checkbox-common icons-checkbox--unselected" aria-hidden="true" src="\'svg/icons-checkbox-unselected.html\'"></ng-include>\n                    <ng-include class="icons-checkbox-common icons-checkbox--selected" aria-hidden="true" src="\'svg/icons-checkbox-selected.html\'"></ng-include>\n                    <span class="app-checkbox--labelText restrict-flex-item-width" id="giphytitleaction" ng-bind="::tsp.giphyTitle_action_permission"></span>\n                    <a ng-if="!(tsp.tenantSettings.funControl.isGiphyEnabled || tsp.tenantSettings.funControl.isStickersEnabled || tsp.tenantSettings.funControl.isCustomMemesEnabled)" class="ts-sym icons-giphy-info app-icons-hover-giphy ng-scope" ng-mouseover="showDisabledInfoPopover=true;" ng-mouseleave="showDisabledInfoPopover=false;">\n                      <ng-include src="\'svg/icons-info.html\'"></ng-include>\n                      <div ng-if="showDisabledInfoPopover">\n                        <ng-include class="info-popover-beak black-beak" src="\'svg/beak-app-black.html\'"></ng-include>\n                        <ng-include class="info-popover-beak white-beak" src="\'svg/beak-app-white.html\'"></ng-include>\n                        <div class="info-popover" ng-if="showDisabledInfoPopover">\n                          <div class="info-header" ng-bind="::tsp.funTitle_disabled_info"></div>\n                        </div>\n                      </div>\n                    </a>\n                  </label>\n                  </li>\n              </ul>\n              <ul acc-role="list" role="list" ng-if="tsp.userSettings.giphyEnabled">\n                \x3c!-- Set the Content Rating for Giphy --\x3e\n                <li class="ts-funcontrol-item-combo">\n                  <div class="td-ts-per-item">\n                    <div class="td-ts-per-item-title">\n                      <span id="giphy-rating-title" ng-bind="::tsp.giphyTitle_rating"></span>\n                    </div>\n                    <div class="td-ts-per-item-title dd-wrapper">\n                      <dropdown-select ds-options="tsp.giphyTypes" ds-text-field="text" ds-value-field="value" ds-selected-value="tsp.userSettings.giphyRating" ds-on-change="tsp.updateGiphyRating()" ds-disabled="tsp.isSourceArchived" ds-labelledby-id="giphy-rating-title">\n                      </dropdown-select>\n                      <a tabindex="0" class="ts-sym icons-giphy-info app-icons-hover-giphy ng-scope" ng-focus="showInfoPopover=true;" ng-blur="showInfoPopover=false;" ng-mouseover="showInfoPopover=true;" ng-mouseleave="showInfoPopover=false;">\n                        <ng-include src="\'svg/icons-info.html\'"></ng-include>\n                        <div ng-if="showInfoPopover">\n                          <ng-include class="info-popover-beak black-beak" src="\'svg/beak-app-black.html\'"></ng-include>\n                          <ng-include class="info-popover-beak white-beak" src="\'svg/beak-app-white.html\'"></ng-include>\n                          <div class="info-popover" ng-if="showInfoPopover">\n                            <span>{{tsp.selectedGiphyInfo}}</span>\n                          </div>\n                        </div>\n                      </a>\n                    </div>\n                  </div>\n                </li>\n              </ul>\n            </div>\n\n            \x3c!-- Stickers(including static Memes)--\x3e\n            <div class="td-ts-per-ss-list" ng-show="tsp.tenantSettings.funControl.isStickersEnabled">\n              <div class="settings-option-header app-font-weight-semibold" id="stickermemetitle" ng-bind="::tsp.stickerTitle_action"></div>\n              <ul class="td-ts-per-subsec" acc-role="list" role="list">\n                \x3c!-- Enable Stickers and Memes --\x3e\n                <li class="td-ts-per-item" id="li-funcontrol_stickers_team" data-tid="funcontrol_stickers_team" acc-role="list-item checkbox" role="listitem" ng-focus="tsp.narrateSettingsLabel($event,\'\',tsp.userSettings.stickersEnabled)">\n                  <teams-checkbox input-id="funcontrol_stickers_team" ng-model="tsp.userSettings.stickersEnabled" on-click="tsp.handleUpdateChannelSettingsClick($event,tsp.stickerTitle_action_permission,tsp.userSettings.stickersEnabled,tsp.constants.teams.settings.stickersEnabled)" prefix-data-tid="funcontrol_stickers_team" is-disabled="tsp.propertiesUpdatePromises[tsp.constants.teams.settings.stickersEnabled] || tsp.isSourceArchived" label-text="{{::tsp.stickerTitle_action_permission}}" narrator-text="{{::tsp.stickerTitle_action_permission}}" swap-order="true">\n                  </teams-checkbox>\n                </li>\n              </ul>\n            </div>\n\n            \x3c!-- Memes Custom --\x3e\n            <div class="td-ts-per-ss-list" ng-if="tsp.userSettings.stickersEnabled && tsp.tenantSettings.funControl.isCustomMemesEnabled">\n              <div class="settings-option-header app-font-weight-semibold" id="memetitle" ng-bind="::tsp.memeTitle_action"></div>\n              <ul acc-role="list" role="list">\n                \x3c!-- Allow Memes to Be Uploaded --\x3e\n                <li class="td-ts-per-item" acc-role="list-item checkbox" id="li-funcontrol_memes_team" role="listitem" ng-focus="tsp.narrateSettingsLabel($event,\'\',tsp.userSettings.customMemesEnabled)">\n                  <teams-checkbox input-id="funcontrol_memes_team" ng-model="tsp.userSettings.customMemesEnabled" on-click="tsp.handleUpdateChannelSettingsClick($event,tsp.memeTitle_action_permission,tsp.userSettings.customMemesEnabled,tsp.constants.teams.settings.customMemesEnabled)" prefix-data-tid="funcontrol_memes_team" is-disabled="tsp.propertiesUpdatePromises[tsp.constants.teams.settings.customMemesEnabled] || tsp.isSourceArchived" label-text="{{::tsp.memeTitle_action_permission}}" narrator-text="{{::tsp.memeTitle_action_permission}}" swap-order="true">\n                  </teams-checkbox>\n                </li>\n\n                \x3c!-- Allow Uploaded Memes to Be Saved to List --\x3e\n                <li class="td-ts-per-item" ng-if="tsp.enableAddToTeamMemeSettings" acc-role="list-item checkbox" id="li-funcontrol_memes_teammeme" role="listitem" ng-focus="tsp.narrateSettingsLabel($event,\'\',tsp.userSettings.teamMemesEnabled)">\n                  <teams-checkbox input-id="funcontrol_memes_teammeme" ng-model="tsp.userSettings.teamMemesEnabled" on-click="tsp.handleUpdateChannelSettingsClick($event,$root.resources.strings.team_dashboard_fun_control_memes_actions_teammeme_permission,tsp.userSettings.teamMemesEnabled,tsp.constants.teams.settings.teamMemesEnabled)" prefix-data-tid="funcontrol_memes_team" is-disabled="tsp.propertiesUpdatePromises[tsp.constants.teams.settings.teamMemesEnabled] || tsp.isSourceArchived" label-text="{{::$root.resources.strings.team_dashboard_fun_control_memes_actions_teammeme_permission|translate}}" narrator-text="{{::$root.resources.strings.team_dashboard_fun_control_memes_actions_teammeme_permission|translate}}" swap-order="true">\n                  </teams-checkbox>\n                </li>\n              </ul>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    \x3c!-- edu notebook settings - class & staff --\x3e\n    <div class="td-team-section" ng-if="tsp.showNotebookSettings">\n      <div class="flex-row">\n        <a tabindex="0" class="title-col pointer" aria-labelledby="membertitle" role="button" aria-expanded="{{!!showNotebookSettings}}" ng-click="showNotebookSettings = !showNotebookSettings">\n          <div class="ts-sym expand-collapse expand-collapse-button icons-gray-06-triangle-fill triangle-container" tabindex="-1" aria-hidden="true">\n            <ng-include ng-show="showNotebookSettings" src="\'svg/icons-triangle-down-small.html\'"></ng-include>\n            <ng-include ng-show="!showNotebookSettings" src="\'svg/icons-triangle-right-small.html\'"></ng-include>\n          </div>\n          <div class="title" id="membertitle" tabindex="-1" aria-hidden="true">{{tsp.notebookSettingsTitle}}</div>\n        </a>\n        <div class="detail-col">\n          <div class="caption gray-text desc" translate-once="{{::$root.resources.strings.team_dashboard_edu_notebook_desc}}"></div>\n        </div>\n      </div>\n      <div ng-if="tsp.team.teamStatus.teamClassNotebookCreationStatus != 1">\n        <div ng-show="showNotebookSettings" class="flex-row">\n          <div class="title-col"></div>\n          <div class="detail-col no-notebook" ng-bind-html="tsp.notebookNotSetupLabel"></div>\n        </div>\n      </div>\n      <div ng-if="tsp.team.teamStatus.teamClassNotebookCreationStatus == 1">\n        <div ng-show="showNotebookSettings && tsp.eduNotebookSettings" class="notebookSettings">\n          <div class="flex-row">\n            <div class="title-col"></div>\n            <div ng-show="tsp.showNotebookError" class="detail-col no-notebook">\n              <span class="caption error desc" translate-once="{{::$root.resources.strings.team_dashboard_edu_nb_updated_fetch_error}}"></span>\n            </div>\n            <div ng-show="!tsp.showNotebookError" class="detail-col class-nb-detail flex-container">\n              <div class="sections-list">\n                <div>{{tsp.notebookSectionsTitle}}</div>\n                <div ng-class="{\'disabled-sections\': tsp.savingSections}">\n                  <div ng-repeat="memberSection in tsp.eduNotebookSettings.memberSections track by $index" class="td-ts-per-item" acc-role="list-item">\n                    <div class="edit-section" ng-click="tsp.editSection($index)">\n                      <ng-include class="sectionIcon" src="\'svg/icons-onenote-section.html\'"></ng-include>\n                      <input ng-keyup="tsp.keyUpHandler($event, $index)" ng-disabled="tsp.savingSections" ng-class="{\'error-box\': tsp.sectionErrors[$index]}" class="editableText" type="text" value="{{memberSection}}" id="section_{{$index}}" maxlength="50"/>\n                      <ng-include src="\'svg/icons-edit.html\'"></ng-include>\n                    </div>\n                    <div class="owner-section-status error-section" ng-show="tsp.sectionErrors[$index]">\n                      <ng-include class="icon" src="\'svg/icons-error.html\'"></ng-include>\n                      <span class="caption error desc" ng-show="tsp.sectionErrors[$index]">{{tsp.sectionErrors[$index]}}</span>\n                    </div>\n                  </div>\n                  <button class="link plain-btn" ng-disabled="tsp.savingSections" ng-click="tsp.addSection()">\n                    <ng-include src="\'svg/icons-add.html\'"></ng-include>\n                    <span translate-once="{{::$root.resources.strings.team_dashboard_edu_nb_add_section}}"></span>\n                  </button>\n                </div>\n                <div class="buttons-wrapper">\n                  <button class="ts-btn ts-btn-secondary" ng-click="tsp.resetSections()" ng-disabled="!tsp.sectionsDirty">\n                    <span translate-once="{{::$root.resources.strings.team_dashboard_edu_nb_cancel_sections_button}}"></span>\n                  </button>\n                  <button class="ts-btn ts-btn-primary" ng-click="tsp.updateSections()" ng-disabled="!tsp.sectionsDirty || !tsp.noSectionNameErrors">\n                    <span translate-once="{{::$root.resources.strings.team_dashboard_edu_nb_save_sections_button}}"></span>\n                  </button>\n                </div>\n                <div class="spinner-wrapper" ng-if="tsp.savingSections">\n                  <busy-animation size="small"></busy-animation>\n                  <span translate-once="{{::$root.resources.strings.team_dashboard_edu_nb_saving_sections}}"></span>\n                </div>\n                <div ng-if="tsp.savedSections">\n                  <ng-include class="icons-input-valid" src="\'svg/icons-input-valid.html\'"></ng-include>\n                  <span translate-once="{{::$root.resources.strings.team_dashboard_edu_nb_saved_sections}}"></span>\n                </div>\n              </div>\n              <div class="nb-details">\n                <div>\n                  <button class="teacher-section ts-btn ts-btn-secondary" ng-click="tsp.addOwnerOnlySection()" ng-disabled="tsp.ownerSectionStatus == 1 || tsp.ownerSectionStatus == 2">{{tsp.createOwnerOnlyButtonTitle}}</button>\n                  <div ng-show="tsp.ownerSectionStatus == 0" class="caption gray-text desc" translate-once="{{::$root.resources.strings.team_dashboard_edu_nb_owner_section_desc}}"></div>\n                  <div class="owner-section-status spinner-wrapper" ng-show="tsp.ownerSectionStatus == 2">\n                    <busy-animation size="small"></busy-animation>\n                    <span class="caption gray-text desc" translate-once="{{::$root.resources.strings.team_dashboard_edu_nb_owner_section_enabling}}"></span>\n                  </div>\n                  <div class="owner-section-status" ng-show="tsp.ownerSectionStatus == 1">\n                    <ng-include class="icons icons-input-valid" src="\'svg/icons-input-valid.html\'"></ng-include>\n                    <div class="caption gray-text desc" translate-once="{{::$root.resources.strings.team_dashboard_edu_nb_owner_section_enabled}}"></div>\n                  </div>\n                  <div class="owner-section-status" ng-show="tsp.ownerSectionStatus == 3">\n                    <ng-include class="icon" src="\'svg/icons-error.html\'"></ng-include>\n                    <div class="caption error desc" translate-once="{{::$root.resources.strings.team_dashboard_edu_nb_update_error}}"></div>\n                  </div>\n                  \x3c!-- Lock Collaboration Space --\x3e\n                  <div class="collab-space">\n                    <div translate-once="{{::$root.resources.strings.team_dashboard_edu_nb_lock_collaboration_space}}" class="text-div"></div>\n                    <div translate-once="{{::$root.resources.strings.team_dashboard_edu_nb_lock_collaboration_space_desc}}" class="caption gray-text text-div"></div>\n                    <div class="collaboration-lock">\n                      <button class="plain-btn" ng-show="!tsp.eduNotebookSettings.isCollaborationSpaceLocked" ng-click="tsp.toggleCollaborationLock()">\n                        <ng-include src="\'svg/toggle-off.html\'"></ng-include>\n                        <span class="caption" translate-once="{{::$root.resources.strings.team_dashboard_edu_nb_lock_collaboration_space_unlocked}}"></span>\n                      </button>\n                      <button class="plain-btn" ng-show="tsp.eduNotebookSettings.isCollaborationSpaceLocked" ng-click="tsp.toggleCollaborationLock()">\n                        <ng-include src="\'svg/toggle-on.html\'"></ng-include>\n                        <span class="caption" translate-once="{{::$root.resources.strings.team_dashboard_edu_nb_lock_collaboration_space_locked}}"></span>\n                      </button>\n                    </div>\n                  </div>\n                  \x3c!-- Link --\x3e\n                  <div class="notebook-link">\n                    <div translate-once="{{::$root.resources.strings.team_dashboard_edu_nb_link}}" class="text-div"></div>\n                    <input class="editableText" id="nb-link" type="text" value="{{::tsp.eduNotebookSettings.links.oneNoteWebUrl.href}}"/>\n                    <button class="ts-btn ts-btn-primary" role="button" ng-click="tsp.copyLink()">\n                      <ng-include ng-show="tsp.copied" class="icon" src="\'svg/icons-check.html\'"></ng-include>\n                      <span ng-show="!tsp.copied" translate-once="{{::$root.resources.strings.team_dashboard_edu_nb_copy}}"></span>\n                    </button>\n                  </div>\n                  \x3c!-- Add-in Link --\x3e\n                  <div class="link" ng-if="::tsp.isWindowsOS">\n                    <a ng-href="{{tsp.constants.downloadNotebookAddInLink.eduNotebook}}" target="_blank" translate-once="{{::$root.resources.strings.team_dashboard_edu_nb_download_add_in}}"></a>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div class="td-team-section" ng-if="tsp.showNotebookSettingsMigrated">\n      <div class="flex-row">\n        <a tabindex="0" class="title-col pointer" aria-labelledby="membertitle" role="button" aria-expanded="{{!!showNotebookSettingsMigrated}}" ng-click="showNotebookSettingsMigrated = !showNotebookSettingsMigrated">\n          <div class="ts-sym expand-collapse expand-collapse-button icons-gray-06-triangle-fill triangle-container" tabindex="-1" aria-hidden="true">\n            <ng-include ng-show="showNotebookSettingsMigrated" src="\'svg/icons-triangle-down-small.html\'"></ng-include>\n            <ng-include ng-show="!showNotebookSettingsMigrated" src="\'svg/icons-triangle-right-small.html\'"></ng-include>\n          </div>\n          <div class="title" id="membertitle" ng-bind-html="tsp.notebookSettingsTitle" tabindex="-1" aria-hidden="true"></div>\n        </a>\n        <div class="detail-col">\n          <div class="caption gray-text desc" translate-once="{{::$root.resources.strings.team_dashboard_edu_notebook_desc}}"></div>\n        </div>\n      </div>\n      <div>\n        <div ng-show="showNotebookSettingsMigrated" class="flex-row">\n          <div class="title-col"></div>\n          <div class="detail-col no-notebook" ng-bind-html="tsp.notebookSettingsMigratedLabel"></div>\n        </div>\n      </div>\n    </div>\n\n    \x3c!-- Tags Settings --\x3e\n    <div ng-if="tsp.enableTeamMemberTags">\n      <div class="td-team-section">\n        <div class="flex-row">\n          <a tabindex="0" data-tid="tags_settings" class="title-col pointer" aria-labelledby="tagsSettingsTitle tagsSettingsAction" role="button" aria-expanded="{{!!showTagsSettings}}" ng-click="showTagsSettings = !showTagsSettings">\n            <div class="ts-sym expand-collapse expand-collapse-button icons-gray-06-triangle-fill triangle-container" tabindex="-1" aria-hidden="true">\n              <ng-include ng-show="showTagsSettings" src="\'svg/icons-triangle-down-small.html\'"></ng-include>\n              <ng-include ng-show="!showTagsSettings" src="\'svg/icons-triangle-right-small.html\'"></ng-include>\n            </div>\n            <div class="title" id="tagsSettingsTitle" translate-once="{{::$root.resources.strings.team_dashboard_tags_settings_title}}" tabindex="-1" aria-hidden="true"></div>\n          </a>\n          <div class="detail-col">\n            <div class="caption desc gray-text" id="tagsSettingsAction" translate-once="{{::$root.resources.strings.team_dashboard_tags_settings_only_tag_permissions_action}}"></div>\n          </div>\n        </div>\n        <div class="flex-row" ng-show="showTagsSettings">\n          <div class="title-col"></div>\n          <div class="spinner-wrapper" ng-if="tsp.teamTagSettingsLoadingStatus === tsp.teamTagSettingsStatus.Loading">\n            <busy-animation size="small"></busy-animation>\n          </div>\n          <div class="detail-col" ng-if="tsp.teamTagSettingsLoadingStatus !== tsp.teamTagSettingsStatus.Loading">\n            <ul acc-role="list" role="list" ng-if="tsp.teamTagSettingsLoadingStatus === tsp.teamTagSettingsStatus.Succeeded">\n              <li class="ts-tagssettings-item-combo">\n                <div class="td-ts-per-item">\n                  <div class="td-ts-per-item-title">\n                    <span id="tag-settings-control-label" translate-once="{{::$root.resources.strings.team_dashboard_tags_settings_manage_tags_control_title}}"></span>\n                  </div>\n                  <div class="td-ts-per-item-title dd-wrapper" ng-class="{\'sources-not-enabled\': !tsp.enableScheduledTags}">\n                    <dropdown-select data-tid="tag_settings_dropdown" ds-options="tsp.addTagsSettingOptions" ds-text-field="text" ds-value-field="value" ds-selected-value="tsp.addTagsSetting" ds-labelledby-id="tag-settings-control-label" ds-on-change="tsp.updateAddTagsSetting()" ds-disabled="tsp.isSourceArchived || !tsp.ownersCanOverwriteTagSettings">\n                    </dropdown-select>\n                  </div>\n                </div>\n              </li>\n              <li class="ts-tagssettings-item-combo" ng-if="tsp.enableScheduledTags && tsp.tagSources && tsp.tagSources.length" data-tid="tag-settings-sources">\n                <div class="td-ts-per-item">\n                  <div class="td-ts-per-item-title">\n                    <span id="tag-settings-sources-control-label" translate-once="{{::$root.resources.strings.team_dashboard_tags_settings_scheduled_tags_control_title}}"></span>\n                  </div>\n                  <div class="td-ts-per-item dd-wrapper">\n                    <div class="td-ts-per-item-title tags-settings-control-label-subtitle">\n                      <span id="tag-settings-sources-control-label-subtitle" translate-once="{{::$root.resources.strings.team_dashboard_tags_settings_scheduled_tags_apps_subtitle}}"></span>\n                    </div>\n                    <div class="tag-settings-sources">\n                      <div class="tag-settings-source" ng-repeat="tagSource in tsp.tagSources track by $index">\n                        <toggle-switch is-checked="tagSource.enabled" on-toggle="tsp.updateTagSettingsSource(tagSource, isChecked)" is-disabled="!tsp.ownersCanOverwriteTagSettings">\n                        </toggle-switch>\n                        <div class="td-ts-per-item-title">\n                          <span ng-bind="tagSource.name" class="tag-source-name"></span>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </li>\n            </ul>\n            <div ng-if="tsp.teamTagSettingsLoadingStatus === tsp.teamTagSettingsStatus.Failed" class="team-code-error-message">\n              <span id="team-tag-settings-load-error-failed" data-tid="team-tag-settings-load-error-failed" translate-once="{{::$root.resources.strings.failed_to_load_team_tag_settings}}"></span>\n              <button type="button" class="ts-sym try-again-button" ng-click="tsp.loadTagSettings()">\n                <span id="team-tag-settings-load-again-text" translate-once="{{::$root.resources.strings.load_again_team_tag_settings_button_text}}"></span>\n              </button>\n            </div>\n            <div ng-if="tsp.teamTagSettingsLoadingStatus === tsp.teamTagSettingsStatus.Disabled" class="team-code-error-message">\n              <span id="team-tag-settings-load-error-disabled" data-tid="team-tag-settings-load-error-disabled" translate-once="{{::$root.resources.strings.team_dashboard_tags_settings_disabled}}"></span>\n            </div>\n            <div ng-if="tsp.teamTagSettingsLoadingStatus === tsp.teamTagSettingsStatus.Succeeded && !tsp.ownersCanOverwriteTagSettings" class="team-code-error-message">\n              <span id="team-tag-settings-load-error-not-allowed" data-tid="team-tag-settings-load-error-not-allowed" translate-once="{{::$root.resources.strings.team_dashboard_tags_settings_change_who_can_manage_tags_disabled}}"></span>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  \n\n  \x3c!-- General channel for channel-setting tab  --\x3e\n  <div class="td-ts-per-sec" ng-if="tsp.showGeneralChannelOnly">\n      <ng-include src="\'components/team-dashboard/td-settings-tab/team-permission-section/general-channel-settings.html\'"></ng-include>\n  </div>\n\n  <div ng-if="tsp.errorMessage" class="td-td-update-error">\n    <div class="error-message">\n      * {{tsp.errorMessage}}\n    </div>\n  </div>\n\n'}},[2210]);