(this.webpackJsonp=this.webpackJsonp||[]).push([[104],{"5m6k":function(e,t,n){"use strict";function r(e){this.message=e}r.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},r.prototype.__CANCEL__=!0,e.exports=r},"5oVE":function(e,t,n){"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}}},"9a8n":function(e,t,n){"use strict";var r=n("Sq1a"),i=n("5oVE"),s=n("SKMx"),o=n("k/zH");function a(e){var t=new s(e),n=i(s.prototype.request,t);return r.extend(n,s.prototype,t),r.extend(n,t),n}var c=a(o);c.Axios=s,c.create=function(e){return a(r.merge(o,e))},c.Cancel=n("5m6k"),c.CancelToken=n("LmWC"),c.isCancel=n("jDms"),c.all=function(e){return Promise.all(e)},c.spread=n("DBsb"),e.exports=c,e.exports.default=c},DBsb:function(e,t,n){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},IStc:function(e,t,n){"use strict";var r=n("Sq1a"),i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,s,o={};return e?(r.forEach(e.split("\n"),(function(e){if(s=e.indexOf(":"),t=r.trim(e.substr(0,s)).toLowerCase(),n=r.trim(e.substr(s+1)),t){if(o[t]&&i.indexOf(t)>=0)return;o[t]="set-cookie"===t?(o[t]?o[t]:[]).concat([n]):o[t]?o[t]+", "+n:n}})),o):o}},Iu5f:function(e,t,n){"use strict";var r=n("Sq1a"),i=n("kH0B"),s=n("jDms"),o=n("k/zH"),a=n("J/dG"),c=n("a5HW");function u(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return u(e),e.baseURL&&!a(e.url)&&(e.url=c(e.baseURL,e.url)),e.headers=e.headers||{},e.data=i(e.data,e.headers,e.transformRequest),e.headers=r.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),r.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||o.adapter)(e).then((function(t){return u(e),t.data=i(t.data,t.headers,e.transformResponse),t}),(function(t){return s(t)||(u(e),t&&t.response&&(t.response.data=i(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},"J/dG":function(e,t,n){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},JgJM:function(e,t,n){"use strict";var r=n("Sq1a"),i=n("quZC"),s=n("to4N"),o=n("IStc"),a=n("TadW"),c=n("bmvL");e.exports=function(e){return new Promise((function(t,u){var l=e.data,d=e.headers;r.isFormData(l)&&delete d["Content-Type"];var h=new XMLHttpRequest;if(e.auth){var m=e.auth.username||"",p=e.auth.password||"";d.Authorization="Basic "+btoa(m+":"+p)}if(h.open(e.method.toUpperCase(),s(e.url,e.params,e.paramsSerializer),!0),h.timeout=e.timeout,h.onreadystatechange=function(){if(h&&4===h.readyState&&(0!==h.status||h.responseURL&&0===h.responseURL.indexOf("file:"))){var n="getAllResponseHeaders"in h?o(h.getAllResponseHeaders()):null,r={data:e.responseType&&"text"!==e.responseType?h.response:h.responseText,status:h.status,statusText:h.statusText,headers:n,config:e,request:h};i(t,u,r),h=null}},h.onerror=function(){u(c("Network Error",e,null,h)),h=null},h.ontimeout=function(){u(c("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED",h)),h=null},r.isStandardBrowserEnv()){var f=n("Vms8"),g=(e.withCredentials||a(e.url))&&e.xsrfCookieName?f.read(e.xsrfCookieName):void 0;g&&(d[e.xsrfHeaderName]=g)}if("setRequestHeader"in h&&r.forEach(d,(function(e,t){void 0===l&&"content-type"===t.toLowerCase()?delete d[t]:h.setRequestHeader(t,e)})),e.withCredentials&&(h.withCredentials=!0),e.responseType)try{h.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&h.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&h.upload&&h.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){h&&(h.abort(),u(e),h=null)})),void 0===l&&(l=null),h.send(l)}))}},LmWC:function(e,t,n){"use strict";var r=n("5m6k");function i(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var n=this;e((function(e){n.reason||(n.reason=new r(e),t(n.reason))}))}i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.source=function(){var e;return{token:new i((function(t){e=t})),cancel:e}},e.exports=i},NZ1D:function(e,t){e.exports=function(e){return null!=e&&null!=e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}},SKMx:function(e,t,n){"use strict";var r=n("k/zH"),i=n("Sq1a"),s=n("pDCA"),o=n("Iu5f");function a(e){this.defaults=e,this.interceptors={request:new s,response:new s}}a.prototype.request=function(e){"string"==typeof e&&(e=i.merge({url:arguments[0]},arguments[1])),(e=i.merge(r,{method:"get"},this.defaults,e)).method=e.method.toLowerCase();var t=[o,void 0],n=Promise.resolve(e);for(this.interceptors.request.forEach((function(e){t.unshift(e.fulfilled,e.rejected)})),this.interceptors.response.forEach((function(e){t.push(e.fulfilled,e.rejected)}));t.length;)n=n.then(t.shift(),t.shift());return n},i.forEach(["delete","get","head","options"],(function(e){a.prototype[e]=function(t,n){return this.request(i.merge(n||{},{method:e,url:t}))}})),i.forEach(["post","put","patch"],(function(e){a.prototype[e]=function(t,n,r){return this.request(i.merge(r||{},{method:e,url:t,data:n}))}})),e.exports=a},Sq1a:function(e,t,n){"use strict";var r=n("5oVE"),i=n("NZ1D"),s=Object.prototype.toString;function o(e){return"[object Array]"===s.call(e)}function a(e){return null!==e&&"object"==typeof e}function c(e){return"[object Function]"===s.call(e)}function u(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),o(e))for(var n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(null,e[i],i,e)}e.exports={isArray:o,isArrayBuffer:function(e){return"[object ArrayBuffer]"===s.call(e)},isBuffer:i,isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:a,isUndefined:function(e){return void 0===e},isDate:function(e){return"[object Date]"===s.call(e)},isFile:function(e){return"[object File]"===s.call(e)},isBlob:function(e){return"[object Blob]"===s.call(e)},isFunction:c,isStream:function(e){return a(e)&&c(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:u,merge:function e(){var t={};function n(n,r){"object"==typeof t[r]&&"object"==typeof n?t[r]=e(t[r],n):t[r]=n}for(var r=0,i=arguments.length;r<i;r++)u(arguments[r],n);return t},extend:function(e,t,n){return u(t,(function(t,i){e[i]=n&&"function"==typeof t?r(t,n):t})),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}}},TadW:function(e,t,n){"use strict";var r=n("Sq1a");e.exports=r.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function i(e){var r=e;return t&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=i(window.location.href),function(t){var n=r.isString(t)?i(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0}},TuwW:function(e,t,n){"use strict";var r=n("Sq1a");e.exports=function(e,t){r.forEach(e,(function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])}))}},UWA8:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionState=void 0,function(e){e[e.Disconnected=0]="Disconnected",e[e.Connected=1]="Connected",e[e.Connecting=2]="Connecting"}(t.ConnectionState||(t.ConnectionState={}))},Vms8:function(e,t,n){"use strict";var r=n("Sq1a");e.exports=r.isStandardBrowserEnv()?{write:function(e,t,n,i,s,o){var a=[];a.push(e+"="+encodeURIComponent(t)),r.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),r.isString(i)&&a.push("path="+i),r.isString(s)&&a.push("domain="+s),!0===o&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},YsOi:function(e,t,n){e.exports=n("9a8n")},a5HW:function(e,t,n){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},"aD+G":function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},s=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SimpleStateServiceProxy=void 0;var a=n("UWA8"),c=n("jxal"),u=n("jN5E"),l=o(n("YsOi")),d=n("ib3c"),h=n("j1Ck"),m=n("fniX"),p=n("yRmu"),f=[2e3,2e3,3e3,3e3,5e3],g="ConfigStateSubscriptions",v="config",S=function(){function e(e,t,n,r,i,s){var o=this;this.m_events=new c.EventEmitter,this.m_connectionState=a.ConnectionState.Disconnected,this.m_handlers=new Map,this.m_webSocket=null,this.m_clientIds=new Set,this.m_retryAttempts=0,this.m_maxSessionRetries=0,this.m_outboundMessageInfo=new Map,this.m_initPromise={promise:null,resolve:null,reject:null},this.m_messageBuffer=[],this.m_batchWaitTimeMS=20,this.m_batchMessageTypeName="list",this.m_closeWebSocketTimer=null,this.m_lastCloseCode=0,this.m_lastCloseReason="",this.m_clientId=i.customClientId||u.v4(),this.m_sessionId=e,this.m_logger=r,this.m_websocketAliveTimeAfterLoseFocusInMS=i.websocketAliveTimeAfterLoseFocusInMS,this.m_wsUrl=n+"?docId="+this.m_sessionId+"&clientId="+this.m_clientId+"&clientType="+t,i.correlationId&&(this.m_wsUrl+="&cid="+i.correlationId),i.isAutomation&&(this.m_wsUrl+="&automation=true"),i.autoRoutingEnabled&&(this.m_wsUrl+="&routing=true"),this.m_deltasBaseUrl=n.replace("wss://","https://").replace("ws://","http://"),this.m_clientsCell=new h.SimpleSyncCell("systemClients",this),this.m_handlers.set(this.m_clientsCell.id(),this.m_clientsCell),this.m_clientsCell.on("valueChanged",(function(e){o.m_clientIds=new Set(e),o.m_events.emit("activeClientCountChanged")})),this.setUpSystemCommandsCell(),this.m_telemetry=new p.SimpleServiceTelemetry(this.m_clientId,this.m_sessionId,i.maxRoundtripRaw),this.m_verbose=i.verbose||!1,this.m_batchedRequestsEnabled=i.batchedRequestsEnabled,this.m_pingTimeoutInMs=i.pingTimeoutInMs,this.m_pongTimeoutInMs=i.pongTimeoutInMs,this.m_user=s,this.m_metadata=i.metadata,this.m_retryIntervalsInMs=i.retryIntervalsInMs||f,this.m_maxSessionRetries=i.maxSessionRetries}return Object.defineProperty(e.prototype,"lastCloseReason",{get:function(){return this.m_lastCloseReason},enumerable:!1,configurable:!0}),e.prototype.setConnectionState=function(e){this.m_connectionState!==e&&(this.m_connectionState=e,this.m_events.emit("connectionStateChanged"))},e.prototype.setUpSystemCommandsCell=function(){var e=this;this.m_systemCommandsCell=new h.SimpleSyncCell("systemCommands",this),this.m_handlers.set(this.m_systemCommandsCell.id(),this.m_systemCommandsCell),this.m_systemCommandsCell.on("valueChanged",(function(t){return r(e,void 0,void 0,(function(){var e,n,r;return i(this,(function(i){switch(i.label){case 0:switch(t){case"refreshToken":return[3,1]}return[3,6];case 1:if(!this.m_user||!this.m_user.getForceRefreshedTokenAsync)return[3,5];i.label=2;case 2:return i.trys.push([2,4,,5]),[4,this.m_user.getForceRefreshedTokenAsync()];case 3:return e=i.sent(),(n={}).authorization=e.token,n.authProvider=e.authProvider,n.mri=e.mri||"",n.huid=e.hashedUserEmail||"",this.sendConfigMessage(n),[3,5];case 4:return r=i.sent(),this.m_logger.sendTraceTag(574107847,d.TraceLevel.Error,"Error getting force refreshed auth token: "+(r&&r.message)),[3,5];case 5:return[3,7];case 6:return this.m_logger.sendTraceTag(574107848,d.TraceLevel.Error,"Unknown system command cell value: "+t),[3,7];case 7:return[2]}}))}))}))},e.prototype.connectAsync=function(){return r(this,void 0,void 0,(function(){var e=this;return i(this,(function(t){return this.m_initPromise.promise=new Promise((function(t,n){e.m_initPromise.resolve=t,e.m_initPromise.reject=n})),this.setConnectionState(a.ConnectionState.Connecting),[2,new Promise((function(t,n){e.m_webSocket=new WebSocket(e.m_wsUrl),e.m_webSocket.onopen=function(){return r(e,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,this.handleWebSocketOpenAsync()];case 1:return e.sent(),t(),[2]}}))}))},e.m_webSocket.onerror=function(t){e.m_logger.sendTraceTag(590213388,d.TraceLevel.Error,"SimpleStateServiceProxy::connect - websocket onerror. {sessionId: "+e.m_sessionId+", ClientId: "+e.m_clientId+", Error: "+JSON.stringify(t)+"}"),e.retryConnection((function(t){var r="failed to reconnect after websocket error: "+(t&&t.message);e.m_logger.sendTraceTag(579463185,d.TraceLevel.Error,r),n(r)}),!1)},e.m_webSocket.onclose=function(t){e.m_logger.sendTraceTag(590213389,d.TraceLevel.Error,"SimpleStateServiceProxy::connect - websocket onclose. {sessionId: "+e.m_sessionId+", ClientId: "+e.m_clientId+", Code: "+t.code+", Reason: "+t.reason+"}"),e.m_lastCloseCode=t.code,e.m_lastCloseReason=t.reason,4321!==t.code?e.retryConnection((function(t){var r="failed to reconnect after service side disconnect: "+(t&&t.message);e.m_logger.sendTraceTag(579463186,d.TraceLevel.Error,r),n(r)}),!1):(e.setConnectionState(a.ConnectionState.Disconnected),e.m_logger.sendTraceTag(588009741,d.TraceLevel.Error,"SimpleStateServiceProxy::connect - websocket onclose. Not retryable close code. {sessionId: "+e.m_sessionId+", ClientId: "+e.m_clientId+"}"))},e.m_webSocket.onmessage=function(t){try{e.handleWebSocketMessage(t)}catch(t){e.m_logger.sendTraceTag(590213390,d.TraceLevel.Error,"SimpleStateServiceProxy::onmessage - websocket error. {sessionId: "+e.m_sessionId+", ClientId: "+e.m_clientId+", Error: "+(t&&t.message)+"}")}}}))]}))}))},e.prototype.canRetry=function(){return this.m_connectionState===a.ConnectionState.Disconnected&&4321!==this.m_lastCloseCode},e.prototype.handleWebSocketOpenAsync=function(){return r(this,void 0,void 0,(function(){var e,t,n;return i(this,(function(r){switch(r.label){case 0:if(this.m_logger.sendTraceTag(590213387,d.TraceLevel.Info,"SimpleStateServiceProxy::connect - websocket onopen. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+"}"),this.m_retryAttempts=0,this.setConnectionState(a.ConnectionState.Connected),this.startPingTimer(),!this.m_user||!this.m_user.getAuthTokenAsync)return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.m_user.getAuthTokenAsync()];case 2:return e=r.sent(),[3,4];case 3:return t=r.sent(),this.m_logger.sendTraceTag(578102469,d.TraceLevel.Error,"Error getting auth token: "+(t&&t.message)),[3,4];case 4:return(e||this.m_metadata)&&(n={},e&&(n.authorization=e.token,n.authProvider=e.authProvider,n.mri=e.mri||"",n.huid=e.hashedUserEmail||""),this.m_metadata&&(n.metadata=JSON.stringify(this.m_metadata)),this.sendConfigMessage(n)),[2]}}))}))},e.prototype.onFocusChanged=function(e){var t=this;e?(window.clearTimeout(this.m_closeWebSocketTimer),this.m_webSocket||(this.m_logger.sendTraceTag(590213392,d.TraceLevel.Info,"SimpleStateServiceProxy::onFocusChanged - websocket retryConnection due to getting focus again. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+"}"),this.retryConnection((function(e){t.m_logger.sendTraceTag(579463187,d.TraceLevel.Error,"failed to reconnect after regaining focus: "+(e&&e.message))}),!0))):this.m_closeWebSocketTimer=window.setTimeout((function(){t.m_webSocket&&(t.m_logger.sendTraceTag(590213391,d.TraceLevel.Info,"SimpleStateServiceProxy::onFocusChanged - websocket close due to losing focus. {sessionId: "+t.m_sessionId+", ClientId: "+t.m_clientId+"}"),t.m_webSocket.onclose=function(){},t.m_webSocket.close(),t.m_webSocket=null)}),this.m_websocketAliveTimeAfterLoseFocusInMS)},e.prototype.sendConfigMessage=function(e){var t={messageId:u.v4(),senderId:this.senderId(),objectId:v,type:"",operation:"",value:JSON.stringify(e)};this.sendStateMessage(t)},e.prototype.sendSubscriptionsMessage=function(e){var t={messageId:u.v4(),senderId:this.senderId(),objectId:g,type:"",operation:"",value:JSON.stringify(e)};this.sendStateMessage(t)},e.prototype.retryConnection=function(e,t){var n=this;if(this.clearPingPongTimer(),this.m_retryAttempts>=this.m_retryIntervalsInMs.length||this.m_telemetry.wsReconnectCount>=this.m_maxSessionRetries)return this.setConnectionState(a.ConnectionState.Disconnected),this.m_logger.sendTraceTag(590213393,d.TraceLevel.Error,"SimpleStateServiceProxy::retryConnection reached max retry attempts. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+"}"),void(e&&e(new Error("reached max retry attempts")));if(this.setConnectionState(a.ConnectionState.Connecting),t||this.m_webSocket&&!this.m_retryTimer){var s=this.m_retryIntervalsInMs[this.m_retryAttempts];if(this.m_retryAttempts+=1,this.m_telemetry.wsReconnectCount+=1,this.m_webSocket){if(this.m_webSocket.onclose=function(){},this.m_webSocket.readyState===WebSocket.OPEN)this.m_webSocket.close();else{var o=this.m_webSocket;o.onopen=function(){return o.close()}}this.m_webSocket=null}this.m_retryTimer=setTimeout((function(){return r(n,void 0,void 0,(function(){var t;return i(this,(function(n){switch(n.label){case 0:this.m_logger.sendTraceTag(590213395,d.TraceLevel.Info,"SimpleStateServiceProxy::retryConnection. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+"}"),this.m_retryTimer=null,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.connectAsync()];case 2:return n.sent(),[3,4];case 3:return t=n.sent(),this.setConnectionState(a.ConnectionState.Disconnected),this.m_logger.sendTraceTag(590213396,d.TraceLevel.Error,"SimpleStateServiceProxy::retryConnection failed. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+"}, "+(t&&t.message)),this.m_retryAttempts>=this.m_retryIntervalsInMs.length&&e(t),[3,4];case 4:return[2]}}))}))}),s)}else this.m_logger.sendTraceTag(590213394,d.TraceLevel.Info,"SimpleStateServiceProxy::retryConnection skipped. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+", NullWebSocket: "+(null===this.m_webSocket)+", NullRetryTimer: "+(null===this.m_retryTimer)+"}")},e.prototype.startPingTimer=function(){var e=this;this.m_webSocket&&(this.m_pingTimeoutInMs<=0||this.m_pongTimeoutInMs<=0||(this.clearPingPongTimer(),this.m_pingTimer=setTimeout((function(){return r(e,void 0,void 0,(function(){return i(this,(function(e){return this.sendPingMessage(),this.m_pingTimer=null,[2]}))}))}),this.m_pingTimeoutInMs)))},e.prototype.sendPingMessage=function(){var e=this;this.m_webSocket&&(this.m_webSocket.readyState===WebSocket.OPEN?(this.m_webSocket.send("__ping__"),this.clearPongTimer(),this.m_pongTimer=setTimeout((function(){return r(e,void 0,void 0,(function(){var e=this;return i(this,(function(t){return this.retryConnection((function(t){e.m_logger.sendTraceTag(579463188,d.TraceLevel.Error,"failed to reconnect after missing ping: "+(t&&t.message))}),!1),this.m_pongTimer=null,[2]}))}))}),this.m_pongTimeoutInMs)):(this.retryConnection((function(t){e.m_logger.sendTraceTag(579463189,d.TraceLevel.Error,"failed to reconnect after closed websocket: "+(t&&t.message))}),!1),this.clearPongTimer()))},e.prototype.clearPingPongTimer=function(){this.clearPingTimer(),this.clearPongTimer()},e.prototype.clearPingTimer=function(){this.m_pingTimer&&(clearTimeout(this.m_pingTimer),this.m_pingTimer=null)},e.prototype.clearPongTimer=function(){this.m_pongTimer&&(clearTimeout(this.m_pongTimer),this.m_pongTimer=null)},e.prototype.handleWebSocketMessage=function(e){if("string"==typeof e.data){if(this.startPingTimer(),"__pong__"===e.data)return;var t=Date.now();try{var n=JSON.parse(e.data);Array.isArray(n)&&n.length>0?this.handleAggregatedStateMessages(n):this.handleStateMessage(n),this.m_telemetry.addMessageHandleLatency(Date.now()-t),"systemSessionState"===n.objectId&&this.m_initPromise.resolve()}catch(e){this.m_logger.sendTraceTag(578102302,d.TraceLevel.Error,"handleWebSocketMessage: "+(e&&e.message))}}else this.m_logger.sendTraceTag(590213397,d.TraceLevel.Error,"SimpleStateServiceProxy::handleWebSocketMessage - Unknown data type. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+", Type: "+typeof e.data+"}")},e.prototype.handleAggregatedStateMessages=function(e){var t,n;if(e&&0!==e.length){this.m_user&&this.m_user.beginAggregatedStateUpdating&&this.m_user.beginAggregatedStateUpdating();try{for(var r=s(e),i=r.next();!i.done;i=r.next()){var o=i.value;this.handleStateMessage(JSON.parse(o))}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}this.m_user&&this.m_user.endAggregatedStateUpdating&&this.m_user.endAggregatedStateUpdating()}},e.prototype.handleStateMessage=function(e){var t=this;if(this.m_verbose&&this.m_logger.sendTraceTag(590213398,d.TraceLevel.Info,"SimpleStateServiceProxy::handleStateMessage. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+", ObjectId: "+e.objectId+", MessageId: "+e.messageId+"}"),"list"===e.type){JSON.parse(e.value).forEach((function(e){t.handleStateMessage(e)}))}else{if(this.m_user&&this.m_user.validateMessage&&!this.m_user.validateMessage(e))return void this.m_logger.sendTraceTag(588009742,d.TraceLevel.Error,"SimpleStateServiceProxy::handleStateMessage rejected message: {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+", ObjectId: "+e.objectId+", MessageId: "+e.messageId+"}");this.measureMessageRoundTripLatency(e);var n=this.m_handlers.get(e.objectId);if(n)return void n.handleStateMessage(e);if("cell"===e.type?n=new h.SimpleSyncCell(e.objectId,this):"map"===e.type?n=new m.SimpleSyncMap(e.objectId,this):this.m_logger.sendTraceTag(590213399,d.TraceLevel.Error,"SimpleStateServiceProxy::handleStateMessage - Unknown message type. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+", Type: "+e.type+"}"),n)return this.m_handlers.set(e.objectId,n),void n.handleStateMessage(e)}},e.prototype.close=function(){this.m_logger.sendTraceTag(590213400,d.TraceLevel.Info,"SimpleStateServiceProxy::close. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+"}"),this.m_webSocket&&(this.m_webSocket.onclose=function(){},this.m_webSocket.close(),this.m_webSocket=null),this.m_retryTimer&&(clearTimeout(this.m_retryTimer),this.m_retryTimer=null),this.clearPingPongTimer(),0!==this.countOfOutboundMessagesNotRoundTrippedYet()&&(this.m_events.emit("messageFailedToRoundTripOnClose",this.m_outboundMessageInfo.size),this.m_outboundMessageInfo.clear())},e.prototype.createMapAsync=function(e,t){return r(this,void 0,void 0,(function(){var n;return i(this,(function(r){return n=new m.SimpleSyncMap(e,this,t),this.m_handlers.set(e,n),[2,n]}))}))},e.prototype.getMapAsync=function(e){return r(this,void 0,void 0,(function(){var t;return i(this,(function(n){return(t=this.m_handlers.get(e))?[2,t]:[2,null]}))}))},e.prototype.waitMapAsync=function(e,t){return r(this,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return[4,this.m_initPromise.promise];case 1:return r.sent(),[4,this.getMapAsync(e)];case 2:return(n=r.sent())?[3,4]:[4,this.createMapAsync(e,t)];case 3:n=r.sent(),r.label=4;case 4:return[2,n]}}))}))},e.prototype.createCellAsync=function(e,t){return r(this,void 0,void 0,(function(){var n;return i(this,(function(r){return n=new h.SimpleSyncCell(e,this,t),this.m_handlers.set(e,n),[2,n]}))}))},e.prototype.getCellAsync=function(e){return r(this,void 0,void 0,(function(){var t;return i(this,(function(n){return(t=this.m_handlers.get(e))?[2,t]:[2,null]}))}))},e.prototype.waitCellAsync=function(e,t){return r(this,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return[4,this.m_initPromise.promise];case 1:return r.sent(),[4,this.getCellAsync(e)];case 2:return(n=r.sent())?[3,4]:[4,this.createCellAsync(e,t)];case 3:n=r.sent(),r.label=4;case 4:return[2,n]}}))}))},e.prototype.getHistoryAsync=function(e,t){return r(this,void 0,void 0,(function(){var n,r;return i(this,(function(i){switch(i.label){case 0:return(n=new URL(this.m_deltasBaseUrl)).searchParams.append("action","deltas"),n.searchParams.append("docId",this.m_sessionId),n.searchParams.append("cid",this.m_clientId),n.searchParams.append("objectId",e),t&&n.searchParams.append("property",t),[4,l.default.get(n.toString())];case 1:return(r=i.sent().data).forEach((function(e){return e.value=JSON.parse(e.value)})),[2,r]}}))}))},e.prototype.getHistoryWithPaginationAsync=function(e,t,n){return r(this,void 0,void 0,(function(){var r,s;return i(this,(function(i){switch(i.label){case 0:return(r=new URL(this.m_deltasBaseUrl)).searchParams.append("action","deltas"),r.searchParams.append("docId",this.m_sessionId),r.searchParams.append("cid",this.m_clientId),r.searchParams.append("objectId",e),r.searchParams.append("pagination","true"),n&&r.searchParams.append("cursor",n),t&&r.searchParams.append("property",t),[4,l.default.get(r.toString())];case 1:return(s=i.sent().data).messages.forEach((function(e){return e.value=JSON.parse(e.value)})),[2,s]}}))}))},e.prototype.getServiceTelemetry=function(){return this.m_telemetry.wsState=a.ConnectionState[this.getConnectionState()],this.m_telemetry.messagePendingAckCount=this.m_outboundMessageInfo.size,this.m_telemetry},e.prototype.activeClientCount=function(){return this.m_clientIds.size},e.prototype.activeClientIds=function(){return this.m_clientIds},e.prototype.on=function(e,t){return this.m_events.on(e,t),this},e.prototype.clientId=function(){return this.m_clientId},e.prototype.getConnectionState=function(){return this.m_connectionState},e.prototype.sendStateMessage=function(e){this.m_verbose&&this.m_logger.sendTraceTag(590213403,d.TraceLevel.Info,"SimpleStateServiceProxy::sendStateMessage. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+", ObjectId: "+e.objectId+", MessageId: "+e.messageId+"}"),e.objectId!==g&&e.objectId!==v&&this.m_outboundMessageInfo.set(e.messageId,Date.now()),this.m_user&&this.m_user.patchMessage&&this.m_user.patchMessage(e),this.sendStateMessageImpl(e)},e.prototype.sendStateMessageImpl=function(e){var t=this;this.m_batchedRequestsEnabled?(this.m_messageBuffer.push(e),this.m_processBufferTimer||(this.m_processBufferTimer=setTimeout((function(){t.processMessageBuffer()}),this.m_batchWaitTimeMS))):this.sendWebSocketMessage(e)},e.prototype.processMessageBuffer=function(){var e=this.m_messageBuffer.length,t=this.m_messageBuffer.splice(0,e),n={value:JSON.stringify(t),type:this.m_batchMessageTypeName,operation:"",messageId:u.v4(),objectId:"batch",senderId:this.senderId()};this.m_processBufferTimer&&clearTimeout(this.m_processBufferTimer),this.m_processBufferTimer=null,this.sendWebSocketMessage(n)},e.prototype.sendWebSocketMessage=function(e){this.m_webSocket?this.m_webSocket.readyState===WebSocket.OPEN?this.m_webSocket.send(JSON.stringify(e)):this.m_logger.sendTraceTag(590213402,d.TraceLevel.Error,"SimpleStateServiceProxy::sendWebSocketMessage - WebSocket status is not open. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+", Status: "+this.m_webSocket.readyState+"}"):this.m_logger.sendTraceTag(590213401,d.TraceLevel.Error,"SimpleStateServiceProxy::sendWebSocketMessage - WebSocket is not set. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+"}")},e.prototype.senderId=function(){return this.m_clientId},e.prototype.countOfOutboundMessagesNotRoundTrippedYet=function(){return this.m_outboundMessageInfo.size},e.prototype.measureMessageRoundTripLatency=function(e){if(e.senderId===this.senderId())try{var t=this.m_outboundMessageInfo.get(e.messageId);if(void 0!==t){this.m_outboundMessageInfo.delete(e.messageId);var n=Date.now()-t;this.m_events.emit("messageRoundTripped",{clientId:this.m_clientId,sessionId:this.m_sessionId,messageId:e.messageId,latencyInMs:n}),this.m_telemetry.addRoundtripLatency(n)}else this.m_verbose&&this.m_logger.sendTraceTag(590213404,d.TraceLevel.Info,"SimpleStateServiceProxy::measureMessageRoundTripLatency. Failed to find outbound message info for {SessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+", ObjectId: "+e.objectId+", MessageId: "+e.messageId+"}")}catch(t){this.m_logger.sendTraceTag(590213405,d.TraceLevel.Error,"SimpleStateServiceProxy::measureMessageRoundTripLatency - Exception thrown error. {SessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+", MessageId: "+e.messageId+", Error: "+t.message+"}")}},e}();t.SimpleStateServiceProxy=S},bmvL:function(e,t,n){"use strict";var r=n("gpyq");e.exports=function(e,t,n,i,s){var o=new Error(e);return r(o,t,n,i,s)}},fniX:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SimpleSyncMap=void 0;var r=n("jxal"),i=n("jN5E"),s=function(){function e(e,t,n){this.m_events=new r.EventEmitter,this.m_map=new Map,this.m_id=e,this.m_sender=t,this.m_shouldEmitEventForAllMessages=n}return e.prototype.on=function(e,t){return this.m_events.on(e,t),this},e.prototype.off=function(e,t){return this.m_events.off(e,t),this},e.prototype.removeAllListeners=function(e){return this.m_events.removeAllListeners(e),this},e.prototype.id=function(){return this.m_id},e.prototype.get=function(e){return this.m_map.get(e)},e.prototype.set=function(e,t){this.m_map.set(e,t);var n={messageId:i.v4(),senderId:this.m_sender.senderId(),objectId:this.m_id,type:"map",operation:"set",property:e,value:JSON.stringify(t)};this.m_sender.sendStateMessage(n)},e.prototype.delete=function(e){var t={messageId:i.v4(),senderId:this.m_sender.senderId(),objectId:this.m_id,type:"map",operation:"delete",property:e,value:""};e?this.m_map.delete(e):this.m_map.clear(),this.m_sender.sendStateMessage(t)},e.prototype.forEach=function(e){this.m_map.forEach(e)},e.prototype.handleStateMessage=function(e){switch(e.operation){case"set":if(!e.property)throw new Error("property is missing for a map.");return void((JSON.stringify(this.m_map.get(e.property))!==e.value||this.m_shouldEmitEventForAllMessages)&&(this.m_map.set(e.property,JSON.parse(e.value)),this.m_events.emit("valueChanged",e.property,e)));case"delete":return e.property?this.m_map.delete(e.property):this.m_map.clear(),void this.m_events.emit("valueDeleted",e.property,e);default:return}},e}();t.SimpleSyncMap=s},"fuk/":function(e,t,n){"use strict";n.r(t),n.d(t,"LiveStateBroadcastService",(function(){return T})),n.d(t,"ILiveStateBroadcastService",(function(){return S.ILiveStateBroadcastService})),n.d(t,"LiveStateServiceExperience",(function(){return S.b})),n.d(t,"LiveStateServiceSessionErrorCode",(function(){return S.c}));var r=n("+7/b"),i=n("pa/m"),s=n("zQSw"),o=n("vtvO"),a=n("3J71"),c=n("RqlN"),u=n("+owg"),l=n("ifNO");function d(e,t,n,i,s){return Object(r.f)(this,void 0,Promise,(function(){var o=this;return Object(r.i)(this,(function(a){return[2,new Promise((function(a,c){return Object(r.f)(o,void 0,void 0,(function(){var o,u,l,d,m;return Object(r.i)(this,(function(r){switch(r.label){case 0:if(t<1)return[2,c(new Error("n must be at least 1. "+t+" was received."))];if(s&&s.length!==t)return[2,c(new Error("Length of custom intervals must be the same as number of max attempts. "+s.length+" was received."))];u=0,r.label=1;case 1:if(!(u<t))return[3,7];r.label=2;case 2:return r.trys.push([2,4,,6]),[4,e()];case 3:return l=r.sent(),[2,a(l)];case 4:return d=r.sent(),o=d,m=s?s[u]:n*Math.pow(2,u),[4,h(i,m)];case 5:return r.sent(),[3,6];case 6:return u++,[3,1];case 7:return[2,c(o)]}}))}))}))]}))}))}function h(e,t){return new Promise((function(n){var r=e.setTimeout((function(){e.clearTimeout(r),n()}),t)}))}var m=[1e3,2e3,4e3],p=function(e){var t,n,r,i,s,o,a,c,u,l,d,h,p,f,g,v;return{batchedRequestsEnabled:null!==(n=null===(t=e.liveStateServiceBaseSettings)||void 0===t?void 0:t.batchedRequestsEnabled)&&void 0!==n&&n,maxRoundtripRaw:null!==(i=null===(r=e.liveStateServiceBaseSettings)||void 0===r?void 0:r.maxRoundtripRaw)&&void 0!==i?i:300,pingTimeoutInMs:null!==(o=null===(s=e.liveStateServiceBaseSettings)||void 0===s?void 0:s.pingTimeoutInMs)&&void 0!==o?o:15e3,pongTimeoutInMs:null!==(c=null===(a=e.liveStateServiceBaseSettings)||void 0===a?void 0:a.pongTimeoutInMs)&&void 0!==c?c:15e3,retryIntervalsInMs:null!==(l=null===(u=e.liveStateServiceBaseSettings)||void 0===u?void 0:u.retryIntervalsInMs)&&void 0!==l?l:m,verbose:null!==(h=null===(d=e.liveStateServiceBaseSettings)||void 0===d?void 0:d.verbose)&&void 0!==h&&h,websocketAliveTimeAfterLoseFocusInMS:null!==(f=null===(p=e.liveStateServiceBaseSettings)||void 0===p?void 0:p.websocketAliveTimeAfterLoseFocusInMS)&&void 0!==f?f:3e4,autoRoutingEnabled:null!==(v=null===(g=e.liveStateServiceBaseSettings)||void 0===g?void 0:g.autoRoutingEnabled)&&void 0!==v&&v}},f=function(e){var t,n,r,i,s,o;return{baseUrl:null!==(n=null===(t=e.liveStateServiceEndpoint)||void 0===t?void 0:t.baseUrl)&&void 0!==n?n:"https://pptservicescast.officeapps.live.com/",handler:null!==(i=null===(r=e.liveStateServiceEndpoint)||void 0===r?void 0:r.handler)&&void 0!==i?i:"TeamsHandler.ashx",getEndpointAction:null!==(o=null===(s=e.liveStateServiceEndpoint)||void 0===s?void 0:s.getEndpointAction)&&void 0!==o?o:"endpoint"}},g=function(e){var t,n,r,i,s,o,a,c,u,l,d,h,m,p,f,g,v;return{liveStateServiceEndpointBaseUrlOverride:null!==(t=e.liveStateServiceEndpointBaseUrlOverride)&&void 0!==t?t:"",maxErrorLogsToRetain:null!==(n=e.maxErrorLogsToRetain)&&void 0!==n?n:2,maxFullRetryCount:null!==(r=e.maxFullRetryCount)&&void 0!==r?r:2,maxSessionFullRetryCount:null!==(i=e.maxSessionFullRetryCount)&&void 0!==i?i:15,routingEndpointRetryCount:null!==(s=e.routingEndpointRetryCount)&&void 0!==s?s:3,authTokenRetryCount:null!==(o=e.authTokenRetryCount)&&void 0!==o?o:3,startingBackOffTimeMS:null!==(a=e.startingBackOffTimeMS)&&void 0!==a?a:200,waitForConnectedBroadcasterMaxTimeMS:null!==(c=e.waitForConnectedBroadcasterMaxTimeMS)&&void 0!==c?c:3e4,waitForConnectedBroadcasterIntervalMS:null!==(u=e.waitForConnectedBroadcasterIntervalMS)&&void 0!==u?u:100,authEnabled:null===(l=e.authEnabled)||void 0===l||l,authResourceUri:null!==(d=e.authResourceUri)&&void 0!==d?d:"https://officevoicefrontdoor.officeapps.live.com",authResourceUriMSA:null!==(h=e.authResourceUriMSA)&&void 0!==h?h:"https://officevoicefrontdoor.officeapps.live.com/officevoicefrontdoor.all",reactionAggregationEnabled:null===(m=e.reactionAggregationEnabled)||void 0===m||m,unacknowledgedReactionTimeInMS:null!==(p=e.unacknowledgedReactionTimeInMS)&&void 0!==p?p:8e3,useSkypeTokenForAll:null!==(f=e.useSkypeTokenForAll)&&void 0!==f&&f,authStartingBackOffTimeMS:null!==(g=e.authStartingBackOffTimeMS)&&void 0!==g?g:500,maxUserIdAttempts:null!==(v=e.maxUserIdAttempts)&&void 0!==v?v:2}},v=function(){function e(e,t){this.logger=e,this.coreSettings=t,this.errorLogs=[],this.logger=e,this.reset()}return e.prototype.sendTraceTag=function(e,t,n){var r;switch(t){case i.TraceLevel.Warning:r=this.logger.warn.bind(this.logger);break;case i.TraceLevel.Info:r=this.logger.log.bind(this.logger);break;case i.TraceLevel.Error:r=this.logger.error.bind(this.logger),this.maxErrorLogsToRetain>0&&this.errorLogs.length<this.maxErrorLogsToRetain&&this.errorLogs.push(n);break;default:this.logger.error("Invalid trace level of "+t+" for message: "+n)}r&&r(n)},e.prototype.logError=function(e){this.sendTraceTag(0,i.TraceLevel.Error,e)},e.prototype.logInfo=function(e){this.sendTraceTag(0,i.TraceLevel.Info,e)},e.prototype.reset=function(){this.maxErrorLogsToRetain=g(this.coreSettings.get(s.a.LiveStateService)).maxErrorLogsToRetain,this.errorLogs.splice(0)},e}(),S=n("/A+Q"),y=n("jN5E"),b=n("RFgA"),_=function(){function e(){this.reset()}return Object.defineProperty(e.prototype,"sessionId",{get:function(){return this._sessionId?"hpraguedocid_"+Object(b.sha256)(this._sessionId):""},set:function(e){this._sessionId=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bootTimeInMS",{get:function(){return this.endpointRequestTimeInMS+this.websocketConnectionTimeInMS},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"errorCode",{get:function(){return this._errorCode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"telemetry",{get:function(){return{correlationId:this.correlationId,sessionId:this.sessionId,clientId:this.clientId,errorCode:this._errorCode,errorMessage:this.errorMessage,bootTimeInMS:this.bootTimeInMS,endpointRequestTimeInMS:this.endpointRequestTimeInMS,websocketConnectionTimeInMS:this.websocketConnectionTimeInMS,authTimeInMS:this.authTimeInMS,receivedReactionCount:this.receivedReactionCount,requestedReactionCount:this.requestedReactionCount,ackedReactionCount:this.acknowledgedReactionCount,receivedSlideNavCount:this.receivedSlideNavCount,requestedSlideNavCount:this.requestedSlideNavCount,ackedSlideNavCount:this.acknowledgedSlideNavCount,rejectedMessageCount:this.rejectedMessageCount,sessionRetryCount:this.sessionRetryCount,endpointRetryCount:this.endpointRetryCount}},enumerable:!1,configurable:!0}),e.prototype.reset=function(){this.correlationId=Object(y.v4)(),this._sessionId="",this.clientId="",this.errorMessage="",this._errorCode=S.c.ErrorCodeNone,this.endpointRequestTimeInMS=0,this.websocketConnectionTimeInMS=0,this.authTimeInMS=0,this.receivedReactionCount=0,this.requestedReactionCount=0,this.acknowledgedReactionCount=0,this.receivedSlideNavCount=0,this.requestedSlideNavCount=0,this.acknowledgedSlideNavCount=0,this.rejectedMessageCount=0,this.sessionRetryCount=0,this.endpointRetryCount=-1},e.prototype.updateError=function(e,t){this._errorCode=e,this.errorMessage=t},e.prototype.updateAuthTime=function(e){0===this.authTimeInMS&&(this.authTimeInMS=e)},e}(),I=n("W1yN"),T=function(){function e(e,t,n,r,i,o,a,c){this.pubsub=e,this.send=t,this.coreSettings=r,this.authenticationService=i,this.platformService=o,this.scenarioFactory=a,this.discover=c,this.clientType="Teams",this.reactionsMapName="reactions",this.userId="",this.teamsSessionId="",this.userIdAttempts=0,this.inAggregatedStateUpdateMode=!1,this.aggregatedReactions=[],this.unacknowledgedReactionCallbacks=new Map,this.isInitializing=!1,this.isStateServiceConnected=!1,this.stateServiceLogger=new v(n.newLogger("LiveStateBroadcastService"),r),this._sessionTelemetry=new _,this.currentExperiences=new Map;var u=g(this.coreSettings.get(s.a.LiveStateService)),l=u.unacknowledgedReactionTimeInMS,d=u.maxFullRetryCount,h=u.maxSessionFullRetryCount;this.unacknowledgedReactionTimeInMS=l,this.availableFullRetries=d,this.availableSessionFullRetries=h}return Object.defineProperty(e.prototype,"sessionTelemetry",{get:function(){return this._sessionTelemetry},enumerable:!1,configurable:!0}),e.prototype.getReactionsPubsubAsyncIterator=function(){return this.pubsub.asyncIterator(S.d)},e.prototype.init=function(e,t,n,i){return Object(r.f)(this,void 0,Promise,(function(){var s,o,a,c;return Object(r.i)(this,(function(r){switch(r.label){case 0:if(this.currentExperiences.get(t))throw s=t+" already in use.",this.stateServiceLogger.logError(s),new Error(s);if(!e)throw s="Empty session id",this.stateServiceLogger.logError(s),new Error(s);this.teamsSessionId=e,r.label=1;case 1:return r.trys.push([1,4,5,6]),this.isInitializing=!0,[4,this.getEndpointUrl(e,n,i)];case 2:return o=r.sent(),a=o.endpoint,c=o.sessionId,this.sessionTelemetry.sessionId=c,[4,this.initImpl(c,t,a,n,i)];case 3:return[2,r.sent()];case 4:return r.sent(),this.close(),[2,!1];case 5:return this.isInitializing=!1,[7];case 6:return[2]}}))}))},e.prototype.close=function(e){if(this.teamsSessionId){var t=this.scenarioFactory.newScenario(I.b.LiveStateServiceClose);e&&this.currentExperiences.delete(e);var n=0===this.currentExperiences.size||!e,r=this.getFullTelemetry({experience:null!=e?e:"force",connectionClosed:""+n}),i=this.sessionTelemetry.errorCode;if(n)this.cleanup();else switch(e){case S.b.reactions:this.cleanupMeetingReactions()}i&&i!==S.c.ErrorCodeNone?t.fail({callingDataBag:r}):t.stop({callingDataBag:r})}},e.prototype.sendReaction=function(e,t,n){var i=this;return new Promise((function(s,o){return Object(r.f)(i,void 0,void 0,(function(){var i,a,c,u,l,d,h=this;return Object(r.i)(this,(function(r){switch(r.label){case 0:if(this.sessionTelemetry.requestedReactionCount+=1,this.teamsSessionId!==t){if(""!==this.teamsSessionId)return i="cid "+this.sessionTelemetry.correlationId+": Trying to send reaction for a different sessionId "+t+" with current sessionId of "+this.teamsSessionId,this.stateServiceLogger.logError(i),[2,o(i)];this.teamsSessionId=t}return this.isStateServiceConnected||this.isInitializing?[3,2]:(this.stateServiceLogger.logError("Trying full retry in sendReaction"),this.host=n,this.isInitializing=!0,[4,this.fullRetry()]);case 1:r.sent(),this.resetRetryAvailableCounts(),r.label=2;case 2:return this.resolveReactions(null===(l=this.broadcaster)||void 0===l?void 0:l.clientId()),c=this.onNewReactionReceived((function(e){var t;if((null===(t=h.broadcaster)||void 0===t?void 0:t.clientId())===e||!e)return c(),a&&(n.clearTimeout(a),a=void 0),s(!0)})),a=n.setTimeout((function(){c(),o("cid "+h.sessionTelemetry.correlationId+": Reaction "+e+" not acknowledged")}),this.unacknowledgedReactionTimeInMS),u={name:e},[4,this.refreshUserId()];case 3:return r.sent(),null===(d=this.meetingReactionsMap)||void 0===d||d.set(this.userId,u),[2]}}))}))}))},e.prototype.waitForConnectedBroadcaster=function(e,t,n){var o=this,a=g(this.coreSettings.get(s.a.LiveStateService)),c=a.waitForConnectedBroadcasterMaxTimeMS,u=a.waitForConnectedBroadcasterIntervalMS;return function(e,t,n,i){return Object(r.f)(this,void 0,Promise,(function(){return Object(r.i)(this,(function(r){return[2,new Promise((function(r,s){var o=i.setTimeout((function(){i.clearInterval(a),s()}),n),a=i.setInterval((function(){e()&&(i.clearTimeout(o),i.clearInterval(a),r())}),t)}))]}))}))}((function(){return!!o.broadcaster&&o.broadcaster.getConnectionState()===i.ConnectionState.Connected}),t||c,n||u,e)},e.prototype.initImpl=function(e,t,n,i,s){return Object(r.f)(this,void 0,void 0,(function(){var o,a,c,u,d,h;return Object(r.i)(this,(function(r){switch(r.label){case 0:o=this.scenarioFactory.newScenario(I.b.LiveStateServiceOpen),a=Date.now(),this.host=i,this.discover=s,c=0===this.currentExperiences.size,r.label=1;case 1:if(r.trys.push([1,7,8,9]),!c)return[3,3];if(this.broadcaster)throw d="Broadcaster already initialized",this.sessionTelemetry.updateError(S.c.ErrorCodeWebSocketConnectError,d),o.fail({callingDataBag:this.getFullTelemetry({experience:t,error:d})}),new Error(d);return[4,this.setupBroadcaster(e,n)];case 2:r.sent(),r.label=3;case 3:switch(t){case S.b.reactions:return[3,4]}return[3,6];case 4:return[4,this.setupMeetingReactions()];case 5:return r.sent(),[3,6];case 6:return[2,!0];case 7:throw h=r.sent(),u="Failed to initialize state service connection: "+Object(l.b)(h),h;case 8:return c&&(this.sessionTelemetry.websocketConnectionTimeInMS=Date.now()-a),u?(this.sessionTelemetry.updateError(S.c.ErrorCodeWebSocketConnectError,u),this.stateServiceLogger.logError(u),o.fail({callingDataBag:this.getFullTelemetry({experience:t,error:u})})):o.stop({callingDataBag:this.getFullTelemetry({experience:t})}),[7];case 9:return[2]}}))}))},e.prototype.getEndpointUrl=function(e,t,n){return Object(r.f)(this,void 0,Promise,(function(){var i,o,a,c,u,h,m,f,v,y,b=this;return Object(r.i)(this,(function(_){switch(_.label){case 0:return i=g(this.coreSettings.get(s.a.LiveStateService)),o=i.routingEndpointRetryCount,a=i.startingBackOffTimeMS,this.discover=n,p(this.coreSettings.get(s.a.LiveStateService)).autoRoutingEnabled?(u=(c=Promise).resolve,y={},h="wss://",[4,this.getRegionalUrl()]):[3,2];case 1:return[2,u.apply(c,[(y.endpoint=h+_.sent().hostname+"/StateServiceHandler.ashx",y.sessionId="call_"+e,y)])];case 2:m=Date.now(),f=this.scenarioFactory.newScenario(I.b.LiveStateServiceEndpoint),_.label=3;case 3:return _.trys.push([3,5,6,7]),[4,d((function(){return Object(r.f)(b,void 0,Promise,(function(){var t,n,i,s;return Object(r.i)(this,(function(r){switch(r.label){case 0:this.sessionTelemetry.endpointRetryCount+=1,t=this.sessionTelemetry.correlationId,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.getEndpointUrlImpl(e,t)];case 2:return n=r.sent(),f.stop({callingDataBag:this.getFullTelemetry()}),[2,n];case 3:throw i=r.sent(),s="cid: "+t+" - "+Object(l.b)(i),this.stateServiceLogger.logError(s),s;case 4:return[2]}}))}))}),o,a,t)];case 4:return[2,_.sent()];case 5:throw v=_.sent(),this.stateServiceLogger.logError(v),this.sessionTelemetry.updateError(S.c.ErrorCodeEndpointRequestError,v),f.fail({callingDataBag:this.getFullTelemetry({err:v})}),v;case 6:return this.sessionTelemetry.endpointRequestTimeInMS=Date.now()-m,[7];case 7:return[2]}}))}))},e.prototype.getEndpointUrlImpl=function(e,t){return Object(r.f)(this,void 0,Promise,(function(){var n,i,c,u,l;return Object(r.i)(this,(function(r){switch(r.label){case 0:return n=f(this.coreSettings.get(s.a.LiveStateService)).getEndpointAction,[4,this.getRequestUrl(e)];case 1:return i=r.sent(),[4,this.send({method:"GET",url:i,serviceName:o.a.PPTCast,apiName:n,headers:{"X-CorrelationId":t}})];case 2:return(c=r.sent()).status!==a.j.OK?[3,4]:[4,c.body.json()];case 3:return u=r.sent(),this.sessionTelemetry.updateError(S.c.ErrorCodeNone,""),[2,u];case 4:throw l=c.headers&&c.headers["X-FailureReason"],new Error("Failed to get state service endpoint response with status code "+c.status+" and failure reason: "+l+". CorrelationId: "+t)}}))}))},e.prototype.setupBroadcaster=function(e,t,n){var o,a,c,u;return Object(r.f)(this,void 0,void 0,(function(){var l,d,h,m,f,v,S,y,b;return Object(r.i)(this,(function(_){switch(_.label){case 0:return l=this,[4,this.discover.skypeid()];case 1:return l.userId=_.sent(),d=this.coreSettings.get(s.a.LiveStateService),h=g(d),m=h.authEnabled,f=h.maxSessionFullRetryCount,v=p(d),S=Object(r.a)(Object(r.a)({},v),{retryIntervalsInMs:Object(r.o)(v.retryIntervalsInMs),correlationId:this.sessionTelemetry.correlationId,customClientId:n,maxSessionRetries:f,metadata:{platform:null!==(o=this.platformService.config.osPlatform)&&void 0!==o?o:"",osVersion:""+(null!==(a=this.platformService.config.osVersion)&&void 0!==a?a:""),ring:null!==(c=this.platformService.ecsOverrides.ring)&&void 0!==c?c:"",version:this.platformService.config.clientVersion,tenantId:""}}),y={getAuthTokenAsync:m?this.getAuthTokenAsync.bind(this):void 0,getForceRefreshedTokenAsync:m?this.getForceRefreshedSkypeToken.bind(this):void 0,patchMessage:this.patchMessage.bind(this),beginAggregatedStateUpdating:this.beginAggregatedStateUpdating.bind(this),endAggregatedStateUpdating:this.endAggregatedStateUpdating.bind(this)},b=this,[4,Object(i.createStateServiceProxyAsync)(e,this.clientType,t,this.stateServiceLogger,S,y)];case 2:return b.broadcaster=_.sent(),this.sessionTelemetry.clientId=this.broadcaster.clientId(),this.broadcaster.on("connectionStateChanged",this.onConnectionStateChanged.bind(this)),this.isStateServiceConnected=(null===(u=this.broadcaster)||void 0===u?void 0:u.getConnectionState())===i.ConnectionState.Connected,[2]}}))}))},e.prototype.setupMeetingReactions=function(){var e,t;return Object(r.f)(this,void 0,void 0,(function(){var n;return Object(r.i)(this,(function(r){switch(r.label){case 0:return this.broadcaster?[3,2]:[4,this.waitForConnectedBroadcaster(this.host)];case 1:r.sent(),r.label=2;case 2:return n=this,[4,null===(e=this.broadcaster)||void 0===e?void 0:e.createMapAsync(this.reactionsMapName,!0)];case 3:return n.meetingReactionsMap=r.sent(),null===(t=this.meetingReactionsMap)||void 0===t||t.on("valueChanged",this.onReactionReceived.bind(this)),this.currentExperiences.set(S.b.reactions,!0),[2]}}))}))},e.prototype.onNewReactionReceived=function(e){var t=this,n=Object(y.v4)();return this.unacknowledgedReactionCallbacks.set(n,e),function(){t.unacknowledgedReactionCallbacks.delete(n)}},e.prototype.onReactionReceived=function(e,t){var n=t.senderId;if(this.meetingReactionsMap){var r={meetingReaction:this.meetingReactionsMap.get(e).name,participantId:e};if(this.inAggregatedStateUpdateMode)this.aggregatedReactions.push(r);else{var i={callParticipantsReactionsLiveStateEvent:{sessionId:this.teamsSessionId,meetingReactions:[r]}};this.pubsub.publish(S.d,i)}this.resolveReactions(n),this.sessionTelemetry.receivedReactionCount+=1,this.broadcaster&&(this.sessionTelemetry.acknowledgedReactionCount+=n===this.broadcaster.clientId()?1:0)}else this.stateServiceLogger.logError("onReactionReceived: Undefined meeting reactions map")},e.prototype.beginAggregatedStateUpdating=function(){g(this.coreSettings.get(s.a.LiveStateService)).reactionAggregationEnabled&&(this.inAggregatedStateUpdateMode=!0,this.aggregatedReactions=[])},e.prototype.endAggregatedStateUpdating=function(){if(g(this.coreSettings.get(s.a.LiveStateService)).reactionAggregationEnabled){this.inAggregatedStateUpdateMode=!1;var e={callParticipantsReactionsLiveStateEvent:{sessionId:this.teamsSessionId,meetingReactions:Object(r.o)(this.aggregatedReactions)}};this.pubsub.publish(S.d,e),this.aggregatedReactions=[]}},e.prototype.onConnectionStateChanged=function(e){return Object(r.f)(this,void 0,void 0,(function(){var t;return Object(r.i)(this,(function(n){switch(n.label){case 0:if(!this.broadcaster)return this.stateServiceLogger.logError("Undefined broadcaster in onConnectionStateChanged"),[2];if(this.stateServiceLogger.logInfo("Connection state change to "+i.ConnectionState[e]),this.isStateServiceConnected=e===i.ConnectionState.Connected,e!==i.ConnectionState.Disconnected)return[3,6];if(!this.broadcaster.canRetry()||!this.retriesAvailable())return[3,4];t=!1,n.label=1;case 1:return t||!this.retriesAvailable()?[3,3]:(this.isInitializing=!0,[4,this.fullRetry()]);case 2:return t=n.sent(),[3,1];case 3:return t||(this.sessionTelemetry.updateError(S.c.ErrorCodeWebSocketConnectError,"Failed all retries. Closing. lastCoseReason: "+this.broadcaster.lastCloseReason),this.close()),[3,5];case 4:this.sessionTelemetry.updateError(S.c.ErrorCodeWebSocketConnectError,"Cannot retry in session anymore. Closing. lastCoseReason: "+this.broadcaster.lastCloseReason),this.close(),n.label=5;case 5:return[3,7];case 6:e===i.ConnectionState.Connected&&(this.availableFullRetries=g(this.coreSettings.get(s.a.LiveStateService)).maxFullRetryCount,this.sessionTelemetry.updateError(S.c.ErrorCodeNone,"")),n.label=7;case 7:return[2]}}))}))},e.prototype.fullRetry=function(){var e,t,n;return Object(r.f)(this,void 0,Promise,(function(){var i,s,o,a,c,u,d;return Object(r.i)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,6,7]),this.stateServiceLogger.logInfo("Performing full retry."),this.isInitializing=!0,[4,this.getEndpointUrl(this.teamsSessionId,this.host,this.discover)];case 1:return i=r.sent(),s=i.sessionId,o=i.endpoint,a=null===(e=this.broadcaster)||void 0===e?void 0:e.clientId(),null===(t=this.broadcaster)||void 0===t||t.close(),this.broadcaster=void 0,[4,this.setupBroadcaster(s,o,a)];case 2:return r.sent(),[4,this.setupMeetingReactions()];case 3:return r.sent(),this.sessionTelemetry.sessionId=s,c=this,[4,null===(n=this.discover)||void 0===n?void 0:n.skypeid()];case 4:return c.userId=r.sent(),[2,!0];case 5:return u=r.sent(),d="Error in full reconnecting: "+Object(l.b)(u),this.stateServiceLogger.logError(d),[2,!1];case 6:return this.availableFullRetries-=1,this.availableSessionFullRetries-=1,this.sessionTelemetry.sessionRetryCount+=1,this.isInitializing=!1,[7];case 7:return[2]}}))}))},e.prototype.retriesAvailable=function(){return this.availableFullRetries>0&&this.availableSessionFullRetries>0},e.prototype.getAuthTokenAsync=function(){var e=this,t=g(this.coreSettings.get(s.a.LiveStateService)),n=t.authTokenRetryCount,i=t.authStartingBackOffTimeMS,o=t.useSkypeTokenForAll,a=t.authResourceUri,u=t.authResourceUriMSA,h=Date.now();return d((function(){return Object(r.f)(e,void 0,void 0,(function(){var e,t,n,i,s=this;return Object(r.i)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,6,7]),[4,this.authenticationService.getUser()];case 1:return(e=r.sent()).type===c.a.Anonymous||o?[4,this.discover.validateSkypeToken()]:[3,3];case 2:if(t=r.sent())return[2,Promise.resolve(this.getStateToken(t,!1,e))];throw new Error("skypeToken not available. useSkypeTokenForAll: "+o);case 3:return[2,this.authenticationService.acquireToken(e.type===c.a.Msa?u:a,{silent:!0}).then((function(t){return s.getStateToken("Bearer "+t,!0,e)})).catch((function(e){throw s.stateServiceLogger.logError("getAuthTokenAsync - error in acquireToken: "+Object(l.b)(e)),e}))];case 4:return[3,7];case 5:throw n=r.sent(),i="getAuthTokenAsync - failed all retries: "+Object(l.b)(n),this.sessionTelemetry.updateError(S.c.ErrorCodeAuthRequestError,i),this.stateServiceLogger.logError(i),n;case 6:return this.sessionTelemetry.updateAuthTime(Date.now()-h),[7];case 7:return[2]}}))}))}),n,i,this.host)},e.prototype.getForceRefreshedSkypeToken=function(){return Object(r.f)(this,void 0,Promise,(function(){var e,t;return Object(r.i)(this,(function(n){switch(n.label){case 0:return[4,this.authenticationService.getUser()];case 1:return e=n.sent(),[4,this.discover.validateSkypeToken({forceRenew:!0})];case 2:return t=n.sent(),[2,this.getStateToken(t,!1,e)]}}))}))},e.prototype.getStateToken=function(e,t,n){return{token:e,authProvider:t?n.type===c.a.Msa?"MSA":"AAD":"SKYPE",hashedUserEmail:t&&n.profile.email?Object(b.sha256)(n.profile.email):void 0,mri:this.userId}},e.prototype.patchMessage=function(e){this.coreSettings.get(s.a.LiveStateService).authEnabled&&(e.metadata||(e.metadata={}),e.metadata.mri=this.userId)},e.prototype.refreshUserId=function(){return Object(r.f)(this,void 0,void 0,(function(){var e,t;return Object(r.i)(this,(function(n){switch(n.label){case 0:return e=g(this.coreSettings.get(s.a.LiveStateService)).maxUserIdAttempts,!this.userId&&this.discover&&this.userIdAttempts<e?(t=this,[4,this.discover.skypeid()]):[3,2];case 1:t.userId=n.sent(),this.userIdAttempts+=1,n.label=2;case 2:return[2]}}))}))},e.prototype.cleanup=function(){this.broadcaster&&(this.broadcaster.close(),this.broadcaster=void 0),this.cleanupMeetingReactions(),this.teamsSessionId="",this.userId="",this.currentExperiences.clear(),this.sessionTelemetry.reset(),this.stateServiceLogger.reset(),this.resetRetryAvailableCounts(),this.userIdAttempts=0,this.isStateServiceConnected=!1,this.isInitializing=!1},e.prototype.cleanupMeetingReactions=function(){this.meetingReactionsMap&&(this.meetingReactionsMap.removeAllListeners("valueChanged"),this.meetingReactionsMap=void 0),this.inAggregatedStateUpdateMode=!1,this.aggregatedReactions=[],this.resolveReactions(),this.unacknowledgedReactionCallbacks.clear()},e.prototype.getFullTelemetry=function(e){var t,n;try{return JSON.stringify(Object(r.a)(Object(r.a)({},e),{sessionTelemetry:Object(r.a)(Object(r.a)({},this.sessionTelemetry.telemetry),{errorLogs:this.stateServiceLogger.errorLogs}),stateServiceTelemetry:null!==(n=null===(t=this.broadcaster)||void 0===t?void 0:t.getServiceTelemetry())&&void 0!==n?n:{}}))}catch(e){return this.stateServiceLogger.logError(Object(l.b)(e)),""}},e.prototype.getRegionalUrl=function(){return Object(r.f)(this,void 0,Promise,(function(){var e,t,n,i,o;return Object(r.i)(this,(function(r){switch(r.label){case 0:if(e=g(this.coreSettings.get(s.a.LiveStateService)).liveStateServiceEndpointBaseUrlOverride)return this.stateServiceLogger.logInfo("Using endpoint "+e),[2,new URL(e)];t="",r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.discover.regionGtm(u.Gtm.powerPointStateService)];case 2:return t=r.sent(),[3,4];case 3:return n=r.sent(),this.stateServiceLogger.logError("Unable to get regional endpoint: "+Object(l.b)(n)),[3,4];case 4:return i=f(this.coreSettings.get(s.a.LiveStateService)).baseUrl,o=t||i,this.stateServiceLogger.logInfo("Using endpoint "+o),[2,new URL(o)]}}))}))},e.prototype.getRequestUrl=function(e){return Object(r.f)(this,void 0,void 0,(function(){var t,n,i;return Object(r.i)(this,(function(r){switch(r.label){case 0:return t=f(this.coreSettings.get(s.a.LiveStateService)),n=t.getEndpointAction,i=t.handler,[4,this.getRegionalUrl()];case 1:return[2,""+r.sent().href+i+"?action="+n+"&callId="+e+"&ring="+this.platformService.ecsOverrides.ring]}}))}))},e.prototype.resolveReactions=function(e){this.unacknowledgedReactionCallbacks.forEach((function(t){t(e)}))},e.prototype.resetRetryAvailableCounts=function(){var e=g(this.coreSettings.get(s.a.LiveStateService)),t=e.maxFullRetryCount,n=e.maxSessionFullRetryCount;this.availableFullRetries=t,this.availableSessionFullRetries=n},e}()},gpyq:function(e,t,n){"use strict";e.exports=function(e,t,n,r,i){return e.config=t,n&&(e.code=n),e.request=r,e.response=i,e}},ib3c:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TraceLevel=void 0,function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info"}(t.TraceLevel||(t.TraceLevel={}))},j1Ck:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.SimpleSyncCell=void 0;var s=n("jxal"),o=n("jN5E"),a=function(){function e(e,t,n){this.m_events=new s.EventEmitter,this.m_id=e,this.m_sender=t,this.m_shouldEmitEventForAllMessages=n}return e.prototype.on=function(e,t){return this.m_events.on(e,t),this},e.prototype.off=function(e,t){return this.m_events.off(e,t),this},e.prototype.removeAllListeners=function(e){return this.m_events.removeAllListeners(e),this},e.prototype.id=function(){return this.m_id},e.prototype.getAsync=function(){return r(this,void 0,void 0,(function(){return i(this,(function(e){return[2,this.m_value]}))}))},e.prototype.setAsync=function(e){return r(this,void 0,void 0,(function(){var t;return i(this,(function(n){return this.m_value=e,t={messageId:o.v4(),senderId:this.m_sender.senderId(),objectId:this.m_id,type:"cell",operation:"set",value:JSON.stringify(this.m_value)},this.m_sender.sendStateMessage(t),[2]}))}))},e.prototype.delete=function(){this.m_value=void 0;var e={messageId:o.v4(),senderId:this.m_sender.senderId(),objectId:this.m_id,type:"cell",operation:"delete",value:""};this.m_sender.sendStateMessage(e)},e.prototype.handleStateMessage=function(e){switch(e.operation){case"set":return void((JSON.stringify(this.m_value)!==e.value||this.m_shouldEmitEventForAllMessages)&&(this.m_value=JSON.parse(e.value),this.m_events.emit("valueChanged",this.m_value,e)));case"delete":return this.m_value=void 0,void this.m_events.emit("valueDeleted",this.m_value,e);default:return}},e}();t.SimpleSyncCell=a},jDms:function(e,t,n){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},"k/zH":function(e,t,n){"use strict";(function(t){var r=n("Sq1a"),i=n("TuwW"),s={"Content-Type":"application/x-www-form-urlencoded"};function o(e,t){!r.isUndefined(e)&&r.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var a,c={adapter:(("undefined"!=typeof XMLHttpRequest||void 0!==t)&&(a=n("JgJM")),a),transformRequest:[function(e,t){return i(t,"Content-Type"),r.isFormData(e)||r.isArrayBuffer(e)||r.isBuffer(e)||r.isStream(e)||r.isFile(e)||r.isBlob(e)?e:r.isArrayBufferView(e)?e.buffer:r.isURLSearchParams(e)?(o(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):r.isObject(e)?(o(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300}};c.headers={common:{Accept:"application/json, text/plain, */*"}},r.forEach(["delete","get","head"],(function(e){c.headers[e]={}})),r.forEach(["post","put","patch"],(function(e){c.headers[e]=r.merge(s)})),e.exports=c}).call(this,n("TzVV"))},kH0B:function(e,t,n){"use strict";var r=n("Sq1a");e.exports=function(e,t,n){return r.forEach(n,(function(n){e=n(e,t)})),e}},pDCA:function(e,t,n){"use strict";var r=n("Sq1a");function i(){this.handlers=[]}i.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},i.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},i.prototype.forEach=function(e){r.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=i},"pa/m":function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n("ib3c"),t),i(n("UWA8"),t),i(n("uxKk"),t)},quZC:function(e,t,n){"use strict";var r=n("bmvL");e.exports=function(e,t,n){var i=n.config.validateStatus;n.status&&i&&!i(n.status)?t(r("Request failed with status code "+n.status,n.config,null,n.request,n)):e(n)}},to4N:function(e,t,n){"use strict";var r=n("Sq1a");function i(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,n){if(!t)return e;var s;if(n)s=n(t);else if(r.isURLSearchParams(t))s=t.toString();else{var o=[];r.forEach(t,(function(e,t){null!=e&&(r.isArray(e)?t+="[]":e=[e],r.forEach(e,(function(e){r.isDate(e)?e=e.toISOString():r.isObject(e)&&(e=JSON.stringify(e)),o.push(i(t)+"="+i(e))})))})),s=o.join("&")}return s&&(e+=(-1===e.indexOf("?")?"?":"&")+s),e}},uxKk:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.createStateServiceProxyAsync=void 0;var s=n("aD+G");t.createStateServiceProxyAsync=function(e,t,n,o,a,c){return r(this,void 0,void 0,(function(){var r;return i(this,(function(i){switch(i.label){case 0:return[4,(r=new s.SimpleStateServiceProxy(e,t,n,o,a,c)).connectAsync()];case 1:return i.sent(),[2,r]}}))}))}},yRmu:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SimpleServicePerformanceTelemetry=t.SimpleServiceTelemetry=void 0;var r=n("UWA8"),i=function(){function e(e,t,n){this.backendService="SimpleService",this.clientId=e,this.sessionId=t,this.wsReconnectCount=0,this.wsState=r.ConnectionState[r.ConnectionState.Disconnected],this.maxRoundtripRaw=n||0,this.roundtripTelemetry=new s,this.messageHandleTelemetry=new s,this.maxRoundtripRaw>0&&(this.roundtripRaw=[]),this.messagePendingAckCount=0}return e.prototype.addRoundtripLatency=function(e){this.roundtripRaw&&this.roundtripRaw.length<this.maxRoundtripRaw&&this.roundtripRaw.push(e),this.roundtripTelemetry.addLatency(e)},e.prototype.addMessageHandleLatency=function(e){this.messageHandleTelemetry.addLatency(e)},e}();t.SimpleServiceTelemetry=i;var s=function(){function e(){this.count=0,this.minValue=0,this.maxValue=0,this.avgValue=0}return e.prototype.addLatency=function(e){this.count+=1,this.avgValue=this.avgValue+(e-this.avgValue)/this.count,this.minValue=this.count>1?Math.min(e,this.minValue):e,this.maxValue=Math.max(this.maxValue,e)},e}();t.SimpleServicePerformanceTelemetry=s}}]);